<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual is for Cyberprobe (version 2.4.1, 26 December 2019),
which is an example in the Texinfo documentation.

Copyright (C) 2013-2014 Cyber MacGeddon

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with no Front-Cover Texts, and with no Back-Cover
Texts. -->
<!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Cyberprobe 2.4.1</title>

<meta name="description" content="Cyberprobe 2.4.1">
<meta name="keywords" content="Cyberprobe 2.4.1">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="#Top" rel="start" title="Top">
<link href="#Index" rel="index" title="Index">
<link href="dir.html#Top" rel="up" title="(dir)">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<h1 class="settitle" align="center">Cyberprobe 2.4.1</h1>







<span id="Top"></span><div class="header">
<p>
Next: <a href="#Overview" accesskey="n" rel="next">Overview</a>, Up: <a href="dir.html#Top" accesskey="u" rel="up">(dir)</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Cyberprobe"></span><h1 class="top">Cyberprobe</h1>

<p>This is the manual for Cyberprobe (version 2.4.1, 26 December 2019).
</p>
<img src="cyberprobe-overview.png" alt="png">

<span id="index-Packet-inspection"></span>
<span id="index-DPI"></span>
<p>Cyberprobe is a network packet inspection toolkit (Deep Packet Inspection)
for real-time monitoring of networks.  This has applications in network
monitoring, intrusion detection, forensic analysis, and as a defensive
platform.  Cyberprobe packet inspection works on physical networks, and
also in cloud VPCs.  There are features that allow cloud-scale deployments.
</p>
<p>This is not a single, monolithic intrusion detection toolkit which does
everything you want straight out of the box.  If that&rsquo;s what you need,
I would suggest you look elsewhere.  Instead, Cyberprobe is a set of flexible
components which can combined in many ways
to manage a wide variety of packet inspection tasks.  If you want to build
custom network analytics there are many interfaces that make this
straightforward.
</p>
<p>The project maintains a number of components, including:
</p>
<span id="index-cyberprobe"></span>
<span id="index-cybermon"></span>
<span id="index-Snort"></span>

<ul>
<li> <code>cyberprobe</code>, which collects data packets and forwards them a network
stream protocol in real time.  Packet collection can be target with IP
addresses, CIDR ranges or full-take.  Collected packets are tagged with a
device identifier.  <code>cyberprobe</code> can be integrated with Snort to allow
dynamic targeting of IP addresses in response to a Snort rule hitting.

</li><li> <code>cybermon</code>, which receives collected packet streams, performs stateful
processing and creates a stream of observations describing network events.
The events can be consumed in many different ways e.g. the events can be
delivered to a pub/sub system, or presented to a gRPC service.
The event handling is implemented as a function written in Lua, so you can
add your own custom event handling.

</li><li> a set of subscribers which can be used to do things with the captured data
e.g. store to ElasticSearch, BigQuery or Gaffer.

</li></ul>

<p>The architecture has support for AWS Traffic Mirroring, and
supports cloud-scale deployments.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Overview" accesskey="1">Overview</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Obtaining-the-software" accesskey="2">Obtaining the software</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Quick-start-tutorial" accesskey="3">Quick start tutorial</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Running-cyberprobe_002fcybermon-at-boot-time" accesskey="4">Running cyberprobe/cybermon at boot time</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-pub_002fsub-infrastructure" accesskey="5">The pub/sub infrastructure</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#A-containerised-processing-system" accesskey="6">A containerised processing system</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Integrating-with-AWS-Traffic-Mirroring" accesskey="7">Integrating with AWS Traffic Mirroring</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Endace-DAG" accesskey="8">Endace DAG</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Reference" accesskey="9">Reference</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Architecture">Architecture</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Index">Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<span id="Overview"></span><div class="header">
<p>
Next: <a href="#Obtaining-the-software" accesskey="n" rel="next">Obtaining the software</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Overview-1"></span><h2 class="chapter">1 Overview</h2>

<span id="index-Overview-of-Cyberprobe"></span>
<span id="Summary"></span><h3 class="heading">Summary</h3>

<p>Cyberprobe is a network packet inspection toolkit (Deep Packet Inspection)
for real-time monitoring of networks.  This has applications in network
monitoring, intrusion detection, forensic analysis, and as a defensive
platform.  Cyberprobe packet inspection works on physical networks, and
also in cloud VPCs.  There are features that allow cloud-scale deployments.
</p>
<p>This is not a single, monolithic intrusion detection toolkit which does
everything you want straight out of the box.  If that&rsquo;s what you need,
I would suggest you look elsewhere.  Instead, Cyberprobe is a set of flexible
components which can combined in many ways
to manage a wide variety of packet inspection tasks.  If you want to build
custom network analytics there are many interfaces that make this
straightforward.
</p>
<p>The project maintains a number of components, including:
</p>
<span id="index-cyberprobe-1"></span>
<span id="index-cybermon-1"></span>
<span id="index-Snort-1"></span>

<ul>
<li> <code>cyberprobe</code>, which collects data packets and forwards them a network
stream protocol in real time.  Packet collection can be target with IP
addresses, CIDR ranges or full-take.  Collected packets are tagged with a
device identifier.  <code>cyberprobe</code> can be integrated with Snort to allow
dynamic targeting of IP addresses in response to a Snort rule hitting.

</li><li> <code>cybermon</code>, which receives collected packet streams, performs stateful
processing and creates a stream of observations describing network events.
The events can be consumed in many different ways e.g. the events can be
delivered to a pub/sub system, or presented to a gRPC service.
The event handling is implemented as a function written in Lua, so you can
add your own custom event handling.

</li><li> a set of subscribers which can be used to do things with the captured data
e.g. store to ElasticSearch, BigQuery or Gaffer.

</li></ul>

<span id="Cyberprobe-1"></span><h3 class="heading">Cyberprobe</h3>

<span id="index-cyberprobe_002c-features"></span>
<span id="index-Features_002c-of-cyberprobe"></span>

<p>The probe, <code>cyberprobe</code> has the following features:
</p>
<ul>
<li> Can be tasked to collect packets from an interface and forward any
which match a configurable address list.  The address list can be
individual IP addresses, CIDR ranges, or collect-all tasking (&lsquo;<samp>0.0.0.0/0</samp>&rsquo;).

</li><li> Can be configured to receive Snort alerts. In this configuration,
when an alert is received from Snort, the IP source address associated with
the alert is dynamically targeted for a configurable period of time. This is
useful for e.g. collecting data from any network actor who
triggers a snort rule and is thus identified as a potential attacker.

</li><li> Can optionally offer a management API which allows remote
interrogation of the state, and alteration of the configuration. This
allows dynamic alteration of the targeting map, and integration with other
systems.

</li><li> Can be configured to deliver on one of two standard stream protocols.

</li><li> Can insert a packet collection delay line of configurable duration.
This can be useful e.g. with snort alert triggering to make sure all packets
which trigger an alert are collected.

</li></ul>

<span id="index-cybermon_002c-features"></span>
<span id="index-Features_002c-of-cybermon"></span>

<span id="Cybermon"></span><h3 class="heading">Cybermon</h3>

<p>The monitor tool, <code>cybermon</code> has the following features:
</p>
<ul>
<li> Analyses packets delivered in the ETSI stream protocol from one or more
<code>cyberprobe</code> instances.

</li><li> Decodes a number of packet protocols to detect network events, which are
delivered to your configuration in near-real-time.

</li><li> Decoded information is made available to user-configurable logic (written
in Lua) to define how the decoded data is handled.  Sample configuration
files are provided to deliver to RabbitMQ in JSON, a gRPC endpoint, and
deliver to a redis queue.

</li><li> Packet forgery techniques are included, which allow resetting TCP
connections, and forging DNS responses. This can be invoked from your Lua
configuration.

</li><li> Supports IP, TCP, UDP, ICMP, HTTP, DNS, SMTP, FTP, TLS and more.

</li></ul>

<p>The code is targeted at the Linux platform, although it is generic enough to
be applicable to other UN*X-like platforms.
</p>
<span id="Subscribers"></span><h3 class="heading">Subscribers</h3>

<p>The event stream from <code>cybermon</code> can be presented to RabbitMQ
in a JSON form, which can then be delivered to further analytics:
</p>
<ul>
<li> <code>cybermon-alert</code> reports indicator hits in events to standard output.

</li><li> <code>cybermon-bigquery</code> loads events into GCP BigQuery.

</li><li> <code>cybermon-cassandra</code> loads events into Cassandra.

</li><li> <code>cybermon-detector</code> studies events for the presence of indicators.
Events are annotated with indicator hits of any are observed.

</li><li> <code>cybermon-dump</code> dumps raw event JSON to standard output.

</li><li> <code>cybermon-elasticsearch</code> loads events into ElasticSearch.

</li><li> <code>cybermon-gaffer</code> loads network information into Gaffer (a graph
database).

</li><li> <code>cybermon-geoip</code> looks up IP addresses in GeoIP and annotates
events with location information.

</li><li> <code>cybermon-monitor</code> outputs event information to standard output.

</li></ul>

<span id="Scaling"></span><h3 class="heading">Scaling</h3>

<p>The architecture has support for AWS Traffic Mirroring, and
supports cloud-scale deployments:
</p>
<ul>
<li> Multiple <code>cyberprobe</code> instances can load-share across multiple
<code>cybermon</code> instances behind a load-balancer.

</li><li> The event stream from <code>cybermon</code> can be delivered to a pub/sub system
to distribute load and permit scale-up.

</li></ul>

<p>The easiest way to learn about the software is to follow our Quick Start
tutorial.
</p>
<span id="index-Release-history"></span>
<span id="index-Version-history"></span>
<span id="Revision-history"></span><h3 class="heading">Revision history</h3>

<p>Cyberprobe release highlights:
</p>
<dl compact="compact">
<dt><code>2.4</code></dt>
<dd><p><code>cybermon-detector</code> refactored to use FSM-based evaluation of
boolean expressions.
</p>
</dd>
<dt><code>2.3</code></dt>
<dd><p><code>cyberprobe-cli</code> and control API reworked, protobuf and gRPC support.
Amazon Linux support.
</p>
</dd>
<dt><code>2.2</code></dt>
<dd><p>Changed cyberprobe configuration file to use JSON instead of XML.
JSON is easier to integrate with automated processes.
</p>
</dd>
<dt><code>2.0.5</code></dt>
<dd><p>Added VXLAN support to cybermon.  This allows cybermon to receive the
VXLAN protocol which is e.g. used by AWS Traffic Mirroring.
</p>
</dd>
<dt><code>2.0</code></dt>
<dd><p>New simpler Lua API.  Native JSON encoding boosts performance of JSON output
by 500%.
</p>
</dd>
<dt><code>1.13</code></dt>
<dd><p>Cybermon decodes for: TLS, GRE, ESP.
</p>
</dd>
<dt><code>1.12.3</code></dt>
<dd><p>Brought subscribers and docker-compose files up-to-date.
</p>
</dd>
<dt><code>1.11.1</code></dt>
<dd><p>Altered handling of &lsquo;<samp>origin</samp>&rsquo; to make it more resilient.
</p>
</dd>
<dt><code>1.11.0</code></dt>
<dd><p>Added &lsquo;<samp>origin</samp>&rsquo; field to identify whether or not the triggering
device caused an event.
</p>
</dd>
<dt><code>1.10.0</code></dt>
<dd><p>Add RabbitMQ / AMQP 0.9.1 support for cybermon and subscribers.
</p>
</dd>
<dt><code>1.8.4</code></dt>
<dd><p>Endace DAG package support added.
</p>
</dd>
<dt><code>1.7.0</code></dt>
<dd><p>Gaffer subscriber brought up-to-date with Gaffer 1.0 API.  GeoIP and
IOC processor added to the subscriber model.  Some unmaintained Lua code
deprecated, as the subscriber model takes care of the functionality.
</p>
</dd>
<dt><code>1.6.8</code></dt>
<dd><p>Numerous fixes. UUID generation uses a good seed.  ElasticSearch loading
fixed, Mac compilation fixed.
</p>
</dd>
<dt><code>1.6.0</code></dt>
<dd><p>Changed ETSI sender so that packet streams are multiplexed over multiple
TCP streams.
</p>
</dd>
<dt><code>1.5.1</code></dt>
<dd><p>Unbounded queue internal to cybermon has a queue limit, to prevent unbounded
growth.
</p>
</dd>
<dt><code>1.5.0</code></dt>
<dd><p>Timestamp information at the time of packet capture in cyberprobe is now
consistently passed through to cybermon and the Lua functions.  The Lua API
has undergone significant change as a result of passing through timing
information.
</p>
</dd>
<dt><code>1.0</code></dt>
<dd><p>Lua invocation mechanism has been replaced by a thread-safe queue function.
</p>
</dd>
</dl>



<hr>
<span id="Obtaining-the-software"></span><div class="header">
<p>
Next: <a href="#Quick-start-tutorial" accesskey="n" rel="next">Quick start tutorial</a>, Previous: <a href="#Overview" accesskey="p" rel="prev">Overview</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Obtaining-the-software-1"></span><h2 class="chapter">2 Obtaining the software</h2>

<span id="Deployment-using-containers"></span><h3 class="heading">Deployment using containers</h3>

<p>Deploying containers is by far the easiest way to get the software running.
It is possible to deploy a complete software stack for data capture and
analysis using Docker containers which requires the minimal amount of
software installation.
See <a href="#A-containerised-processing-system">A containerised processing system</a>.
</p>
<span id="Debian-_002f-Ubuntu-repository"></span><h3 class="heading">Debian / Ubuntu repository</h3>

<span id="index-Debian"></span>
<span id="index-Ubuntu"></span>
<span id="index-dpkg"></span>
<span id="index-apt_002dget"></span>

<p>We use GoCD to build the software, and regularly release packages
in DEB and RPM form.  Installing from the repository is the easiest way to
install if you&rsquo;re not using containers.
</p>
<p>In order to install, you need to add our signing key to your system:
</p>
<div class="example">
<pre class="example">  wget -q -O- \
    https://cybermaggedon.github.io/cyberprobe-release/cyberprobe.asc | \
    apt-key add -
</pre></div>

<p>We use this signing key:
</p><div class="example">
<pre class="example">pub   rsa4096 2019-04-16 [SC]
      F6D4 AAA5 BFA0 8F63 515A  E22D DA59 F5B6 12EA 476C
uid           [ultimate] Cyber MacGeddon &lt;cybermaggedon@gmail.com&gt;
</pre></div>

<p>Once done you then add our repository to <samp>/etc/apt/sources.list</samp>.
</p>
<p>For Debian Stretch, add:
</p><div class="example">
<pre class="example">deb https://cybermaggedon.github.io/cyberprobe-release/debian \
  stretch main
</pre></div>

<p>For Ubuntu Bionic, add:
</p><div class="example">
<pre class="example">deb https://cybermaggedon.github.io/cyberprobe-release/ubuntu \
  bionic main
</pre></div>

<p>For Ubuntu Disco, add:
</p><div class="example">
<pre class="example">deb https://cybermaggedon.github.io/cyberprobe-release/ubuntu \
  disco main
</pre></div>

<p>Once added, the cyberprobe installation proceeds thus:
</p>
<div class="example">
<pre class="example">apt-get update
apt-get install cyberprobe
</pre></div>

<span id="Fedora"></span><h3 class="heading">Fedora</h3>

<span id="index-Fedora"></span>
<span id="index-dnf"></span>

<p>To install using DNF, create file
<samp>/etc/yum.repos.d/cyberprobe.repo</samp>:
</p>
<div class="example">
<pre class="example">[cyberprobe]
name=Cyberprobe
baseurl=https://cybermaggedon.github.io/cyberprobe-release/fedora/$releasever/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://cybermaggedon.github.io/cyberprobe-release/cyberprobe.asc
</pre></div>

<p>and then:
</p>
<div class="example">
<pre class="example">dnf install cyberprobe
</pre></div>

<p>We use this signing key:
</p><div class="example">
<pre class="example">pub   rsa4096 2019-04-16 [SC]
      F6D4 AAA5 BFA0 8F63 515A  E22D DA59 F5B6 12EA 476C
uid           [ultimate] Cyber MacGeddon &lt;cybermaggedon@gmail.com&gt;
</pre></div>

<span id="Amazon-Linux"></span><h3 class="heading">Amazon Linux</h3>

<span id="index-Amazon-Linux"></span>
<span id="index-yum"></span>

<p>To install using Yum create file
<samp>/etc/yum.repos.d/cyberprobe.repo</samp>:
</p>
<div class="example">
<pre class="example">[cyberprobe]
name=Cyberprobe
baseurl=https://cybermaggedon.github.io/cyberprobe-release/amazon/$releasever/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://cybermaggedon.github.io/cyberprobe-release/cyberprobe.asc
</pre></div>

<p>and then:
</p>
<div class="example">
<pre class="example">yum install cyberprobe
</pre></div>

<p>We use this signing key:
</p><div class="example">
<pre class="example">pub   rsa4096 2019-04-16 [SC]
      F6D4 AAA5 BFA0 8F63 515A  E22D DA59 F5B6 12EA 476C
uid           [ultimate] Cyber MacGeddon &lt;cybermaggedon@gmail.com&gt;
</pre></div>

<span id="Download-packages"></span><h3 class="heading">Download packages</h3>

<p>You can download packages manually; packages are currently available for
Fedora, CentOS, Debian and Ubuntu.  Downloads are available on the project
page at
<a href="http://github.com/cybermaggedon/cyberprobe/releases">http://github.com/cybermaggedon/cyberprobe/releases</a>.
</p>
<p>Fedora packages are installed using <code>dnf</code>:
</p>
<div class="example">
<pre class="example">sudo dnf install &lt;package&gt;
</pre></div>

<p>Debian and Ubuntu packages are installed using <code>dpkg</code>:
</p>
<div class="example">
<pre class="example">sudo dpkg -i &lt;package&gt;
</pre></div>

<p>If there are dependency errors e.g. because you don&rsquo;t have some dependencies
installed, you can install them thus:
</p>
<div class="example">
<pre class="example">sudo apt-get install -f
</pre></div>

<span id="Install-from-source"></span><h3 class="heading">Install from source</h3>

<p>Note: on many platforms, installing a package just adds the &quot;run time&quot; part
of the code. In order to be able to compile code against the run time, you
need to install a separate &quot;developers kit&quot; package. On Fedora, for
instance, both <code>libpcap</code> and <code>libpcap-devel</code> are needed in order to
be able to build this code from source.
</p>
<p>Note also that <code>lua</code> packages can be a little strange: sometimes the
package will exist in your distribution, at other times you need to install a
utility called <code>luarocks</code> to install the package.
</p>
<p>Source downloads are available on the project page at
<a href="http://github.com/cybermaggedon/cyberprobe/releases">http://github.com/cybermaggedon/cyberprobe/releases</a>,
look for the <samp>.tar.gz</samp> file.
</p>
<p>These files can be unwrapped, then configured:
</p>
<div class="example">
<pre class="example">tar xvfz cyberprobe-X.Y.tar.gz
cd cyberprobe-X.Y
./configure
make
sudo make install
</pre></div>

<p><samp>README.linux</samp> provides some hints for Linux users.
If installing on MacOS, read <samp>README.mac</samp>.
</p>
<span id="index-Checkout-from-git-repository"></span>
<span id="index-git-repository"></span>
<span id="Installing-from-git"></span><h3 class="heading">Installing from git</h3>

<p>To checkout the latest code using git:
</p>
<div class="example">
<pre class="example">git clone https://github.com/cybermaggedon/cyberprobe
</pre></div>

<p>To build, use:
</p>
<div class="example">
<pre class="example">autoreconf -fi
./configure
make
sudo make install
</pre></div>

<p>Powered by Github, project page is at
<a href="https://cybermaggedon.github.io/cyberprobe-docs/">https://cybermaggedon.github.io/cyberprobe-docs/</a>.
</p>
<span id="index-Docker"></span>
<span id="index-Containers"></span>
<span id="index-Cyberprobe_002c-docker-repository"></span>
<span id="index-cyberprobe_002c-docker-repository"></span>
<span id="index-cybermon_002c-docker-repository"></span>
<span id="Docker-repository"></span><h3 class="heading">Docker repository</h3>

<p>There are two Docker repositories containing the Cyberprobe distribution.
See <a href="http://hub.docker.com/r/cybermaggedon/cyberprobe">http://hub.docker.com/r/cybermaggedon/cyberprobe</a>.
</p>
<ul>
<li> <code>docker.io/cybermaggedon/cyberprobe</code>

</li><li> <code>docker.io/cybermaggedon/cybermon</code>

</li></ul>

<p>The only difference is the default command which is executed on running
the container.  Here are some container invocations you may find useful:
</p>
<ul>
<li> Run <code>cyberprobe</code>.  You will need to create a configuration file
and map it in to the container.
<div class="example">
<pre class="example">sudo docker -it --rm -v /etc/cyberprobe:/etc/cyberprobe_host \
  docker.io/cybermaggedon/cyberprobe \
  cyberprobe /etc/cyberprobe_host/cyberprobe.fg
</pre></div>

</li><li> Run <code>cybermon</code>.  The <code>cybermon</code> container exposes port
9000.
<div class="example">
<pre class="example">sudo docker -it --rm -p 9000:9000 -v \
  --net=host --privileged --cap-add=NET_ADMIN \
  docker.io/cybermaggedon/cybermon \
  cybermon -p 9000 -c /etc/cyberprobe/amqp-topic.lua
</pre></div>

</li><li> Run <code>cybermon-cassandra</code>.  You need to know the IP address
of the host side of the Docker bridge network, and provide addresses
of the Cassandra servers.
<div class="example">
<pre class="example">sudo docker -it --rm -v \
  docker.io/cybermaggedon/cybermon \
  cybermon-cassandra cyberprobe \
  10.142.146.6,10.142.146.8
</pre></div>

</li></ul>

<p>Running cyberprobe in a container makes the deployment easier, but it needs
to run with elevated privileges in order to sniff the network, which reduces
some of the advantages of running it in a container.
</p>
<span id="Dependencies"></span><h3 class="heading">Dependencies</h3>

<p>The code doesn&rsquo;t have many dependencies. Exotic dependencies are:
</p>
<span id="index-dependencies"></span>
<span id="index-Build-dependencies"></span>
<span id="index-Boost"></span>
<span id="index-Lua"></span>
<span id="index-libpcap"></span>
<span id="index-tcpdump"></span>
<span id="index-telnet"></span>
<span id="index-libtaxii"></span>
<span id="index-stix"></span>
<span id="index-ncurses"></span>
<span id="index-readline"></span>

<ul>
<li> LUA - 5.1 or later.

</li><li> GCC C++ compiler and development support.

</li><li> <code>libpcap</code>.

</li><li> <code>tcpdump</code> - not needed to build the software, but we use it in the
tutorial.

</li><li> <code>ncurses</code>, needed for the command line admin utility.

</li><li> <code>readline</code>, needed for the command line admin utility.

</li><li> For STIX support, <code>libtaxii</code> and <code>stix</code> are Python modules
made available at <a href="http://mitre.org">http://mitre.org</a> which can be downloaded using
<code>pip</code>.

</li><li> Protobuf support, protobuf compiler and grpc for gRPC support (optional).

</li></ul>



<hr>
<span id="Quick-start-tutorial"></span><div class="header">
<p>
Next: <a href="#Running-cyberprobe_002fcybermon-at-boot-time" accesskey="n" rel="next">Running cyberprobe/cybermon at boot time</a>, Previous: <a href="#Obtaining-the-software" accesskey="p" rel="prev">Obtaining the software</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Quick-start-tutorial-1"></span><h2 class="chapter">3 Quick start tutorial</h2>
<span id="index-Getting-started"></span>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Preparation" accesskey="1">Preparation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Using-cyberprobe" accesskey="2">Using <code>cyberprobe</code></a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Management-interface" accesskey="3">Management interface</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Integration-with-snort" accesskey="4">Integration with <code>snort</code></a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Using-cybermon" accesskey="5">Using <code>cybermon</code></a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Writing-your-own-configuration-file" accesskey="6">Writing your own configuration file</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Visualisation" accesskey="7">Visualisation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Threat-indicators" accesskey="8">Threat indicators</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<span id="Preparation"></span><div class="header">
<p>
Next: <a href="#Using-cyberprobe" accesskey="n" rel="next">Using <code>cyberprobe</code></a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Preparation-1"></span><h3 class="section">3.1 Preparation</h3>

<span id="index-Building"></span>
<span id="index-Downloading"></span>
<span id="index-Compilation"></span>
<span id="index-Packages"></span>
<span id="index-Installation"></span>
<span id="Build-software"></span><h3 class="heading">Build software</h3>

<p>For installation, see <a href="#Obtaining-the-software">Obtaining the software</a>.
There&rsquo;s a fair amount of development taking place in the git repository, so
you probably want to get the a package, or use the latest release on the
downloads page (<a href="http://github.com/cybermaggedon/cyberprobe/releases">http://github.com/cybermaggedon/cyberprobe/releases</a>).
</p>
<span id="index-Executables"></span>
<span id="index-Build-targets"></span>

<p>The compilation process compiles the following commands:
</p>
<dl compact="compact">
<dd>
<span id="index-cyberprobe-2"></span>
</dd>
<dt><code>cyberprobe</code></dt>
<dd><p>Packet capture.
</p>
<span id="index-cybermon-2"></span>
</dd>
<dt><code>cybermon</code></dt>
<dd><p>Data analyser, analyses the data streams and reports events.
</p>
<span id="index-etsi_002drcvr"></span>
</dd>
<dt><code>etsi-rcvr</code></dt>
<dd><p>Test decoder for ETSI format data.
</p>
<span id="index-cyberprobe_002dcli"></span>
</dd>
<dt><code>cyberprobe-cli</code></dt>
<dd><p>Cyberprobe control command-line client.
</p>
<span id="index-cybermon_002dbigquery"></span>
</dd>
<dt><code>cybermon-bigquery</code></dt>
<dd><p>Pub/sub subscriber, delivers events to Google Bigquery.
</p>
<span id="index-cybermon_002dcassandra"></span>
</dd>
<dt><code>cybermon-cassandra</code></dt>
<dd><p>Pub/sub subscriber, delivers events to Cassandra.
</p>
<span id="index-cybermon_002delasticsearch"></span>
</dd>
<dt><code>cybermon-elasticsearch</code></dt>
<dd><p>Pub/sub subscriber, delivers events to ElasticSearch.
</p>
<span id="index-cybermon_002dgaffer"></span>
</dd>
<dt><code>cybermon-gaffer</code></dt>
<dd><p>Pub/sub subscriber, delivers events to Gaffer.
</p>
<span id="index-cybermon_002dgeoip"></span>
</dd>
<dt><code>cybermon-geoip</code></dt>
<dd><p>Pub/sub subscriber, uses GeoIP to add location information to events, and
then republishes them.
</p>
<span id="index-cybermon_002ddetector"></span>
</dd>
<dt><code>cybermon-detector</code></dt>
<dd><p>Pub/sub subscriber, looks for matches for STIX IOCs, adds IOC information
to events, and then republishes them.
</p>
<span id="index-cybermon_002ddump"></span>
</dd>
<dt><code>cybermon-dump</code></dt>
<dd><p>Pub/sub subscriber, dumps out raw JSON messages.
</p>
<span id="index-cybermon_002dalert"></span>
</dd>
<dt><code>cybermon-dump</code></dt>
<dd><p>Pub/sub subscriber, alerts on matching IOCs.
</p>
</dd>
</dl>

<span id="index-Discussion-forums"></span>

<p>If it installs / builds without errors, then it&rsquo;s time to start something up. 
If you have problems you can&rsquo;t resolve raise an issue at
(<a href="https://github.com/cybermaggedon/cyberprobe/issues">https://github.com/cybermaggedon/cyberprobe/issues</a>).
</p>
<span id="index-Network-parameters"></span>
<span id="Establish-network-parameters"></span><h3 class="heading">Establish network parameters</h3>

<p>The simplest way to use cyberprobe is to use it on a Linux workstation, or
in a virtual machine.  Maybe you&rsquo;re using a Linux desktop now now?  If so,
you could use it to capture all the data going to/from the internet. This
will be a static configuration in order to keep things simple. We&rsquo;ll do
dynamic tracking later.
</p>
<p>In the next few steps, you&rsquo;ll use <code>cyberprobe</code> to capture some data,
on your workstation, and stream it to <code>etsi-rcvr</code> so that you know it&rsquo;s
working. But first, you&rsquo;ll need to collect some information about your
configuration.
</p>
<span id="index-ifconfig"></span>

<p>You need to know the name of the network interface you are using. The
command <code>/sbin/ifconfig</code> will show you all the network interfaces
your machine knows about. e.g.
</p>
<div class="example">
<pre class="example">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10
        [etc.]

eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500
        inet 192.168.1.80  netmask 255.255.255.0
        inet6 fe80::a60:6eff:fe81:7a75  prefixlen 64
        [etc.]
</pre></div>

<p>The lo interface is a loopback interface, and isn&rsquo;t really on the network,
so ignore that. It&rsquo;s an interface that gets packets going to
<code>127.0.0.1</code> and makes sure they end up handled by your
workstation. Your interface is quite likely to be called something like
eth0. The other thing you need to know is the IP address of your
workstation. The IP address is associated with an interface, so in the above
example, I can see I have an IP address <code>192.168.1.80</code>.
</p>
<p>Note: on some networks (like mine) the IP address is allocated
dynamically. In my case, the IP address is allocated by the broadband
router. If things aren&rsquo;t working as you expect, you should check your IP
address to check your workstation hasn&rsquo;t been allocated a new, different
address. In my case, I can tell the broadband router to permanently allocate
a particular IP address to this workstation, so that it won&rsquo;t change.
</p>



<hr>
<span id="Using-cyberprobe"></span><div class="header">
<p>
Next: <a href="#Management-interface" accesskey="n" rel="next">Management interface</a>, Previous: <a href="#Preparation" accesskey="p" rel="prev">Preparation</a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Using-cyberprobe-1"></span><h3 class="section">3.2 Using <code>cyberprobe</code></h3>
<span id="index-cyberprobe-3"></span>
<span id="index-cyberprobe-configuration"></span>

<span id="Starting-cyberprobe-with-a-configuration-file"></span><h3 class="heading">Starting cyberprobe with a configuration file</h3>

<p>The source code contains a file <samp>config.json</samp> which is a good template
for any configuration you&rsquo;re going to build. However, for the purpose of
this discussion, let&rsquo;s start from scratch. In order to do anything useful,
there are three essential elements to a cyberprobe configuration file:
interfaces, targets and endpoints. The system won&rsquo;t do anything useful
without those three configuration elements defined. Let&rsquo;s start with a very
simple configuration.
</p>
<p>Using your favourite text editor, create a text file, say <samp>c.cfg</samp> with the
following contents:
</p>
<div class="example">
<pre class="example">{
    &quot;interfaces&quot;: [
        { &quot;interface&quot;: &quot;eth0&quot; }
    ]
}
</pre></div>

<p>Note: You should replace the <code>eth0</code> string with the name of your
network interface. Remember? We discovered that when playing with the
<code>ifconfig</code> command.
</p>
<span id="index-Privileged-user"></span>

<p>We&rsquo;re ready to roll. We need to run as a privileged used because cyberprobe
captures data off the network interface. So, running as root, you need to
locate the place where you compiled the code, and run <code>cyberprobe</code>
giving it the name of the configuration file you just created:
</p>
<div class="example">
<pre class="example">cyberprobe c.cfg
</pre></div>

<p>If everything goes to plan, you should see the following output:
</p>
<div class="example">
<pre class="example">Capture on interface eth0 started.
</pre></div>

<p>If you see an error message, the obvious two things to check are:
</p>
<ul>
<li> Did you name a network interface correctly? See <code>ifconfig</code>
discussion above.

</li><li> Are you running as a privileged user?

</li></ul>

<p>If you see no output at all, check that your configuration file is correct.
</p>
<p>Once you are seeing the &quot;Capture on interface eth0&quot; line, then you&rsquo;ve
achieved success in this step, and are ready to move on.
</p>
<p>If you have everything working, there&rsquo;s one thing to note before moving on:
cyberprobe treats a broken configuration file the same as an empty
configuration file. With cyberprobe running, edit the configuration file,
and delete the query (&lsquo;<samp>?</samp>&rsquo;) prefix in the first line, so that it looks like
this:
</p>
<div class="example">
<pre class="example">FIXME {
</pre></div>

<p>You&rsquo;ve now broken the configuration file. It&rsquo;s not valid JSON any more, so
the parsing fails. You should see this output from <code>cyberprobe</code>:
</p>
<div class="example">
<pre class="example">Capture on interface eth0 stopped.
</pre></div>

<p>If you repair the damage to the configuration file, everything will start
working again. The lesson here is: If you find that <code>cyberprobe</code>
won&rsquo;t recognise any resources, it&rsquo;s likely that your configuration file is
invalid. Use a JSON parser to check that the file is valid
if you&rsquo;re not getting the results you expect.
</p>
<span id="index-Target"></span>
<span id="index-cyberprobe_002c-target"></span>
<span id="Adding-a-target"></span><h3 class="heading">Adding a target</h3>

<p>We have <code>cyberprobe</code> running, but it isn&rsquo;t doing anything
useful. Remember, I said that a useful configuration consists of three
minimal elements: interfaces, targets and endpoints? Well, currently we only
have interfaces defined. That means that <code>cyberprobe</code> is capturing
packets off of the network, but throwing them away.
</p>
<p>Let&rsquo;s add a target. Edit the targets block of the configuration file. We
need an entry describing the IP address of my workstation. Remember? We
discovered that with the ifconfig command earlier? Instead of
<code>192.168.1.80</code> use the IP address of your workstation.
</p>
<div class="example">
<pre class="example">{
    &quot;interfaces&quot;: [
        { &quot;interface&quot;: &quot;eth0&quot; }
    ],
    &quot;targets&quot;: [
        {
            &quot;address&quot;: &quot;192.168.1.80&quot;,
            &quot;device&quot;: &quot;123456&quot;
        }
    ]
}
</pre></div>

<p>If successful, you should see new output from <code>cyberprobe</code>:
</p>
<div class="example">
<pre class="example">Added target 192.168.1.80 -&gt; 123456.
</pre></div>

<p>The target configuration allows specification of IPv4 and IPv6 addresses, and
addresses can include a mask, which allows IP address matching to be applied
in a wildcard configuration.  See <a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a>
</p>
<p>At this step, we&rsquo;re capturing packets, spotting target addresses, but as
there&rsquo;s no endpoint defined there&rsquo;s still nowhere to send the data. So, this
is still a useless configuration. On to the next step...
</p>
<span id="Adding-an-endpoint-1"></span><h3 class="heading">Adding an endpoint</h3>
<span id="Adding-an-endpoint"></span>
<p>Adding an endpoint to the configuration file will define a place where the
captured data is sent. Before adding an endpoint, let&rsquo;s make sure there&rsquo;s
something ready to receive the data.
</p>
<p>In a separate terminal window, navigate to the <code>cyberprobe</code> build,
and run:
</p>
<span id="index-etsi_002drcvr-1"></span>

<div class="example">
<pre class="example">etsi-rcvr 10000 | tcpdump -n -r -
</pre></div>

<p>The <code>etsi-rcvr</code> program opens a TCP port listening on port 10000 for
a stream of ETSI data, and on standard output, writes the IP packets it sees
in PCAP format. The tcpdump command receives this PCAP data, and outputs
packet summaries.
</p>
<p>If that starts successfully, the next step is to plumb a connection from
<code>cyberprobe</code> to <code>etsi-rcvr</code>.
</p>
<p>Next, edit the configuration file, and edit the endpoints block to deliver
packets to a local service on port 10000:
</p>
<span id="index-Endpoint"></span>
<span id="index-cyberprobe_002c-endpoint"></span>

<div class="example">
<pre class="example">{
    &quot;interfaces&quot;: [
        { &quot;interface&quot;: &quot;eth0&quot; }
    ],
    &quot;targets&quot;: [
        {
            &quot;address&quot;: &quot;192.168.1.80&quot;,
            &quot;device&quot;: &quot;123456&quot;
        }
    ],
    &quot;endpoints&quot;: [
        {
            &quot;hostname&quot;: &quot;localhost&quot;,
            &quot;port&quot;: 10000,
            &quot;transport&quot;: &quot;tcp&quot;,
            &quot;type&quot;: &quot;etsi&quot;
        }
    ]
}
</pre></div>

<p>If that worked, you should see <code>cyberprobe</code> start the endpoint:
</p>
<div class="example">
<pre class="example">Added endpoint localhost:10000 of type etsi
</pre></div>

<p>Hopefully you&rsquo;ll start to see some output from tcpdump...
</p>
<span id="Capturing-data"></span><h3 class="heading">Capturing data</h3>

<p>At this step, <code>cyberprobe</code> should be forwarding an network traffic
your workstation generates to the tcpdump command, so that you see data. Any
average workstation is generating network traffic all the time, so you won&rsquo;t
need to do anything. But if you see nothing, you can do something like,
visit the Google home page in a browser on your workstation. You should see
something like this pouring from the tcpdump.
</p>
<div class="example">
<pre class="example">18:54:24.376838 IP 192.168.1.80.54249 &gt; 212.58.244.71.http: Flags [P.],
 seq 1:673, ack 1, win 115, options [nop,nop,TS val 129851063 ecr 33669
55869], length 672
18:54:24.390768 IP 212.58.244.71.http &gt; 192.168.1.80.54249: Flags [.], 
ack 673, win 124, options [nop,nop,TS val 3366955882 ecr 129851063], le
ngth 0
18:54:24.392909 IP 212.58.244.71.http &gt; 192.168.1.80.54249: Flags [P.],
 seq 1:1796, ack 673, win 124, options [nop,nop,TS val 3366955884 ecr 1
29851063], length 1795
</pre></div>

<p>At this step, it&rsquo;s worth having a quick play with the reconnection
mechanism. Stop and start <code>etsi-rcvr</code>, and you&rsquo;ll see that
<code>cyberprobe</code> reconnects automatically:
</p>
<span id="index-Connection-reset"></span>
<span id="index-Connection-restart"></span>
<span id="index-Reconnection"></span>

<div class="example">
<pre class="example">ETSI LI connection to localhost:10000 failed.
Will reconnect...
ETSI LI connection to localhost:10000 established.
</pre></div>

<p>We don&rsquo;t guarantee zero data loss on a reconnect.
</p>


<hr>
<span id="Management-interface"></span><div class="header">
<p>
Next: <a href="#Integration-with-snort" accesskey="n" rel="next">Integration with <code>snort</code></a>, Previous: <a href="#Using-cyberprobe" accesskey="p" rel="prev">Using <code>cyberprobe</code></a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Management-interface-1"></span><h3 class="section">3.3 Management interface</h3>
<span id="index-Management"></span>
<span id="index-cyberprobe_002c-management"></span>

<p>At this step, we&rsquo;ll setup a control port, and use it modify the
configuration of <code>cyberprobe</code>.
</p>
<p>First step is to modify the configuration file to include this line, just
after the <code>&lt;configuration&gt;</code> line:
</p>
<span id="index-Authentication"></span>

<div class="example">
<pre class="example">{
    &quot;interfaces&quot;: [
        { &quot;interface&quot;: &quot;eth0&quot; }
    ],
    &quot;targets&quot;: [
        {
            &quot;address&quot;: &quot;192.168.1.80&quot;,
            &quot;device&quot;: &quot;123456&quot;
        }
    ],
    &quot;endpoints&quot;: [
        {
            &quot;hostname&quot;: &quot;localhost&quot;,
            &quot;port&quot;: 10000,
            &quot;transport&quot;: &quot;tcp&quot;,
            &quot;type&quot;: &quot;etsi&quot;
        }
    ],
    &quot;controls&quot;: [
        {
            &quot;port&quot;: 8888,
            &quot;username&quot;: &quot;admin&quot;,
            &quot;password&quot;: &quot;mypassword&quot;
        }
    ]
}
</pre></div>

<p>That declares that a management service needs to be run on port 8888. The
authentication details are provided too. You should see this output from
<code>cyberprobe</code>:
</p>
<div class="example">
<pre class="example">Starting control on port 8888
</pre></div>

<span id="index-cyberprobe_002dcli-1"></span>

<p>Good! Now need to connect and interrogate the targets list.  The API
is a simple text protocol with requests and responses encoded in JSON.
The <code>cyberprobe-cli</code> command gives you an interactive CLI
interface.
</p><div class="example">
<pre class="example">cyberprobe-cli localhost 8888
</pre></div>

<p>You are then prompted for a username and password:
</p><div class="example">
<pre class="example">$ cyberprobe-cli  localhost 8888
Connected.  You must authenticate.
User: admin
Password: **********
&gt; 
</pre></div>

<p>Press <code>TAB</code> to see command auto-completion.
</p>
<div class="example">
<pre class="example">&gt; show endpoints 
Hostname                                Port    Type      
--------                                ----    ----      
localhost                               9000    etsi      
localhost                               9001    etsi      
localhost                               9002    nhis1.1   
&gt; add target my-machine4 ipv6 fe80:5551:4024:8196:8175::/40 dark-net
&gt; show targets
Device              Class   Address                       Mask    
----                -----   -------                       ----    
my-machine          ipv4    0.0.0.0                       /0       
my-machine2         ipv4    10.0.0.0                      /8       
my-machine4         ipv6    fe80:5551:4000::              /40      
my-machine3         ipv6    fe80:4124:5696::              /48      
&gt; remove target my-machine4 ipv6 fe80:5551:4024:8196:8175::/40 dark-net
&gt; add interface vxlan:8124 0.5 not port 9000
&gt; show interfaces 
Interface           Delay   Filter                                            
---------           -----   ------                                            
vxlan:4789          0.5     not port 10001 and not port 10002                 
vxlan:4790          0.3                                                       
vxlan:8124          0.5     not port 9000                                     
</pre></div>

<p>The interface isn&rsquo;t pretty, but you get the idea. You can change almost
everything that you can manage by changing the configuration file.
</p>
<p>Note: The the management interface changes the active state of
<code>cyberprobe</code> but it doesn&rsquo;t change the configuration file. So,
configuration changes made through the management interface are &rsquo;lost&rsquo; when
you restart <code>cyberprobe</code>.
</p>
<p>Note also that you may get some weird results if you use the configuration
file AND the control interface to manage the same resources, so you probably
don&rsquo;t want to do that.
</p>
<p>See <a href="#cyberprobe_002dcli-invocation"><code>cyberprobe-cli</code> invocation</a>.
</p>


<hr>
<span id="Integration-with-snort"></span><div class="header">
<p>
Next: <a href="#Using-cybermon" accesskey="n" rel="next">Using <code>cybermon</code></a>, Previous: <a href="#Management-interface" accesskey="p" rel="prev">Management interface</a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Integration-with-snort-1"></span><h3 class="section">3.4 Integration with <code>snort</code></h3>
<span id="index-snort_002c-integration"></span>
<span id="index-Integration-with-snort"></span>

<p>In this step, we&rsquo;ll add the excellent IDS, Snort to the mix. If you don&rsquo;t
know Snort, it scans network traffic for patterns, and can take various
actions when those patterns are discovered. It is typically used to detect
network attacks, and the Snort folks maintain a huge collection of patterns
that will identify known network attacks. The Snort team maintain the
project at <a href="http://www.snort.org">http://www.snort.org</a>.
</p>
<p>If you want to try out the Snort integration, you need to head over to the
Snort home page, download and install Snort.  Or install the appropriate
package with your distribution.
</p>
<p>Once you have it installed, to simplify things, you&rsquo;ll want to put a
rule in place that will definitely identify things on your
network. The easiest way is to add a local rule that identifies your
workstation. First of all, you&rsquo;ll want to make sure your Snort
configuration file (probably <samp>/etc/snort/snort.conf</samp>) loads a
local rules file. So, it should contain something like this:
</p>
<span id="index-snort_002c-rules"></span>
<span id="index-snort_002c-signatures"></span>

<div class="example">
<pre class="example"># site specific rules
include $RULE_PATH/local.rules
</pre></div>

<p>Then, to identify your workstation, add a rule like this to your local rules
file (probably <samp>/etc/snort/rules/local.rules</samp>):
</p>
<div class="example">
<pre class="example">alert tcp 192.168.1.80 any -&gt; any 80 (msg:&quot;Web&quot;; 
classtype:misc-activity;sid:200; rev:1;)
</pre></div>

<p><code>cyberprobe</code> itself needs to be configured to receive Snort
alerts. You do that by adding a block to the configuration file at the top
level:
</p>
<div class="example">
<pre class="example">{
    ...
    &quot;snort-alerters&quot;: [
        {
            &quot;path&quot;: &quot;/var/log/snort/snort_alert&quot;,
            &quot;duration&quot;: 60
        }
    ]
    ...
}
</pre></div>

<p>That says, Snort alerts will result in dynamic collection of data for 60
seconds from identification. While you&rsquo;re in the configuration file, you can
remove the static IP address target line. Make sure the targets block is empty
or removed from the configuration:
</p>
<div class="example">
<pre class="example">{
...
    &quot;targets&quot;: [],
...
}

</pre></div>

<p><code>cyberprobe</code> should respond:
</p>
<span id="index-snort-alerts"></span>

<div class="example">
<pre class="example">Removed target 192.168.1.80 -&gt; 123456.
Start snort alerter on /var/log/snort/snort_alert
</pre></div>

<p>Now I can run Snort in IDS mode. Snort needs to run as &rsquo;root&rsquo;:
</p>
<div class="example">
<pre class="example">snort -i eth0 -A unsock -N -l /var/log/snort/ -c /etc/snort/snort.conf
</pre></div>

<p>Thanks to our Snort rule, when our workstation generates network data, Snort
will detect it, trigger our rule, and alert <code>cyberprobe</code>. You should
see <code>cyberprobe</code> say:
</p>
<div class="example">
<pre class="example">Hit on signature ID 200, targeting 192.168.1.80
</pre></div>

<p>Also, once the rule is triggered, you should see evidence of packet data
from the <code>tcpdump</code> command, as before. <code>cyberprobe</code> causes
the targeting to time out after a period of time. If further alerts are
seen, the targeting lifetime is targeted. If no further alerts are seen the
IP address targeting is deleted. If you can convince your workstation to
stop creating network data, by e.g. not using it for a minute or so, then
you should see the rule time out:
</p>
<div class="example">
<pre class="example">Stopped targeting on 192.168.1.80
</pre></div>

<p>In practice this may be harder than you think, as workstations generate
network traffic all the time. You may have to turn off your email clients
and close the web browse. Your attempt to silence your workstation may be
further thwarted by the operating system checking for patches without you
knowing.
</p>
<span id="index-cyberprobe_002c-delay"></span>
<span id="index-Delay"></span>
<span id="Introducing-a-delay"></span><h3 class="heading">Introducing a delay</h3>

<p>Your Snort integration suffers from a particular problem now. The time taken
for Snort to inspect some packets, generate an alert and for
<code>cyberprobe</code> to get the IP address targeted is not zero. It is hard
to measure, but it is going to be a significant chunk of a millisecond. The
problem is that by the time <code>cyberprobe</code> is targeting the IP
address, the network attcker&rsquo;s packets have long gone. The result is, that
while <code>cyberprobe</code> is now targetting the attacker, it won&rsquo;t capture
the original network attack.
</p>
<p>Our solution is to introduce a packet delay in <code>cyberprobe</code>. The
packets entering <code>cyberprobe</code> are kept in a time-delay queue and are
processed once that delay expires. You can configure a delay, by putting the
delay attribute in an interface specfication. e.g.
</p>
<div class="example">
<pre class="example">...
    &quot;interfaces&quot;: [
        { &quot;interface&quot;: &quot;eth0&quot;, &quot;delay&quot;: 0.2 }
    ]
...
</pre></div>

<p>0.2 second should be plenty enough. You should be able to see this delay in
action: When you generate network traffic, you should be able to see the
delay between network activity taking place, and the corresponding burst of
activity from tcpdump.
</p>
<p>At this point, you&rsquo;ve completed the guided tour of <code>cyberprobe</code>, the
packet capture tool. If that&rsquo;s all you need, the rest of the tutorial will
probably have less interest to you: In the following steps, we&rsquo;ll start to
analyse and act on the captured data.
</p>



<hr>
<span id="Using-cybermon"></span><div class="header">
<p>
Next: <a href="#Writing-your-own-configuration-file" accesskey="n" rel="next">Writing your own configuration file</a>, Previous: <a href="#Integration-with-snort" accesskey="p" rel="prev">Integration with <code>snort</code></a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Using-cybermon-1"></span><h3 class="section">3.5 Using <code>cybermon</code></h3>
<span id="index-cybermon-3"></span>
<span id="index-cybermon_002c-configuration"></span>
<span id="Introducing-cybermon"></span><h3 class="heading">Introducing <code>cybermon</code></h3>

<p>The previous 9 steps have all been about <code>cyberprobe</code>. If you&rsquo;ve got
this far successfully, you pretty much know all there is to know about
<code>cyberprobe</code>. It is time to start doing something more useful with
all that data you are capturing. In this step we&rsquo;ll start up
<code>cybermon</code> and look at the data.
</p>
<span id="index-monitor_002elua"></span>

<p>Remember that <code>etsi-rcvr</code> command you started in step <a href="#Adding-an-endpoint">Adding an endpoint</a>? Stop that, and start <code>cybermon</code>. Two arguments are
needed: A TCP port number to receive the data on, and a configuration which
tells it what to do. A number of configuration files are bundled in with the
source code, there should be a basic one called <samp>monitor.lua</samp> which
is now installed in the etc directory, depending on where you installed the
software:
</p>
<div class="example">
<pre class="example">cybermon -p 10000 -c /usr/local/etc/cyberprobe/monitor.lua
</pre></div>

<p>Now when you generate network traffic, some of the traffic will be presented
in a reasonably intelligent form. For example, I do a naming service lookup
for <code>www.google.com</code>...
</p>
<div class="example">
<pre class="example">host -t a www.slashdot.org
</pre></div>

<span id="index-DNS"></span>

<p>The DNS protocol is parsed, and presented in a human readable form. I can
see the request, and the response:
</p>
<div class="example">
<pre class="example">SNORTc0a80150: 192.168.1.80:54633 -&gt; 192.168.1.1:53. DNS query
    Query: www.slashdot.org

SNORTc0a80150: 192.168.1.1:53 -&gt; 192.168.1.80:54633. DNS response
    Query: www.slashdot.org
    Answer: www.slashdot.org -&gt; 216.34.181.48
</pre></div>

<p>I see the query travelling from my workstation to the broadband router, and
then the response from the broadband router contains an answer field mapping
the name to an address. HTTP protocols are also decoded. Get the Slashdot
home page...
</p>
<div class="example">
<pre class="example">wget -O- 'http://www.slashdot.org/'
</pre></div>

<p>...and amongst all the other stuff, you see the HTTP request and response...
</p>
<div class="example">
<pre class="example">SNORTc0a80150: 192.168.1.80:34284 -&gt; 216.34.181.45:80. HTTP GET request
    URL /
    Connection: Keep-Alive
    User-Agent: Wget/1.14 (linux-gnu)
    Host: slashdot.org
    Accept: */*

SNORTc0a80150: 216.34.181.45:80 -&gt; 192.168.1.80:34284. HTTP response 200
OK
    URL http://slashdot.org/
    Connection: keep-alive
    Content-Length: 113468
    Date: Mon, 26 Aug 2013 13:13:25 GMT
    Age: 17
    X-Varnish: 1493567531 1493567417
    X-XRDS-Location: http://slashdot.org/slashdot.xrds
    Cache-Control: no-cache
    Vary: Accept-Encoding
    SLASH_LOG_DATA: shtml
    Pragma: no-cache
    Content-Type: text/html; charset=utf-8
    Server: Apache/2.2.3 (CentOS)
</pre></div>

<span id="Trying-other-configuration-files"></span><h3 class="heading">Trying other configuration files</h3>

<p>In the previous step, you started <code>cybermon</code> with the
<samp>monitor.lua</samp>
configuration file.  
</p>
<span id="index-json_002elua"></span>

<p>Configuration file <samp>json.lua</samp> causes <code>cybermon</code> to output the
events as JSON objects.
</p>
<div class="example">
<pre class="example">cybermon -p 10000 -c /usr/local/etc/cyberprobe/json.lua
</pre></div>

<p>The <samp>quiet.lua</samp> configuration file does nothing. It may be a good place
to start hacking your own configuration file. Which is exactly what we&rsquo;ll do
in the next step.
</p>


<hr>
<span id="Writing-your-own-configuration-file"></span><div class="header">
<p>
Next: <a href="#Visualisation" accesskey="n" rel="next">Visualisation</a>, Previous: <a href="#Using-cybermon" accesskey="p" rel="prev">Using <code>cybermon</code></a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Writing-your-own-configuration-file-1"></span><h3 class="section">3.6 Writing your own configuration file</h3>

<p>Now, take a copy of the <samp>quiet.lua</samp> configuration file, and have a look
at it. It is a Lua module which defines a minimum of one function,
&lsquo;<samp>event</samp>&rsquo;, which is called when events occur.  LUA
is a lightweight scripting langauge which is really good as a configuration
language. This function is called when a TCP connection is
made:
</p>
<span id="index-event"></span>

<div class="example">
<pre class="example">observer.event = function(e)
end
</pre></div>

<p>Let&rsquo;s get hacking! The header parameter is a LUA table which contains
key/value pairs from the header. The url parameter contains the full URL of
the response. The body parameter contains the payload body as an empty
string. Let&rsquo;s start simple:
</p>
<span id="index-http_005fresponse"></span>

<div class="example">
<pre class="example">observer.event = function(e)
  if e.action == &quot;http_response&quot; then
    print(url)
  end
end
</pre></div>

<p>Then run that up...
</p>
<div class="example">
<pre class="example">cybermon -p 10000 -c my.lua
</pre></div>

<p>Now, do some web browsing, and you should see a list of URLs flying
past. Each web page typically consists of several HTTP requests, but you
should be able to see the URLs associated with all of the web pages you
visit. Let&rsquo;s tart that up a little more:
</p>
<div class="example">
<pre class="example">-- This function is called when an HTTP response is observed.
observer.event = function(e)

  if e.action == &quot;http_response&quot; then

    -- Take first 40 characters of URL
    local u = url:sub(1,40)

    -- Get Content-Type (first 20 characters)
    local ct
    ct = &quot;&quot;
    for key, value in pairs(header) do
      if key:lower() == &quot;content-type&quot; then
        ct = value:sub(1,20)
      end
    end

    io.write(string.format(&quot;%-40s %-20s %d\n&quot;, u, ct, #body))

  end

end
</pre></div>

<p>That basically outputs three columns: The URL (truncated to 40 characters),
the body content type (truncated to 20 characters) and the HTTP response
payload length. Here&rsquo;s what I get from visiting Slashdot:
</p>
<div class="example">
<pre class="example">http://widget-cdn.rpxnow.com/manifest/sh text/javascript;char 42980
http://slashdot.org/                     text/html; charset=u 40105
http://ad.doubleclick.net/adj/ostg.slash text/javascript; cha 5625
http://pagead2.googlesyndication.com/pag application/x-shockw 33347
http://ad.doubleclick.net/adj/ostg.slash text/javascript; cha 540
http://ad.doubleclick.net/adj/ostg.slash text/javascript; cha 42
http://ad.doubleclick.net/adj/ostg.slash text/javascript; cha 452
http://pagead2.googlesyndication.com/pag                      0
</pre></div>

<span id="Forging-a-TCP-reset"></span><h3 class="heading">Forging a TCP reset</h3>

<p>So far, this has just been monitoring. It&rsquo;s time to add data to the network!
From the LUA functions, there are a couple of functions available which
allow you to put some packets back onto the network.
</p>
<span id="index-TCP-reset"></span>
<span id="index-Packet-forgery"></span>
<span id="index-Packet-injection"></span>
<span id="index-cyberprobe_002c-delay-1"></span>
<span id="index-Delay-1"></span>

<p>But first... there&rsquo;s a problem. You remember in step 9, we added a delay?
That&rsquo;s not going to work with packet forgery, because by the time we&rsquo;ve
forged a packet and sent it on to the network, it&rsquo;s too late. So, we need to
change our interface back so that there&rsquo;s no delay on the interface. That
means, we&rsquo;re monitoring network data, but we&rsquo;ll miss the original attack
which triggered a Snort alert.
</p>
<div class="example">
<pre class="example">    ...
    &quot;interfaces&quot;: [
        { &quot;interface&quot;: &quot;eth0&quot;, &quot;delay&quot;: 0.0 }
    ],
    ...        
</pre></div>

<p>Once you have this code working, you might be able to mess with the delay
parameter to see if you can pick a low-latency value that works for you. On
my network, the value 0.02 is low enough to allow a response to allow packet
forgery to work. Any higher, and the forged packets are too late to beat the
real packets.
</p>
<p>The LUA interface passes a context variable to many of the LUA functions,
which gives access to <code>cybermon</code> information and the packet forgery
functions. In this step, we&rsquo;re going to forge a TCP reset on any connections
which are from or to port 80. Hack the configuration file:
</p>
<span id="index-event-1"></span>
<span id="index-context"></span>
<span id="index-connected_005fup"></span>

<div class="example">
<pre class="example">observer.event = function(e)

  if e.action == &quot;connected_up&quot; then

    -- Get TCP ports.
    local cls, src_addr, dest_addr
    cls, src_addr = e.context:get_src_addr()
    cls, dest_addr = e.context:get_dest_addr()

    -- check if it is port 80.
    if not((src_addr == &quot;80&quot;) or (dest_addr == &quot;80&quot;)) then
      -- Ignore non-HTTP traffic
      return
    end

    -- TCP reset    
    print(&quot;Reset on HTTP connection.&quot;)
    e.context:forge_tcp_reset(context)

  end

end
</pre></div>

<p>Now before we go any further, <code>cybermon</code> needs to run as root in
order to use either of the packet forgery functions. Packet forgery needs
access to the raw IP socket layer, which is a privileged operation. Start
that up:
</p>
<div class="example">
<pre class="example">sudo cybermon -p 10000 -c my.lua
</pre></div>

<p>Now start web browsing, and you should see a bunch of &quot;Reset on HTTP
connection&quot; messages. Also, you&rsquo;ll see a page saying &quot;The connection was
reset&quot; in your web browser. That&rsquo;s a fairly anti-social configuration to run
on any network. See the <samp>forge-reset.lua</samp> example for a more useful
configuration. It disrupts network traffic going to/from an SSH server which
isn&rsquo;t from your administration workstation.
</p>
<p>On any network with an SSH service open to the outside world, you might want
to use firewall rules to prevent access to the SSH service from addresses
outside of your network, but you could use <code>cybermon</code> as a
belt-and-braces protection mechanism.
</p>
<p>Another example is where you know the user community on your network is
being targeted by phishing emails. Your first step is to try to get the
phishing emails out of their inboxes, getting your email provider to filter
the attacks. But a backup attack would be to make sure your users can&rsquo;t get
to the phisher&rsquo;s web site. The event function allows us to reset
requests going to a particular web site.
</p>
<span id="index-event-2"></span>
<span id="index-context-1"></span>
<span id="index-http_005frequest"></span>

<div class="example">
<pre class="example">observer.event = function (e)

  if e.action == &quot;http_request&quot; then

    if e.header[&quot;Host&quot;] == &quot;example.org&quot; then
      print(&quot;Reset on HTTP request&quot;)
      context:forge_tcp_reset(context)
    end

    if e.header[&quot;Host&quot;] == &quot;www.example.org&quot; then
      print(&quot;Reset on HTTP request&quot;)
      context:forge_tcp_reset(context)
    end

  end

end
</pre></div>

<span id="Forging-a-DNS-response"></span><h3 class="heading">Forging a DNS response</h3>

<span id="index-Forging_002c-DNS-response"></span>

<p>In this step, we&rsquo;ll detect a particular DNS request, and forge a
response. First of all, you&rsquo;ll need to familiarise yourself with host which
is a useful DNS test tool. e.g.
</p>
<div class="example">
<pre class="example">$ host -t a example.org
example.org has address 93.184.216.119
</pre></div>

<p>The <code>example.org</code> name has been resolved to a particular IP
address. Let&rsquo;s hack the DNS request function in <samp>my.lua</samp>:
</p>
<span id="index-event-3"></span>
<span id="index-context-2"></span>
<span id="index-dns_005fmessage"></span>

<div class="example">
<pre class="example">-- This function is called when a DNS message is observed.
local observer = {}

observer.event = function(e)
  if e.action ~= &quot;dns_message&quot; then
    return
  end

  if e.header.qr == 0 and #e.queries == 1 and e.queries[1].name == &quot;example.org&quot;
    and e.queries[1].type == 1 and e.queries[1].class == 1 then

    -- Send a fake response

    -- Set query/response flag to 'response'
    header = e.header
    header.qr = 1
    header.ancount = 2

    -- Two answers, give example.org 2 alternative IP addresses.
    answers = {}
    answers[1] = {}
    answers[1].name = &quot;example.org&quot;
    answers[1].type = 1
    answers[1].class = 1
    answers[1].rdaddress = &quot;1.2.3.4&quot;
    answers[2] = {}
    answers[2].name = &quot;example.org&quot;
    answers[2].type = 1
    answers[2].class = 1
    answers[2].rdaddress = &quot;5.6.7.8&quot;

    -- Two answers
    e.header.ancount = 2

    io.write(&quot;Forging DNS response!\n&quot;)

    e.context:forge_dns_response(header, e.queries, answers, {}, {})

  end

end

-- Return the table
return observer
</pre></div>

<p>So, this example, checks that the query is one we want to mess with. If it
is, we turn the query structures into response structures, and hand them
back to <code>cybermon</code> to do a forgery. The above example forges the
address <code>1.2.3.4</code>. Start up <code>cybermon</code> with the script:
</p>
<div class="example">
<pre class="example">cybermon -p 10000 -c my.lua
</pre></div>

<p>If everything is working your host command will show a different result:
</p>
<div class="example">
<pre class="example">$ host -t a example.org
example.org has address 1.2.3.4
</pre></div>

<p>DNS forgery has applications in blocking access to a phishers
resources on the internet, you might want to redirect your users to an
address which is inside your network.
</p>
<p>The <a href="#cybermon-configuration"><code>cybermon</code> configuration</a> documentation details the LUA
interface in detail if
you want to find out what else you can do in your LUA code.
</p>



<hr>
<span id="Visualisation"></span><div class="header">
<p>
Next: <a href="#Threat-indicators" accesskey="n" rel="next">Threat indicators</a>, Previous: <a href="#Writing-your-own-configuration-file" accesskey="p" rel="prev">Writing your own configuration file</a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Visualisation-1"></span><h3 class="section">3.7 Visualisation</h3>
<span id="index-Visualisation"></span>
<span id="index-ElasticSearch"></span>
<span id="index-Storing-observations"></span>

<span id="Storing-observations"></span><h3 class="heading">Storing observations</h3>

<p>Now we need somewhere to store the observations which <code>cybermon</code>
discovers. There are many candidates for a storage repository, but my
favourite for this sort of scenario is the excellent ElasticSearch (
<a href="http://www.elasticsearch.org/">http://www.elasticsearch.org/</a>). It is flexible, offers a huge amount
of functionality, and is incredibly simple to interface with, thanks to its
JSON API. So, your next action is to head over to the download page
(<a href="http://www.elasticsearch.org/download/">http://www.elasticsearch.org/download/</a>) and get hold of the latest
version. I&rsquo;m using version 7.0 to build this tutorial but the
ElasticSearch API has proven hugely stable, so should work with the latest.
</p>
<p>The easiest way to run ElasticSearch is as a Docker container, although you
could download and run the distribution.
</p>
<div class="example">
<pre class="example">docker run --name elasticsearch -p 9200:9200 \
  elasticsearch:7.0
</pre></div>

<p>One brilliant thing about ElasticSearch is that it needs almost no
configuration to get an instance started. You will need to make one
configuration change to ElasticSearch if there are other instances running
on your network: you need need to change <code>cluster.name</code> to some unique
string in <samp>config/elasticsearch.yml</samp>, otherwise your ElasticSearch
instance might join another cluster on your network, which could complicate
things.
</p>
<p>You can check you have ElasticSearch up and running using a command such as
this:
</p>
<div class="example">
<pre class="example">wget -q -O- http://localhost:9200
</pre></div>

<p>The response will look something like this:
</p>
<span id="index-JSON"></span>

<div class="example">
<pre class="example">{
  &quot;name&quot; : &quot;gAbVXGZ&quot;,
  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,
  &quot;cluster_uuid&quot; : &quot;TPZLBGYnTNqe0-LVLiF6yw&quot;,
  &quot;version&quot; : {
    &quot;number&quot; : &quot;7.0.0&quot;,
    &quot;build_hash&quot; : &quot;bd92e7f&quot;,
    &quot;build_date&quot; : &quot;2017-12-17T20:23:25.338Z&quot;,
    &quot;build_snapshot&quot; : false,
    &quot;lucene_version&quot; : &quot;7.1.0&quot;,
    &quot;minimum_wire_compatibility_version&quot; : &quot;5.6.0&quot;,
    &quot;minimum_index_compatibility_version&quot; : &quot;5.0.0&quot;
  },
  &quot;tagline&quot; : &quot;You Know, for Search&quot;
}
</pre></div>

<p>Once ElasticSearch is running, you can get <code>cybermon</code> to load
observations into it.  Before we do that, need RabbitMQ to provide the
pub/sub infrastructure:
</p>
<div class="example">
<pre class="example">docker run --name amqp -p 5672:5672 -p 15672:15672 \
    docker.io/library/rabbitmq:3.7.4-management
</pre></div>

<p>Next we need to run two commands.
Firstly, <code>cybermon</code> is run to output events on a RabbitMQ
pub/sub queue.
</p>
<div class="example">
<pre class="example">cybermon -p 10000 -c /usr/local/etc/cyberprobe/amqp-topic.lua
</pre></div>

<p>While that&rsquo;s running, we can start the ElasticSearch loader:
</p>
<div class="example">
<pre class="example">cybermon-elasticsearch cyberprobe
</pre></div>

<p>After some network data has been observed, you should be able to see results
loaded into ElasticSearch using the following command:
</p>
<div class="example">
<pre class="example">es=localhost:9200
curl -s -XPOST \
  &quot;http://$es/cyberprobe/_search?pretty=true&quot; -d '
{
  &quot;query&quot; : {
    &quot;match_all&quot;: {}
  }
}
'
</pre></div>

<p>You should see some stuff which looks like data scrolling past on the
screen. If your response looks like the following result, that&rsquo;s not so
good, as it means there are no results. See <code>hits.total</code>? Zero means no
results.
</p>
<div class="example">
<pre class="example">{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 5,
    &quot;successful&quot; : 5,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : 0,
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [ ]
  }
}
</pre></div>

<p>If you see a lot of information scrolling past on the screen, that&rsquo;s good.
</p>
<p><code>cybermon-elasticsearch</code> maps the <code>cybermon</code>
observations into a form which is appropriate to store in
ElasticSearch. 
</p>
<span id="index-Kibana_002c-dashboard"></span>
<span id="index-Dashboard"></span>
<span id="Visualising-observations"></span><h3 class="heading">Visualising observations</h3>

<p>Having loaded the observations into ElasticSearch, it&rsquo;s easy to do some
visualisation with Kibana. Kibana is a brilliant, user-configurable
dashboard package designed to sit on ElasticSearch. The dashboard runs in
your browser.
</p>
<p>First thing to do is to run up a Kibana container.  Kibana is made by the
ElasticSearch people, download page is at
<a href="http://www.elasticsearch.co/downloads/kibana">http://www.elasticsearch.co/downloads/kibana</a>.
</p>
<p>Run a Kibana container:
</p>
<div class="example">
<pre class="example">docker run --name kibana \
  -e ELASTICSEARCH_URL=http://elasticsearch:9200/ -p 5601:5601 \
  --link elasticsearch:elasticsearch \
  kibana:7.0
</pre></div>

<p>Kibana starts on port 5601, so point your browser at e.g.
<a href="http://localhost:5601">http://localhost:5601</a>
</p>
<p>and hopefully you see Kibana&rsquo;s &quot;Welcome to Kibana&quot; screen.
</p>
<p>Read the Kibana tutorial and start playing with the data.
First thing you need to do is
create a <code>cyberprobe</code> index with the time field <code>time</code>.
The go to the Visualize tab to see raw data.
</p>
<p>Once you have data loading into ElasticSearch, you may want to install
our basic dashboards.  These are installed at:
</p><div class="example">
<pre class="example"><samp>/usr/local/share/doc/cyberprobe/kibana-dashboards.json</samp>
</pre></div>



<hr>
<span id="Threat-indicators"></span><div class="header">
<p>
Previous: <a href="#Visualisation" accesskey="p" rel="prev">Visualisation</a>, Up: <a href="#Quick-start-tutorial" accesskey="u" rel="up">Quick start tutorial</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Threat-indicators-1"></span><h3 class="section">3.8 Threat indicators</h3>
<span id="index-IOC"></span>
<span id="index-Indicator-of-Compromise"></span>
<span id="index-Indicator"></span>
<span id="index-Threat-indicator"></span>
<span id="index-JSON-1"></span>

<p>Cyberprobe includes a subscriber which apply indicators to events.  When
an event matches an indicator, information about the indicator is tagged
into the event.
</p>
<p>Indicator support is present in the <code>cybermon-detector</code> subscriber
which reads indicators from a JSON file.
</p>
<span id="Indicator-files"></span><h3 class="heading">Indicator files</h3>

<p>The installation bundle includes a a file containing some
sample indicators, search for <samp>indicators.json</samp>, which may be installed
at <samp>/usr/local/share/doc/cyberprobe</samp>.
</p>
<span id="Deploying-theat-information-to-cybermon"></span><h3 class="heading">Deploying theat information to <code>cybermon</code></h3>

<p>To run using your existing processing pipeline, stop any running
<code>cybermon</code> and <code>cybermon-elasticsearch</code> processes.  Then run
<code>cybermon</code> to publish to a queue on RabbitMQ:
</p>
<div class="example">
<pre class="example">cybermon -p 10000 -c /usr/local/etc/cyberprobe/amqp-topic.lua
</pre></div>

<p>Next run <code>cyberprobe-detector</code> to apply indicator rules.  By default,
this will subscribe to &lsquo;<samp>cyberprobe</samp>&rsquo; and publish to &lsquo;<samp>ioc</samp>&rsquo;:
</p>
<div class="example">
<pre class="example">env INDICATORS=/path/to/indicators.json cybermon-detector \
    cyberprobe ioc
</pre></div>

<p>Finally, in order to look at the output, we need to subscribe to
&lsquo;<samp>ioc</samp>&rsquo;:
</p>
<div class="example">
<pre class="example">cybermon-dump ioc
</pre></div>

<p>If you have <code>jq</code> installed, this will make it easier to see
when indicators hit:
</p>
<div class="example">
<pre class="example">cybermon-dump ioc | jq --unbuffered .indicators
</pre></div>

<p>This activity should trigger a theat:
</p>
<div class="example">
<pre class="example">wget -q -O- http://www.malware.org/malware.dat
</pre></div>

<p>If this works, you should see the following output:
</p>
<div class="example">
<pre class="example">[
  {
    &quot;description&quot;: &quot;URL of a page serving malware&quot;,
    &quot;category&quot;: &quot;malware&quot;,
    &quot;author&quot;: &quot;someone@example.com&quot;,
    &quot;source&quot;: &quot;id:3245edd9-e0f3-4982-9406-fbf93b874555&quot;,
    &quot;type&quot;: &quot;url&quot;,
    &quot;value&quot;: &quot;http://malware.org/malware.dat&quot;
  }
]
</pre></div>

<p>This hits on a number of theat indicators. The hostname www.malware.com is
present in a theat indicator, and it is detected in the HTTP request, and
both the DNS query and response. Also, the URL
<code>http://www.malware.org/malware.dat</code> is in a threat indicator and it is
detected in both the HTTP request and response.
</p>
<p><code>cybermon-detector</code> updates its state if
the JSON configuration file has changed.
</p>
<p>If you want to load the output of <code>cybermon-detector</code> into
ElasticSearch, you can, but you need to subscribe to &lsquo;<samp>ioc</samp>&rsquo;:
</p>
<div class="example">
<pre class="example">cybermon-elasticsearch ioc
</pre></div>

<p>This results in indicator hit information being loaded into ES.
</p>
<p>For more information on indicators, see
<a href="#cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a> and
<a href="#Cyberprobe-indicator-format">Cyberprobe indicator format</a>.
</p>
<p>See <a href="https://github.com/cybermaggedon/threat-exchanges">https://github.com/cybermaggedon/threat-exchanges</a> for code which
creates indicator sets from threat exchanges.
</p>
<span id="Conclusion"></span><h3 class="heading">Conclusion</h3>

<p>All done, I hope you enjoyed the tutorial! Any comments on the software, or
tutorial itself are very welcome! Positive, or negative, we want to hear how
you found the experience.
</p>



<hr>
<span id="Running-cyberprobe_002fcybermon-at-boot-time"></span><div class="header">
<p>
Next: <a href="#The-pub_002fsub-infrastructure" accesskey="n" rel="next">The pub/sub infrastructure</a>, Previous: <a href="#Quick-start-tutorial" accesskey="p" rel="prev">Quick start tutorial</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Running-cyberprobe_002fcybermon-at-boot-time-1"></span><h2 class="chapter">4 Running cyberprobe/cybermon at boot time</h2>

<p>The <code>cyberprobe</code> and <code>cybermon</code> utilities are used as a pair
to analyse network data.  The <code>cyberprobe</code> component is used to
capture data and forward to <code>cybermon</code>.  When running on a network,
you can decide to run several <code>cyberprobe</code> deployments into a single
<code>cybermon</code>.  Or run a <code>cybermon</code> process everywhere you
run a <code>cyberprobe</code>.
</p>
<p>Once you have decided your checklist, your setup checklist for using
<code>cyberprobe</code> and <code>cybermon</code> consists of:
</p>
<ul>
<li> Install the software, see <a href="#Obtaining-the-software">Obtaining the software</a>.

</li><li> If you are going to run <code>cyberprobe</code>, provide the appropriate
configuration
in file
<samp>/usr/local/etc/cyberprobe.cfg</samp>.  The standard installation
will install a template at this location.
See <a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a> on managing this configuration
file.
Make sure that the configuration file includes the delivery address of the
appropriate <code>cybermon</code>.

</li><li> <span id="index-cybermon_002c-pub_002fsub"></span>
<span id="index-Pub_002fsub-delivery"></span>
If you are going to run <code>cybermon</code>, provide the
appropriate configuration in file
<div class="example">
<pre class="example"><samp>/usr/local/etc/cyberprobe/cybermon.lua</samp>.
</pre></div>
<p>The standard installation
does not create a file at this location, and you should create one.  You can
copy an example from the <samp>/usr/local/etc/cyberprobe</samp> directory.
Use <samp>/usr/local/etc/cyberprobe/amqp-topic.lua</samp> if you want to use
pub/sub delivery.  See <a href="#cybermon-configuration"><code>cybermon</code> configuration</a> for more
information on constructing the configuration file.
See <a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a> for descriptions of the
example configuration files.
</p>
</li><li> The installation installs appropriate <code>systemd</code> configuration, and
you can enable boot-time starting of <code>cyberprobe</code> or
<code>cybermon</code> by using either or both of these commands:
<div class="example">
<pre class="example">systemctl enable cyberprobe
systemctl enable cybermon
</pre></div>
<p>Once enabled, you can reboot, or immediately start the processes using either
or both of these commands:
</p><div class="example">
<pre class="example">systemctl start cyberprobe
systemctl start cybermon
</pre></div>

</li></ul>




<hr>
<span id="The-pub_002fsub-infrastructure"></span><div class="header">
<p>
Next: <a href="#A-containerised-processing-system" accesskey="n" rel="next">A containerised processing system</a>, Previous: <a href="#Running-cyberprobe_002fcybermon-at-boot-time" accesskey="p" rel="prev">Running cyberprobe/cybermon at boot time</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="The-pub_002fsub-infrastructure-1"></span><h2 class="chapter">5 The pub/sub infrastructure</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Pub_002fsub-overview" accesskey="1">Pub/sub overview</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-Cassandra-subscriber" accesskey="2">The Cassandra subscriber</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-ElasticSearch-subscriber" accesskey="3">The ElasticSearch subscriber</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-Gaffer-subscriber" accesskey="4">The Gaffer subscriber</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-Google-BigQuery-subscriber" accesskey="5">The Google BigQuery subscriber</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#The-debug-monitor-subscriber" accesskey="6">The debug monitor subscriber</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>


<hr>
<span id="Pub_002fsub-overview"></span><div class="header">
<p>
Next: <a href="#The-Cassandra-subscriber" accesskey="n" rel="next">The Cassandra subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Pub_002fsub-overview-1"></span><h3 class="section">5.1 Pub/sub overview</h3>

<span id="index-cybermon_002c-pub_002fsub-1"></span>
<span id="index-Pub_002fsub-delivery-1"></span>

<p>Events from <code>cybermon</code> can be delivered to a pub/sub mechanism which
allows subscribers to connect and disconnect without disrupting delivery
to other subscribers.  The pub/sub mechanism used is RabbitMQ, which is a
simple non-persistent, broker-less mechanism.
</p>
<p>In order to use this mechanism, you need to ensure you have configured
<code>cybermon</code> appropriately.  This is normally done by copying the
<samp>amqp-topic.lua</samp> to <samp>cybermon.lua</samp> in directory
<samp>/usr/local/etc/cyberprobe/</samp>.
prior to executing
<code>cybermon</code>.  Alternatively, <code>cybermon</code> can be manually
invoked, specifying the <samp>amqp-topic.lua</samp> pathname on the command line.
</p>
<p>Once running, <code>cybermon</code> will publish all events
to RabbitMQ.
</p>
<p>RabbitMQ allows subscribers to be started and stopped without affecting the
delivery of events to other receivers.  That is, you can start
<code>cybermon</code> with no subscribers, discarding data, and introduce
subscribers later.
</p>
<p>For more advanced processing scenarios, multiple pub/sub components can be
chained.  e.g.
</p>
<ul>
<li> <code>cybermon</code> can be executed with <samp>amqp-topic.lua</samp> to publish
events to RabbitMQ queue &lsquo;<samp>cyberprobe</samp>&rsquo;.

</li><li> <code>cybermon-geoip</code> can subscribe to &lsquo;<samp>cyberprobe</samp>&rsquo;, and push
events containing information to &lsquo;<samp>geo</samp>&rsquo;.

</li><li> <code>cybermon-detector</code> can lookup for IOCs and push events with IOC
detection information to &lsquo;<samp>ioc</samp>&rsquo;.

</li><li> <code>cybermon-elasticsearch</code> can subscribe to &lsquo;<samp>ioc</samp>&rsquo; and write events to
ElasticSearch.

</li></ul>


<hr>
<span id="The-Cassandra-subscriber"></span><div class="header">
<p>
Next: <a href="#The-ElasticSearch-subscriber" accesskey="n" rel="next">The ElasticSearch subscriber</a>, Previous: <a href="#Pub_002fsub-overview" accesskey="p" rel="prev">Pub/sub overview</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="The-Cassandra-subscriber-1"></span><h3 class="section">5.2 The Cassandra subscriber</h3>

<blockquote>
<p><b>Note:</b> The Cassandra subscriber doesn&rsquo;t do much useful.  I recommend skipping this
bit.
</p></blockquote>

<span id="index-cybermon_002dcassandra_002c-invocation"></span>
<span id="index-Cassandra"></span>
<span id="index-Apache-Cassandra"></span>
<span id="index-Graph-store"></span>

<p>This subscriber writes data to a Cassandra store in a schema useful for
graph analysis.
</p>
<p>The schema is experimental, but see
<a href="https://github.com/cybermaggedon/cassandra-redland">https://github.com/cybermaggedon/cassandra-redland</a> for the tooling
I&rsquo;m using.
</p>
<p>On the command-line you need to tell the subscriber the location
of the Cassandra contact points e.g.
</p>
<div class="example">
<pre class="example">cybermon-cassandra ioc cas1,cas2,cas3
</pre></div>

<p>See <a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a>.
</p>


<hr>
<span id="The-ElasticSearch-subscriber"></span><div class="header">
<p>
Next: <a href="#The-Gaffer-subscriber" accesskey="n" rel="next">The Gaffer subscriber</a>, Previous: <a href="#The-Cassandra-subscriber" accesskey="p" rel="prev">The Cassandra subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="The-ElasticSearch-subscriber-1"></span><h3 class="section">5.3 The ElasticSearch subscriber</h3>

<span id="index-cybermon_002delasticsearch_002c-invocation"></span>
<span id="index-ElasticSearch-1"></span>

<p>This suscriber extracts events from pub/sub and formats them for delivery
to ElasticSearch.  The only piece of information you need is the ElasticSearch
base URI, which is used as a command-line parameter e.g.
</p>
<div class="example">
<pre class="example">cybermon-elasticsearch ioc http://es-host1:9200
</pre></div>

<p>See <a href="#cybermon_002delasticsearch-invocation"><code>cybermon-elasticsearch</code> invocation</a>.
</p>

<hr>
<span id="The-Gaffer-subscriber"></span><div class="header">
<p>
Next: <a href="#The-Google-BigQuery-subscriber" accesskey="n" rel="next">The Google BigQuery subscriber</a>, Previous: <a href="#The-ElasticSearch-subscriber" accesskey="p" rel="prev">The ElasticSearch subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="The-Gaffer-subscriber-1"></span><h3 class="section">5.4 The Gaffer subscriber</h3>

<span id="index-cybermon_002dgaffer_002c-invocation"></span>
<span id="index-Gaffer"></span>
<span id="index-Graph-store-1"></span>

<span id="About-Gaffer"></span><h3 class="heading">About Gaffer</h3>

<p>Gaffer is a graph database built on top of Accumulo, Zookeeper
and Hadoop.  This subscriber writes IP, TCP and UDP communication information
into the
graph.  If you want to use this, get familiar with Gaffer.
Gaffer development is hosted on Github at
<a href="https://github.com/gchq/Gaffer">https://github.com/gchq/Gaffer</a>, and I maintain Gaffer containers here:
</p>
<dl compact="compact">
<dt><a href="https://hub.docker.com/r/cybermaggedon/wildfly-gaffer/">https://hub.docker.com/r/cybermaggedon/wildfly-gaffer/</a></dt>
<dd><p>Gaffer component, provides REST interface running in a Wildfly container.
</p>
</dd>
<dt><a href="https://hub.docker.com/r/cybermaggedon/accumulo-gaffer/">https://hub.docker.com/r/cybermaggedon/accumulo-gaffer/</a></dt>
<dd><p>Accumulo component, with added Gaffer operator library which is necessary
to be able to use Gaffer on Accumulo.
</p>
</dd>
<dt><a href="https://hub.docker.com/r/cybermaggedon/zookeeper/">https://hub.docker.com/r/cybermaggedon/zookeeper/</a></dt>
<dd><p>Zookeeper container, which is required by Accumulo.
</p>
</dd>
<dt><a href="https://hub.docker.com/r/cybermaggedon/hadooop/">https://hub.docker.com/r/cybermaggedon/hadooop/</a></dt>
<dd><p>Hadoop container, which is required by Accumulo.
</p>
</dd>
</dl>

<span id="Running-Gaffer"></span><h3 class="heading">Running Gaffer</h3>

<p>To get started, you can run a Gaffer system by launching with the minimal
set of containers:
</p>
<div class="example">
<pre class="example">

GAFFER_VERSION=1.1.2

# Run Hadoop
docker run -d --name hadoop cybermaggedon/hadoop:2.8.1

# Run Zookeeper
docker run -d --name zookeeper \
      cybermaggedon/zookeeper:3.4.10b

# Run Accumulo
docker run -d --name accumulo --link zookeeper:zookeeper \
      --link hadoop:hadoop \
      cybermaggedon/accumulo-gaffer:${GAFFER_VERSION}

# Run Wildfly, exposing port 8080.
docker run -d --name wildfly --link zookeeper:zookeeper \
  --link hadoop:hadoop --link accumulo:accumulo \
  -p 8080:8080 \
  cybermaggedon/wildfly-gaffer:${GAFFER_VERSION}

</pre></div>

<p>The Gaffer/Wildfly component takes about 30 seconds to bed in.  Once working,
you can check the status of Gaffer by interacting with the REST API.  This
command should return the Graph schema, which is a JSON object:
</p>
<div class="example">
<pre class="example">wget -q -O- http://localhost:8080/rest/v1/graph/schema
</pre></div>

<p>You can fetch the entire graph using this command.  Initially, the graph will
be empty.  This command may take a long while to run once the graph is loaded
with loads of data:
</p>
<div class="example">
<pre class="example">wget -q -O- --header 'Content-Type: application/json' \
  --post-data '
  {&quot;class&quot;: &quot;uk.gov.gchq.gaffer.operation.impl.get.GetAllElements&quot;}
  ' http://localhost:8080/rest/v2/graph/operations/execute
</pre></div>

<span id="Linking-to-cybermon"></span><h3 class="heading">Linking to <code>cybermon</code></h3>

<p>On the command-line you need to tell the subscriber the location
of the Gaffer REST API. e.g.
</p>
<div class="example">
<pre class="example">cybermon-gaffer ioc \
    http://localhost:8080/rest/v1
</pre></div>

<p>See <a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a>.
</p>

<hr>
<span id="The-Google-BigQuery-subscriber"></span><div class="header">
<p>
Next: <a href="#The-debug-monitor-subscriber" accesskey="n" rel="next">The debug monitor subscriber</a>, Previous: <a href="#The-Gaffer-subscriber" accesskey="p" rel="prev">The Gaffer subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="The-Google-BigQuery-subscriber-1"></span><h3 class="section">5.5 The Google BigQuery subscriber</h3>

<span id="index-cybermon_002dbigquery_002c-invocation"></span>
<span id="index-Google-BigQuery"></span>
<span id="index-Google-Cloud-Platform"></span>

<p>Google BigQuery is a cloud data storage mechanism which is part of the
Google Cloud Platform, available to Google Cloud subscribers.
</p>
<p>BigQuery is a &rsquo;big data&rsquo; relational style database, with a query language
familiar to SQL users.
</p>
<p>To use BigQuery, you need to get a private key file in private JSON format
from the cloud interface, and store this at
<samp>/usr/local/etc/cyberprobe/private.json</samp>.  One way to do this is
to go to the IAM interface and create a use with BigQuery access, and download
the private JSON file.
</p>
<p>You need to also to create the BigQuery dataset.  Call it &lsquo;<samp>cyberprobe</samp>&rsquo;.
The BigQuery table is created automatically when the subscriber is started.
</p>
<p>If the key is installed at the above location, you do not need to
provide any further parameters on the command line.  Just run:
</p>
<div class="example">
<pre class="example">cybermon-bigquery
</pre></div>

<p>See <a href="#cybermon_002dbigquery-invocation"><code>cybermon-bigquery</code> invocation</a>.
</p>

<hr>
<span id="The-debug-monitor-subscriber"></span><div class="header">
<p>
Previous: <a href="#The-Google-BigQuery-subscriber" accesskey="p" rel="prev">The Google BigQuery subscriber</a>, Up: <a href="#The-pub_002fsub-infrastructure" accesskey="u" rel="up">The pub/sub infrastructure</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="The-debug-monitor-subscriber-1"></span><h3 class="section">5.6 The debug monitor subscriber</h3>

<span id="index-cybermon_002dmonitor_002c-invocation"></span>

<p>The <code>cybermon-monitor</code> subscriber is a subscriber which takes
events and writes human-readable output on standard output.  This is a
useful means to verify that <code>cyberprobe</code>, <code>cybermon</code> and
pub/sub are configured correctly.
</p>
<p>See <a href="#cybermon_002dmonitor-invocation"><code>cybermon-monitor</code> invocation</a>.
</p>


<hr>
<span id="A-containerised-processing-system"></span><div class="header">
<p>
Next: <a href="#Integrating-with-AWS-Traffic-Mirroring" accesskey="n" rel="next">Integrating with AWS Traffic Mirroring</a>, Previous: <a href="#The-pub_002fsub-infrastructure" accesskey="p" rel="prev">The pub/sub infrastructure</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="A-containerised-processing-system-1"></span><h2 class="chapter">6 A containerised processing system</h2>

<span id="Cybermon_002c-Gaffer_002c-ElasticSearch"></span><h3 class="heading">Cybermon, Gaffer, ElasticSearch</h3>

<span id="index-Containers-1"></span>
<span id="index-Docker-1"></span>
<span id="index-Docker-compose"></span>
<span id="index-docker_002dcompose_002eyml"></span>
<span id="index-docker_002dcompose_002dcp_002dsnort_002eyml"></span>
<span id="index-ElasticSearch-2"></span>
<span id="index-Gaffer-1"></span>

<p>The <code>cybermon</code>, subscriber components and data stores can easily be
deployed in containers to form a scalable processing system.
</p>
<p>To illustrate this in use, we distrubute a Docker Compose configuration which
can be used to start:
</p>
<ul>
<li> A <code>cybermon</code>, listening on port 9000.

</li><li> A <code>cybermon-geoip</code> container, adding GeoIP information to events.

</li><li> A <code>cybermon-detector</code> container, adding IOC information to events
from a sample STIX data set.

</li><li> A <code>cybermon-elasticsearch</code> container, to load information into
ElasticSearch.

</li><li> A <code>cybermon-gaffer</code> container, to load information into Gaffer.

</li><li> An <code>elasticsearch</code> container to store events.

</li><li> A <code>kibana</code> container to store events.

</li><li> A Gaffer cluster consisting of Hadoop, Zookeeper, Accumulo and Gaffer
containers.

</li></ul>

<p>You can see the Docker Compose configuration at the path:
</p>
<div class="example">
<pre class="example"><samp>/usr/local/share/doc/cyberprobe/docker-compose.yml</samp>
</pre></div>

<p>In order to invoke this run:
</p>
<div class="example">
<pre class="example">cd <samp>/usr/local/share/doc/cyberprobe/</samp>
docker-compose up
</pre></div>

<p>No data is stored persistently - you can change how this works by
changing the <samp>docker-compose.yml</samp> file.
It takes about a minute to settle down, at which point, you need to generate
data using cyberprobe and send to port 9000.
</p>
<p>You can connect to the Kibana instance on port 5601.  The first thing you will
need to do is to go to the Management &gt; Index Patterns dialogue, and create
an index pattern for index &lsquo;<samp>cyberprobe</samp>&rsquo;, with time specified in the
&lsquo;<samp>time</samp>&rsquo; field.
</p>
<p>You may want to install our data dashboards, using Management &gt; Saved Objects
and press the Import button.  The dashboard file
is installed at:
</p><div class="example">
<pre class="example"><samp>/usr/local/share/doc/cyberprobe/kibana-dashboards.json</samp>
</pre></div>

<p>ElasticSearch bails out unless &lsquo;<samp>vm.max_map_count</samp>&rsquo; setting is right.
If you have problems, try:
</p><div class="example">
<pre class="example">sudo sysctl vm.max_map_count=512000
</pre></div>

<span id="Snort_002c-Cyberprobe_002c-Cybermon_002c-Gaffer_002c-ElasticSearch"></span><h3 class="heading">Snort, Cyberprobe, Cybermon, Gaffer, ElasticSearch</h3>

<p>There is a second configuration which adds Snort and Cyberprobe to the
deployment.  This accesses the host network interface by providing
host network access to the <code>cyberprobe</code> and <code>snort</code> containers.
The network interface name is specified in the <samp>cyberprobe.cfg</samp>
file for <code>cyberprobe</code> and the <samp>docker-compose-cp-snort.yml</samp>
file for <code>snort</code> so you will need to edit accordingly.
</p>
<div class="example">
<pre class="example">cd <samp>/usr/local/share/doc/cyberprobe/</samp>
docker-compose \
  -f <samp>/usr/local/share/doc/cyberprobe/docker-compose-cp-snort.yml</samp> up
</pre></div>

<p>The configuration results in trigger packet acquisition as soon as
any port 80 or port 11111 data is observed. e.g.
</p>
<div class="example">
<pre class="example">wget -q -O- http://www.example.org/
</pre></div>




<hr>
<span id="Integrating-with-AWS-Traffic-Mirroring"></span><div class="header">
<p>
Next: <a href="#Endace-DAG" accesskey="n" rel="next">Endace DAG</a>, Previous: <a href="#A-containerised-processing-system" accesskey="p" rel="prev">A containerised processing system</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Integrating-with-AWS-Traffic-Mirroring-1"></span><h2 class="chapter">7 Integrating with AWS Traffic Mirroring</h2>


<span id="index-AWS-Traffic-Mirroring"></span>
<span id="index-VXLAN"></span>

<span id="Overview-2"></span><h3 class="heading">Overview</h3>

<p>AWS allows you to mirror network traversing a network interface (ENI)
to another ENI, essentially providing the equivalent of an Ethernet tap
in a data centre.  Traffic Mirroring allows you to select network interfaces
or NLBs for traffic mirroring.  Filters can be applied to select the subset
of traffic which will be mirrored, and a target interface allows you to specify
an ENI or load-balancer to receive the data.  Data is delivered in VXLAN
format, essentially, Ethernet frames wrapped in an 8-byte header.  These frames
are delivered over UDP to port 4789.
</p>
<span id="Cyberprobe-implementation"></span><h3 class="heading">Cyberprobe implementation</h3>

<p>Cyberprobe provides two ways to integrate with AWS Traffic Mirroring:
</p>
<ul>
<li> <code>cyberprobe</code> implements VXLAN reception.  If an interface is defined
whose
name has a <code>vxlan:PORT</code> form, then a VXLAN receiver is started on the
specified UDP port number.  For AWS traffic mirroring, delivery is on port
4789, so the interface name <code>vxlan:4789</code> would be used.

</li><li> <code>cybermon</code> implements VXLAN reception with the <code>-V</code> option
allowing a port to be specified.  Events produced form a VXLAN feed have
the device ID set to the string &lsquo;<samp>VNI</samp>&rsquo; plus the VNI identifier in
decimal.

</li></ul>

<p>Using VXLAN support in <code>cyberprobe</code> provides more flexibility, as
this allows delay line and filter commands to be used.  Also, IP addresses
can be mapped to device IDs.
</p>
<p>Using VXLAN support in <code>cybermon</code> means that <code>cyberprobe</code>
does not need to be used, and provides for a simpler architecture.
</p>



<hr>
<span id="Endace-DAG"></span><div class="header">
<p>
Next: <a href="#Reference" accesskey="n" rel="next">Reference</a>, Previous: <a href="#Integrating-with-AWS-Traffic-Mirroring" accesskey="p" rel="prev">Integrating with AWS Traffic Mirroring</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Endace-DAG-1"></span><h2 class="chapter">8 Endace DAG</h2>

<span id="index-Endace"></span>
<span id="index-DAG"></span>

<p><code>cyberprobe</code> includes support for Endace DAG.  This is presently
not distributed.  If you compile <code>cyberprobe</code> on a host which has
the DAG library (<samp>libdag</samp>) installed, it will be detected at the
<code>configure</code> step.
</p>
<p>If DAG support is compiled in, then the DAG devices can be referenced
in the <samp>cyberprobe.cfg</samp> file using the prefix &lsquo;<samp>dag</samp>&rsquo; plus the
card number e.g.
</p>
<div class="example">
<pre class="example">    ...
    &quot;interfaces&quot;: [
        { &quot;interface&quot;: &quot;dag0&quot; }
    ]
    ...
</pre></div>

<p>To use DAG devices, you need to load DAG firmware, and set all
appropriate card options using <code>dagload</code> and <code>dagconfig</code>
prior to starting <code>cyberprobe</code>.
</p>


<hr>
<span id="Reference"></span><div class="header">
<p>
Next: <a href="#Architecture" accesskey="n" rel="next">Architecture</a>, Previous: <a href="#Endace-DAG" accesskey="p" rel="prev">Endace DAG</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Reference-1"></span><h2 class="chapter">9 Reference</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#cyberprobe-invocation" accesskey="1"><code>cyberprobe</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cyberprobe-configuration" accesskey="2"><code>cyberprobe</code> configuration</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cyberprobe_002dcli-invocation" accesskey="3"><code>cyberprobe-cli</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cyberprobe_002dcli-commands" accesskey="4"><code>cyberprobe-cli</code> commands</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#eventstream_002dservice-invocation" accesskey="5"><code>eventstream-service</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Output-streaming-protocols" accesskey="6">Output streaming protocols</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Management-protocol" accesskey="7">Management protocol</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon-invocation" accesskey="8"><code>cybermon</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon-configuration" accesskey="9"><code>cybermon</code> configuration</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dmonitor-invocation"><code>cybermon-monitor</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002delasticsearch-invocation"><code>cybermon-elasticsearch</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dbigquery-invocation"><code>cybermon-bigquery</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dgeoip-invocation"><code>cybermon-geoip</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Cyberprobe-indicator-format">Cyberprobe indicator format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002ddump-invocation"><code>cybermon-dump</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#cybermon_002dalert-invocation"><code>cybermon-alert</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#taxii_002dclient-invocation"><code>taxii-client</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#taxii_002dsync_002djson-invocation"><code>taxii-sync-json</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#taxii_002dserver-invocation"><code>taxii-server</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#nhis11_002drcvr-invocation"><code>nhis11-rcvr</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#etsi_002drcvr-invocation"><code>etsi-rcvr</code> invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#ElasticSearch-model">ElasticSearch model</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<span id="cyberprobe-invocation"></span><div class="header">
<p>
Next: <a href="#cyberprobe-configuration" accesskey="n" rel="next"><code>cyberprobe</code> configuration</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cyberprobe-invocation-1"></span><h3 class="section">9.1 <code>cyberprobe</code> invocation</h3>

<span id="index-cyberprobe_002c-invocation"></span>

<p><code>cyberprobe</code> is a network monitor which collects packets which match an
IP address list.  The packets collected are streamed using network streaming
protocols.  The IP address match list can be statically conqfigured (in a
configuration file), can be dynamically changed using a management
interface, or can be dynamically changed as a result of snort alerts.
Synopsis:
</p>
<div class="example">
<pre class="example">cyberprobe <var>configuration-file</var>
</pre></div>

<ul>
<li> <var>configuration-file</var> is the name of a JSON configuration file. 
See <a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a>.

</li></ul>

<span id="index-cyberprobe_002c-configuration"></span>

<p><code>cyberprobe</code> executes indefinitely - to end the program, a signal should
be sent. e.g.
</p>
<div class="example">
<pre class="example">killall cyberprobe
</pre></div>



<hr>
<span id="cyberprobe-configuration"></span><div class="header">
<p>
Next: <a href="#cyberprobe_002dcli-invocation" accesskey="n" rel="next"><code>cyberprobe-cli</code> invocation</a>, Previous: <a href="#cyberprobe-invocation" accesskey="p" rel="prev"><code>cyberprobe</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cyberprobe-configuration-1"></span><h3 class="section">9.2 <code>cyberprobe</code> configuration</h3>
<span id="index-cyberprobe_002c-configuration-1"></span>
<span id="index-cyberprobe_002c-control"></span>
<span id="index-cyberprobe_002c-interfaces"></span>
<span id="index-cyberprobe_002c-targets"></span>
<span id="index-cyberprobe_002c-endpoints"></span>
<span id="index-cyberprobe_002c-snort_005falert"></span>
<span id="index-control"></span>
<span id="index-interfaces"></span>
<span id="index-targets"></span>
<span id="index-endpoints"></span>
<span id="index-snort_005falert"></span>
<span id="index-IP-address-matching"></span>
<span id="index-IP-address-mask"></span>
<span id="index-targets_002c-address-mask"></span>

<p>The configuration file is re-read when it changes, and changes are
immediately actioned.
</p>
<p>Sample configuration:
</p>
<div class="example">
<pre class="example">{
    &quot;interfaces&quot;: [
        {
            &quot;interface&quot;: &quot;eth0&quot;,
            &quot;filter&quot;: &quot;not port 10001 and not port 10002&quot;,
            &quot;delay&quot;: 0.5
        },
        {
            &quot;interface&quot;: &quot;eth1&quot;
        }
    ],
    &quot;targets&quot;: [
        { &quot;address&quot;: &quot;192.168.1.1&quot;, &quot;device&quot;: &quot;sam-iphone&quot; },
        { &quot;address&quot;: &quot;192.168.1.2&quot;, &quot;device&quot;: &quot;fred-android&quot; },
        { &quot;address&quot;: &quot;10.2.0.0/16&quot;, &quot;device&quot;: &quot;lisa-mac&quot; },
        { &quot;address&quot;: &quot;10.1.1.0&quot;, &quot;device&quot;: &quot;suzie-mac&quot; },
        { &quot;address&quot;: &quot;10.1.1.2&quot;, &quot;device&quot;: &quot;suzie-android&quot; },
        { &quot;address&quot;: &quot;10.1.1.3&quot;, &quot;device&quot;: &quot;suzie-iphone&quot; },
        { &quot;address&quot;: &quot;10.1.1.4&quot;, &quot;device&quot;: &quot;imogen-pc&quot; },
        { &quot;address&quot;: &quot;10.1.1.5&quot;, &quot;device&quot;: &quot;imogen-pc&quot; },
        { &quot;address&quot;: &quot;10.1.1.6&quot;, &quot;device&quot;: &quot;imogen-pc&quot; },
        { &quot;address&quot;: &quot;10.1.1.7&quot;, &quot;device&quot;: &quot;imogen-ipad&quot; },
        { &quot;address&quot;: &quot;10.1.1.8&quot;, &quot;device&quot;: &quot;imogen-android&quot; },
        { &quot;address&quot;: &quot;10.1.1.9&quot;, &quot;device&quot;: &quot;imogen-android&quot; },
        { &quot;address&quot;: &quot;10.1.1.10&quot;, &quot;device&quot;: &quot;will-tablet&quot; },
        { &quot;address&quot;: &quot;aaaa:bbbb:cccc:dddd::4:5:6&quot;, &quot;class&quot;: &quot;ipv6&quot;,
          &quot;device&quot;: &quot;sam-pc&quot; },
        { &quot;address&quot;: &quot;aaaa:bbbb:cccc::/48&quot;, class: &quot;ipv6&quot;,
          &quot;device&quot;: &quot;sam-pc&quot; }
    ],

    &quot;endpoints&quot;: [
        {
            &quot;hostname&quot;: &quot;monitor1&quot;,
            &quot;port&quot;: 10001,
            &quot;type&quot;: &quot;nhis1.1&quot;
        },
        {
            &quot;hostname&quot;: &quot;monitor2&quot;,
            &quot;port&quot;: 10002,
            &quot;type&quot;: &quot;etsi&quot;
        }
    ],
    &quot;parameters&quot;: {
        &quot;country&quot;: &quot;DE&quot;,
        &quot;operator&quot;: &quot;Cyber&quot;,
        &quot;network_element&quot;: &quot;10.8.2.4&quot;,
        &quot;interception_point&quot;: &quot;abcd1234&quot;,
        &quot;username.123456&quot;: &quot;user01@example.org&quot;,
        &quot;username.123981&quot;: &quot;user02@example.org&quot;,
        &quot;username.981235&quot;: &quot;user03@example.org&quot;,
        &quot;snort.1.liid&quot;: &quot;SNORT1&quot;,
        &quot;snort.2.liid&quot;: &quot;SNORT2&quot;
    },
    &quot;snort-alerters&quot;: [
        {
            &quot;duration&quot;: 30,
            &quot;path&quot;: &quot;/tmp/alert&quot;
        }
    ]
}
</pre></div>

<p>The <code>control</code> element is optional, if it exists, <code>cyberprobe</code> runs
a management interface on the specified port. The <code>port</code>,
<code>username</code> and <code>password</code> attributes must be specified. See
<a href="#Management-interface">Management interface</a> for how to communicate with that interface.
</p>
<span id="index-VXLAN-1"></span>
<span id="index-AWS-Traffic-Mirroring-1"></span>
<p>The <code>interfaces</code> block defines a set of interfaces to sniff. The
<code>name</code> attribute is mandatory, the <code>filter</code> element is optional,
and if specified should describe a BPF (Berkley Packet Filter)
expression. The <code>delay</code> element can be used to specify, in seconds, the
duration to wait before packets are processed. The delay is specified as a
floating point decimal.  If the interface name is of the form
<code>vxlan:PORT</code> then a VXLAN receiver is run in the specified port
number for reception of e.g. AWS Traffic Mirroring.
</p>
<p>The <code>targets</code> block defines IP address to match. The
<code>address</code> attribute defines the IP address with optional mask used for
the address match. If a mask is specified, this describes the subset of the
address which will be used for matching.  For instance, if
<code>192.168.0.0/16</code> is specified, then a 16-bit mask will be applied, which
makes this a class-B address match.  That is, any address in the
<code>192.168.0.0</code>-<code>192.168.255.255</code> range will match.
If no mask is specified, then this is an exact match against a single address.
The <code>device</code> attribute defines the deivce ID which will be applied
if this
particular IP address is detected.
</p>
<span id="index-network-attribute_002c-cyberprobe_002ecfg"></span>
<p>The optional <code>network</code> attribute
defines the network (ETSI NetworkElementID), which, if specified,
will be transmitted in the ETSI stream, and delivered as the JSON
&lsquo;<samp>network</samp>&rsquo; element in <code>cybermon</code> output.
The address must be an IP address, and
not a hostname. The address can be an IPv6 address if the <code>class</code>
attribute is included, and set to <code>ipv6</code>.
</p>
<p>Device IDs can occur in multiple places in the target block, allowing
multiple IP
addresses to match to the same device ID, but the same IP address/mask specifier
should only occur once in the target block.
</p>
<p>If subnetwork ranges overlap, the longest prefix match applies.
</p>
<p>The <code>device</code> and <code>network</code> can contain template constructs:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>%i</samp>&rsquo;</dt>
<dd><p>This is replaced with the IP address which causes a match.
</p>
</dd>
<dt>&lsquo;<samp>%s</samp>&rsquo;</dt>
<dd><p>This is replaced with the IP address in the target rule - useful if this
is a subnetwork address.
</p>
</dd>
<dt>&lsquo;<samp>%m</samp>&rsquo;</dt>
<dd><p>This is replaced with the source MAC address in the header of the packet
which causes a match.
</p>
</dd>
<dt>&lsquo;<samp>%v</samp>&rsquo;</dt>
<dd><p>This is replaced with the VLAN ID in the header of the packet which causes
a match.
</p>
</dd>
<dt>&lsquo;<samp>%%</samp>&rsquo;</dt>
<dd><p>This is replaced with a literal <code>%</code>.
</p>
</dd>
</dl>

<span id="index-certificate_002c-cyberprobe-configuration-option"></span>
<span id="index-key_002c-cyberprobe-configuration-option"></span>
<span id="index-trusted_002dca_002c-cyberprobe-configuration-option"></span>
<span id="index-TLS"></span>
<span id="index-SSL"></span>
<span id="index-cyberprobe-secure-delivery"></span>
<p>The <code>endpoints</code> block defines a set of addresses for delivery. The
<code>hostname</code> and <code>port</code> attributes should be used to describe the
endpoint address. Type <code>type</code> attribute should be <code>nhis1.1</code> or
<code>etsi</code> to specify which output stream format to use.  The <code>transport</code>
describe the transport type, which should be <code>tcp</code> for standard TCP stream,
or <code>tls</code> for an SSL/TLS stream.  If TLS is invoked, the attributes
<code>certificate</code>, <code>key</code> and <code>trusted-ca</code> should be specified,
with filenames for client certificate, private key, and a trust CA chain.
These should all be in PEM format.
</p>
<p>The optional <code>parameters</code> block defines a set of parameters which are
only used in ETSI delivery. Each parameter element should have a <code>key</code>
and a <code>value</code> attribute. The parameter values for <code>country</code>,
<code>operator</code>, <code>network_element</code> and <code>interception_point</code>
describe values which are used in the <code>PSHeader</code> and <code>IRI</code>
constructs. The parameters with prefix <code>username.</code> describe values for
the <code>username</code> values in the IPIRI construct in ETSI LI. The <code>key</code>
value is the literal <code>username.</code> suffixed with the device ID. If such an
entry is present, it is used for the <code>username</code>. All parameters are
optional, meaningless defaults (e.g. unknown) will be used if not specified.
The <code>etsi-streams</code> parameter specifies the number of TCP streams which
will be opened for delivery, the default being 12.  This feature potentially
increases throughput, and is useful if the destination is a load-balanced
resource.
</p>



<hr>
<span id="cyberprobe_002dcli-invocation"></span><div class="header">
<p>
Next: <a href="#cyberprobe_002dcli-commands" accesskey="n" rel="next"><code>cyberprobe-cli</code> commands</a>, Previous: <a href="#cyberprobe-configuration" accesskey="p" rel="prev"><code>cyberprobe</code> configuration</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cyberprobe_002dcli-invocation-1"></span><h3 class="section">9.3 <code>cyberprobe-cli</code> invocation</h3>

<span id="cyberprobe_002dcli"></span><span id="index-cyberprobe_002dcli_002c-invocation"></span>
<span id="index-Management-client"></span>

<p><code>cyberprobe-cli</code> connects to <code>cyberprobe</code> on the
management port to allow dynamic administration.  This permits
dynamic management of resources.
</p>
<blockquote>
<p><b>Note:</b> You can end up in a confusing situation if you use both the configuration
file, and the management interface to configure resources.  It is best to
use one or the other.  You can safely use the configuration file
for resources that you don&rsquo;t intend to change through the management interface,
but you shouldn&rsquo;t use both the configuration file and management interface
to change the same resources.
</p></blockquote>

<p>Synopsis:
</p>
<div class="example">
<pre class="example">cyberprobe-cli HOST PORT
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cyberprobe-cli vpn-host031 8888
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>HOST</samp>&rsquo;</dt>
<dd><p>Specifies the hostname or  IP address of the host to connect to.
</p>
</dd>
<dt>&lsquo;<samp>PORT</samp>&rsquo;</dt>
<dd><p>Specifies the management port number.
</p>
</dd>
</dl>

<p>Upon connection, you are prompted to enter a username and password.  Upon
successful authentication, you are then offered a command line prompt for
administration commands.
</p>


<hr>
<span id="cyberprobe_002dcli-commands"></span><div class="header">
<p>
Next: <a href="#eventstream_002dservice-invocation" accesskey="n" rel="next"><code>eventstream-service</code> invocation</a>, Previous: <a href="#cyberprobe_002dcli-invocation" accesskey="p" rel="prev"><code>cyberprobe-cli</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cyberprobe_002dcli-commands-1"></span><h3 class="section">9.4 <code>cyberprobe-cli</code> commands</h3>

<span id="index-cyberprobe_002dcli_002c-commands"></span>
<span id="index-Management-client-1"></span>

<p>The following commands are supported by <code>cyberprobe-cli</code>:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>add endpoint HOST PORT TYPE [TRANSPORT [KEY CERT CA]]</samp>&rsquo;</dt>
<dd><p>Adds a delivery endpoint.
</p><dl compact="compact">
<dt>&lsquo;<samp>HOST</samp>&rsquo;</dt>
<dd><p>Specifies the delivery host.
</p></dd>
<dt>&lsquo;<samp>PORT</samp>&rsquo;</dt>
<dd><p>Specifies TCP port to deliver to.
</p></dd>
<dt>&lsquo;<samp>TYPE</samp>&rsquo;</dt>
<dd><p>Can be one of &lsquo;<samp>nhis</samp>&rsquo; or &lsquo;<samp>etsi</samp>&rsquo; for delivery protocol.
</p></dd>
<dt>&lsquo;<samp>TRANSPORT</samp>&rsquo;</dt>
<dd><p>Can be one of &lsquo;<samp>tcp</samp>&rsquo; or &lsquo;<samp>tls</samp>&rsquo; for TCP or TLS transports.
Defaults to &lsquo;<samp>tcp</samp>&rsquo;.
</p></dd>
<dt>&lsquo;<samp>KEY</samp>&rsquo;</dt>
<dd><p>Filename of a key file in PEM format if &lsquo;<samp>tls</samp>&rsquo; is specified.
</p></dd>
<dt>&lsquo;<samp>CERT</samp>&rsquo;</dt>
<dd><p>Filename of an X.509 file in PEM format if &lsquo;<samp>tls</samp>&rsquo; is specified.
</p></dd>
<dt>&lsquo;<samp>TRANSPORT</samp>&rsquo;</dt>
<dd><p>Filename of trusted CA certs in PEM format if &lsquo;<samp>tls</samp>&rsquo; is specified.
</p></dd>
</dl>

<p>Note: It is not possible to specify the appropriate transport paramters for
TLS delivery using the management interface currently.
</p>
</dd>
<dt>&lsquo;<samp>add interface INTERFACE [DELAY [FILTER]]</samp>&rsquo;</dt>
<dd><p>Adds an interface for packet sniffing.
</p><dl compact="compact">
<dt>&lsquo;<samp>INTERFACE</samp>&rsquo;</dt>
<dd><p>Interface name.
</p></dd>
<dt>&lsquo;<samp>DELAY</samp>&rsquo;</dt>
<dd><p>Delay between packet acquisiton and delivery.  Defaults to zero.
</p></dd>
<dt>&lsquo;<samp>FILTER</samp>&rsquo;</dt>
<dd><p>Optional, species a filter to be applied for positive selection of packets,
in BPF / libpcap format.
</p></dd>
</dl>

</dd>
<dt>&lsquo;<samp>add parameter KEY VALUE</samp>&rsquo;</dt>
<dd><p>Adds a parameter.
</p><dl compact="compact">
<dt>&lsquo;<samp>KEY</samp>&rsquo;</dt>
<dd><p>Parameter key.
</p></dd>
<dt>&lsquo;<samp>VALUE</samp>&rsquo;</dt>
<dd><p>Parameter value.
</p></dd>
</dl>

</dd>
<dt>&lsquo;<samp>add target DEVICE PROTOCOL ADDRESS</samp>&rsquo;</dt>
<dd><p>Adds an address target for packet capture.
</p><dl compact="compact">
<dt>&lsquo;<samp>DEVICE</samp>&rsquo;</dt>
<dd><p>Device identifier.
</p></dd>
<dt>&lsquo;<samp>PROTOCOL</samp>&rsquo;</dt>
<dd><p>Address protocol, one of &lsquo;<samp>ipv4</samp>&rsquo; or &lsquo;<samp>ipv6</samp>&rsquo;.
</p></dd>
<dt>&lsquo;<samp>ADDRESS</samp>&rsquo;</dt>
<dd><p>Address value, in IPv4 or IPv6 format, according to the PROTOCOL value.
Optionally can have a &lsquo;<samp>/mask</samp>&rsquo; suffic.
</p></dd>
</dl>

</dd>
<dt>&lsquo;<samp>quit</samp>&rsquo;</dt>
<dd><p>Causes the client to close the connection and terminate.
</p>
</dd>
<dt>&lsquo;<samp>remove endpoint HOST PORT TYPE [TRANSPORT [KEY CERT CHAIN]]</samp>&rsquo;</dt>
<dd><p>Removes an endpoint added through the &lsquo;<samp>add endpoint</samp>&rsquo; command.
The HOST, PORT TYPE and TRANSPORT, ... values are the same as for
&lsquo;<samp>add endpoint</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>remove interface INTERFACE [DELAY [FILTER]]</samp>&rsquo;</dt>
<dd><p>Removes an interface added through the &lsquo;<samp>add interface</samp>&rsquo; command.
The INTERFACE, DELAY and FILTER values are the same as for &lsquo;<samp>add interface</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>remove paramter KEY VALUE</samp>&rsquo;</dt>
<dd><p>Removes a paramter added through the &lsquo;<samp>add parameter</samp>&rsquo; command.
The KEY and VALUE values are the same as for &lsquo;<samp>remove parameter</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>remove target DEVICE PROTOCOL ADDRESS</samp>&rsquo;</dt>
<dd><p>Removes a target added through the &lsquo;<samp>remove target</samp>&rsquo; command.
The PROTOCOL and ADDRESS values are the same as for &lsquo;<samp>add target</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>show endpoints</samp>&rsquo;</dt>
<dd><p>Displays a table showing endpoints.
</p>
</dd>
<dt>&lsquo;<samp>show interfaces</samp>&rsquo;</dt>
<dd><p>Displays a table showing interfaces.
</p>
</dd>
<dt>&lsquo;<samp>show parameters</samp>&rsquo;</dt>
<dd><p>Displays a table showing parameters.
</p>
</dd>
<dt>&lsquo;<samp>show targets</samp>&rsquo;</dt>
<dd><p>Displays a table showing targets.
</p>
</dd>
</dl>



<hr>
<span id="eventstream_002dservice-invocation"></span><div class="header">
<p>
Next: <a href="#Output-streaming-protocols" accesskey="n" rel="next">Output streaming protocols</a>, Previous: <a href="#cyberprobe_002dcli-commands" accesskey="p" rel="prev"><code>cyberprobe-cli</code> commands</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="eventstream_002dservice-invocation-1"></span><h3 class="section">9.5 <code>eventstream-service</code> invocation</h3>

<span id="eventstream_002dservice"></span><span id="index-eventstream_002dservice_002c-invocation"></span>
<span id="index-gRPC"></span>
<span id="index-Protobuf"></span>

<p><code>eventstream-service</code> is a demonstrator gRPC service for
cyberprobe gRPC.  It isn&rsquo;t particularly useful for anything other than
demo/debugging/diagnosing gRPC problems.
</p>
<p>It receives gRPC requests containing event data, and outputs these in
a JSON form, one event per line.  This is a default mapping for
Protobuf data determined by the Protobuf libraries, and is not
identical to Cyberprobe JSON format.
</p>
<p>The <samp>eventstream-service.C</samp> code may be useful in building your own
gRPC service.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">eventstream-service [HOST:PORT]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">eventstream-service 0.0.0.0:9100
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>HOST</samp>&rsquo;</dt>
<dd><p>Specifies the hostname or  IP address to bind this service to, to receive
requests.  0.0.0.0 means any address.
</p>
</dd>
<dt>&lsquo;<samp>PORT</samp>&rsquo;</dt>
<dd><p>Specifies the port number to listen on.
</p>
</dd>
</dl>




<hr>
<span id="Output-streaming-protocols"></span><div class="header">
<p>
Next: <a href="#Management-protocol" accesskey="n" rel="next">Management protocol</a>, Previous: <a href="#eventstream_002dservice-invocation" accesskey="p" rel="prev"><code>eventstream-service</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Output-streaming-protocols-1"></span><h3 class="section">9.6 Output streaming protocols</h3>

<span id="index-NHIS-1_002e1-LI"></span>
<span id="index-ETSI-LI"></span>
<span id="index-NHIS-1_002e1"></span>
<span id="index-ETSI"></span>
<span id="index-ETSI-TS-102-232_002d1"></span>
<span id="index-TS-102-232_002d1"></span>
<span id="index-LIID"></span>
<span id="index-Device-ID"></span>

<p><code>cyberprobe</code> supports packet output in one of two output formats,
which are both LI formats. LI formats were chosen as they set good, open
standards for streaming packets to a destination. There are also existing
security products such as firewalls, and analysis tools which understand
with these protocols. The two formats are ETSI LI and NHIS 1.1.
</p>
<span id="index-TS-102-232_002d3"></span>
<span id="index-ETSI-TS-102-232_002d3"></span>
<span id="ETSI-LI"></span><span id="ETSI-LI-1"></span><h3 class="heading">ETSI LI</h3>

<p>The first of the formats supported is the ETSI LI format (see ETSI TS 102
232), which is used in Europe and internationally. The protocol is described
using an ASN.1 specification which can be downloaded from the ETSI
web-site. Google can find the standards. The over-arching TS 102 232-1
standard describes the transport, while the TS 102 232-3 standard describes
putting the IP packets in the transport.
</p>
<p>Those adverse to the use of ASN.1 technology may prefer the second format.
</p>
<span id="index-TS-101-671"></span>
<span id="index-ETSI-TS-101-671"></span>
<span id="index-GLIC"></span>
<span id="NHIS-LI"></span><span id="NHIS-LI-1"></span><h3 class="heading">NHIS LI</h3>

<p>NHIS 1.1 which was defined for use in the UK in the 90s, based on GLIC
in ETSI TS 101 671. The protocol is a much simpler header protocol than ETSI
LI, and needs less work to decode.
</p>
<p>The standard was available on the internet on the <a href="http://gliif.org">http://gliif.org</a>
website, but that web-site has recently gone offline.
</p>
<p>The bluffers guide to decoding goes...
</p>
<ul>
<li> The first 32 bytes after TCP connection are a header. Ignore the first 4
bytes, the latter 28 bytes are the LIID / device ID, represented as an ASCII
string. Unused bytes following the LIID / device ID are set to zero to pad out
to 32 bytes.

</li><li> Once the start header is sent, the following data consists of IP packets
pre-fixed by a 20 byte header. The only information of note in each 20 byte
header is a 2-byte length field at offset 2 (network byte order). This tells
you the length of the IP packet.

</li><li> The IP packets are transmitted until the TCP connection closes.  A separate
TCP connection is used for each LIID / device ID.

</li></ul>

<span id="Output-semantics"></span><h3 class="heading">Output semantics</h3>

<p><code>cyberprobe</code> automatically reconnects to failed destinations, but
the buffering strategy is very simple. When destinations fail, the packets
are buffered in a small queue, but there is limited buffering, so once the
queue fills, packets will start to be dropped. The locking strategy is
simple, so loss of a single endpoint will currently result in data loss to
all endpoints. This may be a problem for operational scenarios where high
data availability is required.
</p>
<p><code>cyberprobe</code> includes some code to decode the ETSI and NHIS streams,
and also includes two test utilities, <code>etsi-rcvr</code> and
<code>nhis11-rcvr</code> which listen on a specified port number, decode the
stream data, and forward in PCAP format on standard output. Example usage
would be:
</p>
<div class="example">
<pre class="example">etsi-rcvr 10001 | tcpdump -n -r-
nhis11-rcvr 10000 | tcpdump -n -r-
</pre></div>



<hr>
<span id="Management-protocol"></span><div class="header">
<p>
Next: <a href="#cybermon-invocation" accesskey="n" rel="next"><code>cybermon</code> invocation</a>, Previous: <a href="#Output-streaming-protocols" accesskey="p" rel="prev">Output streaming protocols</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Management-protocol-1"></span><h3 class="section">9.7 Management protocol</h3>
<span id="index-Management-protocol"></span>

<span id="Overview-3"></span><h3 class="heading">Overview</h3>

<p>The management interface is a simple interface which supports studying and
dynamically changing the cyberprobe configuration: endpoints, targets and
interfaces.
</p>
<p>The configuration file specifies a port number, and username and password
for the interface.
</p>
<p>The interface is intended to be used programmatically.  It is a request/response
interface.
</p>
<p>Note that the protocol is in clear, so should not be used across a hostile
network.
</p>
<span id="Request-structure"></span><h3 class="heading">Request structure</h3>

<p>Each request is a JSON object encoded on a single line terminated with
&lsquo;<samp>NEWLINE</samp>&rsquo;.  Each request is required to have an <code>action</code> field
which describes the action to take.  One action is special: <code>auth</code>;
other actions cannot be used until authentication has taken place.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{&quot;action&quot;:&quot;auth&quot;,&quot;password&quot;:&quot;admin&quot;,&quot;username&quot;:&quot;horse-battery-staple&quot;}
</pre></div>

<span id="Response-structure"></span><h3 class="heading">Response structure</h3>

<p>Each response is preceded by a base-10 encoded human-readable byte length
terminated by &lsquo;<samp>NEWLINE</samp>&rsquo; after which the response is sent.  Response
is a JSON payload.  The <code>status</code> field contains a numeric response
code, statuses in the range 200-299 indicate success.
The <code>message</code> field contains a human-readable response string,
which will be an error message in the error case.
</p>
<p>Other fields depend on the request.
</p>
<span id="Actions-1"></span><h3 class="heading">Actions</h3>

<p>Here is the list of supported actions.  JSON has been pretty-printed to
aid understanding.
</p>

<p>The
following values of the <code>action</code> field are supported:
</p>
<dl compact="compact">
<dt><code>auth</code></dt>
<dd><p>Must be accompanied by valid <code>username</code> and <code>password</code> fields in
order to authenticate.  The response contains <code>status</code> and
<code>message</code> fields.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;:&quot;auth&quot;,
  &quot;password&quot;:&quot;admin&quot;,
  &quot;username&quot;:&quot;horse-battery-staple&quot;
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{&quot;message&quot;:&quot;Authenticated.&quot;,&quot;status&quot;:200}
</pre></div>

</dd>
<dt><code>add-interface</code></dt>
<dd><p>Starts packet capture from an interface.
Request should have an interface field containing an interface
specification.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;add-interface&quot;,
  &quot;interface&quot;: {
    &quot;delay&quot;: 0.5,
    &quot;filter&quot;: &quot;not port 9876&quot;,
    &quot;interface&quot;: &quot;vxlan:9876&quot;
  }
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{&quot;message&quot;:&quot;Interface added.&quot;,&quot;status&quot;:200}
</pre></div>

</dd>
<dt><code>remove-interface</code></dt>
<dd><p>Removes a previously enabled packet capture.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;remove-interface&quot;,
  &quot;interface&quot;: {
    &quot;delay&quot;: 0.5,
    &quot;filter&quot;: &quot;not port 9876&quot;,
    &quot;interface&quot;: &quot;vxlan:9876&quot;
  }
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{&quot;message&quot;:&quot;Interface removed.&quot;,&quot;status&quot;:200}
</pre></div>

</dd>
<dt><code>get-interfaces</code></dt>
<dd><p>Lists all interfaces, output is format <code>iface:delay:filter</code>.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;get-interfaces&quot;
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{
  &quot;interfaces&quot;: [
    {
      &quot;delay&quot;: 0.5,
      &quot;filter&quot;: &quot;not port 10001 and not port 10002&quot;,
      &quot;interface&quot;: &quot;vxlan:4789&quot;
    },
    {
      &quot;delay&quot;: 0.3
      &quot;filter&quot;: &quot;&quot;,
      &quot;interface&quot;: &quot;vxlan:4790&quot;
    },
    {
      &quot;delay&quot;: 0.5,
      &quot;filter&quot;: &quot;not port 9876&quot;,
      &quot;interface&quot;: &quot;vxlan:9876&quot;
    }
  ],
  &quot;message&quot;: &quot;Interfaces list.&quot;,
  &quot;status&quot;: 201
}
</pre></div>

</dd>
<dt><code>add-endpoint</code></dt>
<dd><p>Adds an endpoint to delivery data to.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;add-endpoint&quot;,
  &quot;endpoint&quot;: {
    &quot;certificate&quot;: &quot;cert.crt&quot;,
    &quot;hostname&quot;: &quot;receiver&quot;,
    &quot;key&quot;: &quot;key.pem&quot;,
    &quot;port&quot;: 10000,
    &quot;transport&quot;: &quot;tls&quot;,
    &quot;trusted-ca&quot;: &quot;ca.crt&quot;,
    &quot;type&quot;: &quot;etsi&quot;
  }
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{&quot;message&quot;:&quot;Endpoint added.&quot;,&quot;status&quot;:200}
</pre></div>

</dd>
<dt><code>remove-endpoint</code></dt>
<dd><p>Removes a previously enabled endpoint.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;remove-endpoint&quot;,
  &quot;endpoint&quot;: {
    &quot;certificate&quot;: &quot;cert.crt&quot;,
    &quot;hostname&quot;: &quot;receiver&quot;,
    &quot;key&quot;: &quot;key.pem&quot;,
    &quot;port&quot;: 10000,
    &quot;transport&quot;: &quot;tls&quot;,
    &quot;trusted-ca&quot;: &quot;ca.crt&quot;,
    &quot;type&quot;: &quot;etsi&quot;
  }
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{&quot;message&quot;:&quot;Endpoint removed.&quot;,&quot;status&quot;:200}
</pre></div>

</dd>
<dt><code>get-endpoints</code></dt>
<dd><p>Gets the endpoint list.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{&quot;action&quot;:&quot;get-endpoints&quot;}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{
  &quot;endpoints&quot;: [
    {
      &quot;hostname&quot;: &quot;localhost&quot;,
      &quot;port&quot;: 9000,
      &quot;transport&quot;: &quot;tcp&quot;,
      &quot;type&quot;: &quot;etsi&quot;
    },
    {
      &quot;hostname&quot;: &quot;localhost&quot;,
      &quot;port&quot;: 9002,
      &quot;transport&quot;: &quot;tcp&quot;,
      &quot;type&quot;: &quot;nhis1.1&quot;
    },
    {
      &quot;certificate&quot;: &quot;cert.crt&quot;,
      &quot;hostname&quot;: &quot;receiver&quot;,
      &quot;key&quot;: &quot;key.pem&quot;,
      &quot;port&quot;: 10000,
      &quot;transport&quot;: &quot;tls&quot;,
      &quot;trusted-ca&quot;: &quot;ca.crt&quot;,
      &quot;type&quot;: &quot;etsi&quot;
    }
  ],
  &quot;message&quot;: &quot;Endpoints list.&quot;,
  &quot;status&quot;: 201
}
</pre></div>

</dd>
<dt><code>add-target</code></dt>
<dd><p>Adds a new targeted IP address.
</p>
<p>Example requests:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;add-target&quot;,
  &quot;target&quot;: {
    &quot;address&quot;: &quot;1.2.3.0/24&quot;,
    &quot;class&quot;: &quot;ipv4&quot;,
    &quot;device&quot;: &quot;my-machine4&quot;,
    &quot;network&quot;: &quot;my-network&quot;
  }
}
</pre></div>

<div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;add-target&quot;,
  &quot;target&quot;: {
    &quot;address&quot;: &quot;fe80:e015:e897::/24&quot;,
    &quot;class&quot;: &quot;ipv6&quot;,
    &quot;device&quot;: &quot;my-machine4&quot;,
    &quot;network&quot;: &quot;&quot;
  }
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{&quot;message&quot;:&quot;Target added.&quot;,&quot;status&quot;:200}
</pre></div>

</dd>
<dt><code>remove-target</code></dt>
<dd><p>Removes a previously targeted IP address.
</p>
<p>Example requests:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;remove-target&quot;,
  &quot;target&quot;: {
    &quot;address&quot;: &quot;1.2.3.0/24&quot;,
    &quot;class&quot;: &quot;ipv4&quot;,
    &quot;device&quot;: &quot;my-machine4&quot;,
    &quot;network&quot;: &quot;my-network&quot;
  }
}
</pre></div>

<div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;remove-target&quot;,
  &quot;target&quot;: {
    &quot;address&quot;: &quot;fe80:e015:e897::/24&quot;,
    &quot;class&quot;: &quot;ipv6&quot;,
    &quot;device&quot;: &quot;my-machine4&quot;,
    &quot;network&quot;: &quot;&quot;
  }
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{&quot;message&quot;:&quot;Target removed.&quot;,&quot;status&quot;:200}
</pre></div>


</dd>
<dt><code>get-targets</code></dt>
<dd><p>Lists targets
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{&quot;action&quot;:&quot;get-targets&quot;}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{
  &quot;message&quot;: &quot;Target list.&quot;,
  &quot;status&quot;: 201,
  &quot;targets&quot;: [
    {
      &quot;address&quot;: &quot;10.0.0.0/8&quot;,
      &quot;class&quot;: &quot;ipv4&quot;,
      &quot;device&quot;: &quot;my-machine2&quot;,
      &quot;network&quot;: &quot;&quot;
    },
    {
      &quot;address&quot;: &quot;1.2.3.0/24&quot;,
      &quot;class&quot;: &quot;ipv4&quot;,
      &quot;device&quot;: &quot;my-machine4&quot;,
      &quot;network&quot;: &quot;my-network&quot;
    },
    {
      &quot;address&quot;: &quot;fe80:4124:5696::/48&quot;,
      &quot;class&quot;: &quot;ipv6&quot;,
      &quot;device&quot;: &quot;my-machine3&quot;,
      &quot;network&quot;: &quot;&quot;
    }
  ]
}
</pre></div>

</dd>
<dt><code>add-parameter</code></dt>
<dd><p>Adds a new parameter, or changes a parameter value.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;add-parameter&quot;,
  &quot;parameter&quot;: {
    &quot;key&quot;: &quot;key&quot;,
    &quot;value&quot;: &quot;value&quot;
  }
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{&quot;message&quot;:&quot;Parameter added.&quot;,&quot;status&quot;:200}
</pre></div>

</dd>
<dt><code>remove-parameter</code></dt>
<dd><p>Removes a parameter value.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{
  &quot;action&quot;: &quot;remove-parameter&quot;,
  &quot;parameter&quot;: {
    &quot;key&quot;: &quot;key&quot;,
    &quot;value&quot;: &quot;value&quot;
  }
}
</pre></div>

<p>Example response:
</p><div class="example">
<pre class="example">{&quot;message&quot;:&quot;Parameter removed.&quot;,&quot;status&quot;:200}
</pre></div>

</dd>
<dt><code>get-parameters</code></dt>
<dd><p>Lists parameters.
</p>
<p>Example request:
</p><div class="example">
<pre class="example">{&quot;action&quot;:&quot;get-parameters&quot;}
</pre></div>

<div class="example">
<pre class="example">{
  &quot;message&quot;: &quot;Parameters list.&quot;,
  &quot;parameters&quot;: [
    {
      &quot;key&quot;: &quot;asd&quot;,
      &quot;value&quot;: &quot;def&quot;
    },
    {
      &quot;key&quot;: &quot;bunchy&quot;,
      &quot;value&quot;: &quot;loss&quot;
    },
    {
      &quot;key&quot;: &quot;key&quot;,
      &quot;value&quot;: &quot;value&quot;
    }
  ],
  &quot;status&quot;: 201
}
</pre></div>

</dd>
</dl>

<span id="Status-codes"></span><h3 class="heading">Status codes</h3>

<p>Error codes always start with 3 or 5. A 3xx error code results from
something which is your fault e.g. procedural or syntactic violation, 5xx
error codes result from errors internal to the system. This is still
probably your fault :) e.g. specifying an interface which doesn&rsquo;t exist.
</p>
<p>A 2xx means you didn&rsquo;t do anything wrong, and the command worked.
</p>


<hr>
<span id="cybermon-invocation"></span><div class="header">
<p>
Next: <a href="#cybermon-configuration" accesskey="n" rel="next"><code>cybermon</code> configuration</a>, Previous: <a href="#Management-protocol" accesskey="p" rel="prev">Management protocol</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon-invocation-1"></span><h3 class="section">9.8 <code>cybermon</code> invocation</h3>

<span id="index-cybermon_002c-invocation"></span>
<span id="index-VXLAN-2"></span>
<span id="index-AWS-Traffic-Mirroring-2"></span>

<p><code>cybermon</code> is a configurable network packet stream analyser.  It is
designed to receive packets from cyberprobe, analyse them and generate
session/transport level events which result in user-configurable
actions. For each event, a call is made to a Lua script which the caller
provides.  Synposes:
</p>
<div class="example">
<pre class="example">cybermon [--help] [--transport TRANSPORT] [--port PORT] [--key KEY]
        [--certificate CERT] [--trusted-ca CHAIN] [--pcap PCAP-FILE]
        [--config CONFIG] [--vxlan VXLAN-PORT] [--interface IFACE]
        [--device DEVICE] [--time-limit LIMIT]
</pre></div>

<ul>
<li> <var>TRANSPORT</var>
is either &lsquo;<samp>tcp</samp>&rsquo; or &lsquo;<samp>tls</samp>&rsquo;.  If &lsquo;<samp>tls</samp>&rsquo; is specified, &lsquo;<samp>cybermon</samp>&rsquo;
expects to read data over TLS.  In TLS mode, it is necessary to specify the
key, certificate, and trusted CA files.

</li><li> <var>PORT</var>
is a TCP port number.  This form of the command runs as a TCP server
listening for ETSI LI streams.  See <a href="#ETSI-LI">ETSI LI</a>.

</li><li> <var>KEY</var>
specifies a filename for the private key in PEM format.  Only used in TLS mode.

</li><li> <var>CERT</var>
specifies a filename for the public certificate in PEM format.
Only used in TLS mode.

</li><li> <var>CHAIN</var>
specifies a filename for trusted CA keys in PEM format.  Only used in TLS mode.

</li><li> <var>PCAP-FILE</var>
is a PCAP file to read.  This form of the command reads the PCAP file, and
then exits.  If the file is &lsquo;<samp>-</samp>&rsquo;, standard input is read.

</li><li> <var>CONFIG</var>
is a Lua configuration file, which specifies the action <code>cybermon</code>
should take when certain events are observed.  See
<a href="#cybermon-configuration"><code>cybermon</code> configuration</a>.

</li><li> <var>VXLAN-PORT</var>
is a UDP port number.  This describes a port number to listen on for
VXLAN protocol.  This scenario is used to receive traffic-mirrored data
on AWS.

</li><li> <var>IFACE</var>
is a network interface to sniff for packets as input.

</li><li> <var>DEVICE</var>
is a device-name to include in the output events.  Use this to specify
the device for PCAP files, interfaces or VXLAN input if you don&rsquo;t want the
default placeholder.

</li><li> <var>LIMIT</var>
is the length of time to run for (in seconds).  The program exits after this
period.

</li></ul>



<hr>
<span id="cybermon-configuration"></span><div class="header">
<p>
Next: <a href="#cybermon-example-configurations" accesskey="n" rel="next"><code>cybermon</code> example configurations</a>, Previous: <a href="#cybermon-invocation" accesskey="p" rel="prev"><code>cybermon</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon-configuration-1"></span><h3 class="section">9.9 <code>cybermon</code> configuration</h3>

<span id="Overview-4"></span><h3 class="heading">Overview</h3>

<p>Cybermon is a simple monitoring tool. It receives the ETSI protocol, decodes
the protocols, and makes decoded information available for further handling
which you can specify. The tool is very much a work in progress - it has
limited protocol decode capability at the moment, but there&rsquo;s enough there
to demonstrate the idea.  Usage
</p>
<p>Usage is: <code>cybermon -p &lt;port-number&gt; -c &lt;config-file&gt;</code>
</p>
<p>You specify a port number to receive data on, and a configuration file
written in Lua. Lua is a simple but powerful scripting language. Here&rsquo;s an
example to help you see how the configuration is used.
</p>
<span id="Example-configuration"></span><h3 class="heading">Example configuration</h3>

<p>The configuration file is there to provide functions which get called when
certain events occur. The calling interface is fairly simple at the moment,
and over time, expect to see a richer interface develop.
</p>
<p>To start with, we create the structure of the configuration file. Call it
something with a <code>.lua</code> extension e.g. <code>config.lua</code> so that your
editor knows how to indent the code. The basic structure is a module with a
number of functions:
</p>
<div class="example">
<pre class="example">local observer = {}

-- Called when an event occurs
observer.event = function(e)
  print(e.action)
end

-- Return the table
return observer

</pre></div>

<span id="index-LUA-events"></span>
<span id="index-cybermon-events"></span>
<span id="index-action"></span>
<span id="LUA-event-calls"></span><h3 class="heading">LUA event calls</h3>

<p>The configuration file is expected to provide the event function
which is called with a single argument, an event, in response to
<code>cybermon</code> events.  The event looks like a table, but is a userdata
object.  While the object has fields which can be read, they cannot be changed
in the event object itself.
</p>
<p>There are standard fields in the event object:
</p>
<dl compact="compact">
<dt><code>device</code></dt>
<dd>
<p>Return the device identifier.
</p>
</dd>
<dt><code>time</code></dt>
<dd>
<p>The time of the event.
</p>
</dd>
<dt><code>action</code></dt>
<dd>
<p>The action which caused the event.
</p>
</dd>
<dt><code>json</code></dt>
<dd>
<p>Returns the event in JSON form.
</p>
</dd>
<dt><code>protobuf</code></dt>
<dd>
<p>Returns the event in protobuf format.
</p>
</dd>
</dl>

<p>The structure of the event object depends
on the <code>action</code> field.
</p>
<dl compact="compact">
<dt><code>trigger_up</code></dt>
<dd>
<p>Called when an attacker is seen coming on-stream.  The event contains
the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>device</code></dt>
<dd><p>describes the device ID
</p>
</dd>
<dt><code>address</code></dt>
<dd><p>contains the triggering IP address in string form.
</p>
</dd>
</dl>

</dd>
<dt><code>trigger_down</code></dt>
<dd><p>Called when an attacker is seen going off-stream.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>device</code></dt>
<dd><p>describes the device ID
</p>
</dd>
</dl>

</dd>
<dt><code>connection_up</code></dt>
<dd><p>Called when a stream-based connection (e.g. TCP) is made.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
</dl>

</dd>
<dt><code>connection_down</code></dt>
<dd><p>Similar to <code>connection_up</code>, called when a connection closes.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
</dl>

</dd>
<dt><code>icmp</code></dt>
<dd><p>Called when an ICMP message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>type</code></dt>
<dd><p>ICMP type value
</p>
</dd>
<dt><code>code</code></dt>
<dd><p>ICMP code value
</p>
</dd>
</dl>

</dd>
<dt><code>http_request</code></dt>
<dd><p>Called when an HTTP request is observed.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>method</code></dt>
<dd><p>HTTP method
</p>
</dd>
<dt><code>url</code></dt>
<dd><p>HTTP URL (derived from host and path).
</p>
</dd>
<dt><code>header</code></dt>
<dd><p>HTTP header values in a Lua associative array.
</p>
</dd>
<dt><code>body</code></dt>
<dd><p>HTTP request body, if one exists.
</p>
</dd>
</dl>

</dd>
<dt><code>http_response</code></dt>
<dd><p>Called when an HTTP response is observed.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>code</code></dt>
<dd><p>HTTP response code
</p>
</dd>
<dt><code>status</code></dt>
<dd><p>HTTP response status
</p>
</dd>
<dt><code>header</code></dt>
<dd><p>HTTP response header, a Lua associative array.
</p>
</dd>
<dt><code>body</code></dt>
<dd><p>HTTP response body.
</p>
</dd>
</dl>

</dd>
<dt><code>smtp_command</code></dt>
<dd><p>Called when an SMTP command is observed i.e. a single line message going to
the server from a client.
The event contains the following fields:
</p>

<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>command</code></dt>
<dd><p>the SMTP command
</p>
</dd>
</dl>

</dd>
<dt><code>smtp_response</code></dt>
<dd><p>Called when an SMTP response is observed.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>status</code></dt>
<dd><p>the SMTP status value e.g. <code>200</code>
</p>
</dd>
<dt><code>text</code></dt>
<dd><p>SMTP human-readable response text, an array of strings
</p>
</dd>
</dl>

</dd>
<dt><code>smtp_data</code></dt>
<dd><p>Called when an SMTP payload is observed i.e. the body of text following the
DATA command. To aid processing, the SMTP protocol processor assembles
information from other commands.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
</p>
</dd>
<dt><code>from</code></dt>
<dd><p>contains the email From address described in the MAIL FROM command.
</p>
</dd>
<dt><code>to</code></dt>
<dd><p>a list of addresses contained in all RCPT TO commands.  An array of strings.
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>contains the email body - it will be an RFC822
payload.
</p>
</dd>
</dl>

</dd>
<dt><code>ftp_command</code></dt>
<dd><p>Called when an FTP command is observed i.e. a single line message going to
the server from a client.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>command</code></dt>
<dd><p>contains the command string.
</p>
</dd>
</dl>

</dd>
<dt><code>ftp_response</code></dt>
<dd><p>Called when an FTP response is observed. That is, status going from server
to client following a command.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>status</code></dt>
<dd><p>FTP status code e.g. 200.
</p>
</dd>
<dt><code>text</code></dt>
<dd><p>contains the response text,
described as a list of strings. Responses may occur over a number of lines,
hence the parameter is a list: For single-line responses, there is only a
single item in the list.
</p>
</dd>
</dl>

</dd>
<dt><code>dns_message</code></dt>
<dd><p>Called when a DNS message is observed.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>header</code></dt>
<dd><p>describes the DNS header
</p>
</dd>
<dt><code>query</code></dt>
<dd><p>the DNS queries
</p>
</dd>
<dt><code>answer</code></dt>
<dd><p>contains the answers in a response message
</p>
</dd>
<dt><code>auth</code></dt>
<dd><p>DNS nameserver authority descriptions
</p>
</dd>
<dt><code>add</code></dt>
<dd><p>provides additional DNS records
</p>
</dd>
</dl>

</dd>
<dt><code>ntp_timestamp_message</code></dt>
<dd><p>Called when a NTP timestamp message is observed.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>header</code></dt>
<dd><p>the NTP header
</p>
</dd>
<dt><code>timestamp</code></dt>
<dd><p>contains the specific timestamp information
</p>
</dd>
</dl>

</dd>
<dt><code>ntp_control_message</code></dt>
<dd><p>Called when a NTP control message is observed.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>header</code></dt>
<dd><p>the NTP header
</p>
</dd>
<dt><code>control</code></dt>
<dd><p>specific NTP control information.
</p>
</dd>
</dl>

</dd>
<dt><code>ntp_private_message</code></dt>
<dd><p>Called when a NTP control message is observed.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>header</code></dt>
<dd><p>the NTP header
</p>
</dd>
<dt><code>private</code></dt>
<dd><p>specific NTP private information.
</p>
</dd>
</dl>

</dd>
<dt><code>unrecognised_datagram</code></dt>
<dd><p>Called when a datagram is received using a protocol which isn&rsquo;t
recognised.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the payload.
</p>
</dd>
</dl>

</dd>
<dt><code>unrecognised_stream</code></dt>
<dd><p>Called when connection-orientated data is received using a protocol which
isn&rsquo;t recognised.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the payload.
</p>
</dd>
<dt><code>position</code></dt>
<dd><p>the stream position of the payload in bytes.  Starts at 0 when stream is
connected, and increases with payload size.
</p>
</dd>
</dl>

</dd>
<dt><code>imap</code></dt>
<dd><p>Called when an IMAP message is detected - this is currently a port number
detection.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the payload.
</p>
</dd>
</dl>

</dd>
<dt><code>imap_ssl</code></dt>
<dd><p>Called when an IMAP SSL message is detected. This is currently a port number
detection.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the payload.
</p>
</dd>
</dl>

</dd>
<dt><code>pop3</code></dt>
<dd><p>Called when a POP3 message is detected.  This is currently
a port number detection.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the payload.
</p>
</dd>
</dl>

</dd>
<dt><code>pop3_ssl</code></dt>
<dd><p>Called when a POP3 SSL message is detected. This is currently a port number
detection.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the payload.
</p>
</dd>
</dl>

</dd>
<dt><code>sip_request</code></dt>
<dd><p>Called when a SIP request is observed.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>

</dd>
<dt><code>from</code></dt>
<dd><p>SIP originator
</p>
</dd>
<dt><code>to</code></dt>
<dd><p>SIP destination
</p>
</dd>
<dt><code>method</code></dt>
<dd><p>SIP method
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the payload.
</p>
</dd>
</dl>

</dd>
<dt><code>sip_response</code></dt>
<dd><p>Called when a SIP request is observed.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>code</code></dt>
<dd><p>SIP response code
</p>
</dd>
<dt><code>status</code></dt>
<dd><p>SIP response status
</p>
</dd>
<dt><code>from</code></dt>
<dd><p>SIP originator
</p>
</dd>
<dt><code>to</code></dt>
<dd><p>SIP destination
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the payload.
</p>
</dd>
</dl>

</dd>
<dt><code>sip_ssl</code></dt>
<dd><p>Called when a SIP SSL message is detected. This is currently a port number
detection.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the payload.
</p>
</dd>
</dl>

</dd>
<dt><code>gre</code></dt>
<dd><p>Called when a GRE message with an unknown ethertype is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>next_proto</code></dt>
<dd><p>the ethertype of the next protocol
</p>
</dd>
<dt><code>key</code></dt>
<dd><p>the key, if present. If the key is not present then it will default to 0.
</p>
</dd>
<dt><code>sequence_number</code></dt>
<dd><p>the sequence number, if present. If the sequence number is not present then it
will default to 0.
</p>
</dd>
<dt><code>payload</code></dt>
<dd><p>the payload
</p>
</dd>
</dl>

</dd>
<dt><code>gre_pptp</code></dt>
<dd><p>Called when a GRE PPTP message with an unknown ethertype is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>next_proto</code></dt>
<dd><p>the ethertype of the next protocol
</p>
</dd>
<dt><code>call_id</code></dt>
<dd><p>the call id
</p>
</dd>
<dt><code>sequence_number</code></dt>
<dd><p>the sequence number, if present. If the sequence number is not present then it
will default to 0.
</p>
</dd>
<dt><code>acknowledgement_number</code></dt>
<dd><p>the acknowledgement number, if present. If the acknowledgement number is not
present then it will default to 0.
</p>
</dd>
<dt><code>payload_length</code></dt>
<dd><p>the payload length
</p>
</dd>
<dt><code>payload</code></dt>
<dd><p>the payload
</p>
</dd>
</dl>

</dd>
<dt><code>esp</code></dt>
<dd><p>Called when an ESP packet is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>spi</code></dt>
<dd><p>the SPI
</p>
</dd>
<dt><code>sequence_number</code></dt>
<dd><p>the sequence number
</p>
</dd>
<dt><code>payload_length</code></dt>
<dd><p>the payload length
</p>
</dd>
<dt><code>payload</code></dt>
<dd><p>the payload
</p>
</dd>
</dl>

</dd>
<dt><code>unrecognised_ip_protocol</code></dt>
<dd><p>Called when an IP packet with an unhandled next protocol is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>next_proto</code></dt>
<dd><p>the protocol number of the next protocol
</p>
</dd>
<dt><code>payload_length</code></dt>
<dd><p>the payload length
</p>
</dd>
<dt><code>payload</code></dt>
<dd><p>the payload
</p>
</dd>
</dl>

</dd>
<dt><code>wlan</code></dt>
<dd><p>Called when an 802.11 packet is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>version</code></dt>
<dd><p>the 802.11 version
</p>
</dd>
<dt><code>type</code></dt>
<dd><p>the type of the 802.11 dataframe
</p>
</dd>
<dt><code>subtype</code></dt>
<dd><p>the subtype of the 802.11 dataframe
</p>
</dd>
<dt><code>flags</code></dt>
<dd><p>the flags of the 802.11 dataframe
</p>
</dd>
<dt><code>protected</code></dt>
<dd><p>the protected flag of the 802.11 dataframe, indicates if the payload is encrypted
</p>
</dd>
<dt><code>duration</code></dt>
<dd><p>the duration
</p>
</dd>
<dt><code>filt_addr</code></dt>
<dd><p>the filter MAC address
</p>
</dd>
<dt><code>frag_num</code></dt>
<dd><p>the fragmentation number of the dataframe
</p>
</dd>
<dt><code>seq_num</code></dt>
<dd><p>the sequence number of the dataframe
</p>
</dd>
</dl>

</dd>
<dt><code>tls_unknown</code></dt>
<dd><p>Called when an unknown TLS message (i.e. one that isn&rsquo;t covered by further
handling) is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>version</code></dt>
<dd><p>The version of the TLS header.
</p>
</dd>
<dt><code>content_type</code></dt>
<dd><p>The content type of the TLS message.
</p>
</dd>
<dt><code>length</code></dt>
<dd><p>The length of the TLS message.
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_client_hello</code></dt>
<dd><p>Called when a TLS Client Hello message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>version</code></dt>
<dd><p>The TLS version specified in the client hello message.
</p>
</dd>
<dt><code>session_id</code></dt>
<dd><p>The session ID of the message.
</p>
</dd>
<dt><code>random_timestamp</code></dt>
<dd><p>The timestamp field in the random field of the TLS message.
</p>
</dd>
<dt><code>random_data</code></dt>
<dd><p>The data field in the random field of the TLS message.
</p>
</dd>
<dt><code>cipher_suites</code></dt>
<dd><p>An ordered array of the cipher suites from the message.
Each entry is a table with <code>id</code> and <code>name</code> fields.
</p>
</dd>
<dt><code>compression_methods</code></dt>
<dd><p>An ordered array of the compression methods from the message.
Each entry is a table with <code>id</code> and <code>name</code> fields.
</p>
</dd>
<dt><code>extensions</code></dt>
<dd><p>An ordered array of the extensions from the message.
Each entry is a table with <code>name</code>, <code>length</code> and <code>data</code> fields.
(<code>data</code> will only be present if the <code>length</code> &gt; 0)
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_server_hello</code></dt>
<dd><p>Called when a TLS Server Hello message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>version</code></dt>
<dd><p>The TLS version specified in the server hello message.
</p>
</dd>
<dt><code>session_id</code></dt>
<dd><p>The session ID of the message.
</p>
</dd>
<dt><code>random_timestamp</code></dt>
<dd><p>The timestamp field in the random field of the TLS message.
</p>
</dd>
<dt><code>random_data</code></dt>
<dd><p>The data field in the random field of the TLS message.
</p>
</dd>
<dt><code>cipher_suite</code></dt>
<dd><p>The cipher suite from the message, as a table with <code>id</code> and <code>name</code> fields.
</p>
</dd>
<dt><code>compression_method</code></dt>
<dd><p>The compression method from the message, as a table with <code>id</code> and <code>name</code> fields.
</p>
</dd>
<dt><code>extensions</code></dt>
<dd><p>An ordered array of the extensions from the message.
Each entry is a table with <code>name</code>, <code>length</code> and <code>data</code> fields.
(<code>data</code> will only be present if the <code>length</code> &gt; 0)
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_server_key_exchange</code></dt>
<dd><p>Called when a TLS Server Key Exchange message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>key_exchange_algorithm</code></dt>
<dd><p>The key exchange algorithm being used.
</p>
</dd>
<dt><code>curve_metadata</code></dt>
<dd><p>Metadata about the curve (if ecdh) being used, as key:value pairs.
</p>
</dd>
<dt><code>public_key</code></dt>
<dd><p>The public key field as bytes.
</p>
</dd>
<dt><code>signature_hash_algorithm</code></dt>
<dd><p>The signature hash algorithm field.
</p>
</dd>
<dt><code>signature_algorithm</code></dt>
<dd><p>The signature algorithm field.
</p>
</dd>
<dt><code>signature_hash</code></dt>
<dd><p>The signature hash field. As a hex string
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_certificates</code></dt>
<dd><p>Called when a TLS certificates message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>certificates</code></dt>
<dd><p>an ordered array of certificates, each in bytes.
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_server_hello_done</code></dt>
<dd><p>Called when a TLS Server Hello Done message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
</dl>

</dd>
<dt><code>tls_handshake_unknown</code></dt>
<dd><p>Called when a TLS handshake message is detected, that isnt explicitly handled.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>type</code></dt>
<dd><p>the type of the handshake message
</p>
</dd>
<dt><code>length</code></dt>
<dd><p>the length of the handshake message
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_certificate_request</code></dt>
<dd><p>Called when a TLS certificate request message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>cert_types</code></dt>
<dd><p>An ordered array of certificate types
</p>
</dd>
<dt><code>signature_algorithms</code></dt>
<dd><p>An ordered array of the Signature Algorithms from the message.
Each entry is a table with <code>hash_algorithm</code> and <code>signature_algorithm</code> fields.
</p>
</dd>
<dt><code>distinguished_names</code></dt>
<dd><p>the distinguished names field in bytes
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_client_key_exchange</code></dt>
<dd><p>Called when a TLS client key exchange message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>key</code></dt>
<dd><p>the key in bytes
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_certificate_verify</code></dt>
<dd><p>Called when a TLS certificate verify message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>signature_algorithm</code></dt>
<dd><p>the Signature Algorithms from the message. As a table with <code>hash_algorithm</code>
and <code>signature_algorithm</code> fields.
</p>
</dd>
<dt><code>signature</code></dt>
<dd><p>the signature as a hex string
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_change_cipher_spec</code></dt>
<dd><p>Called when a TLS change cipher spec message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>val</code></dt>
<dd><p>the value field
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_handshake_finished</code></dt>
<dd><p>Called when a TLS handshake finished message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>msg</code></dt>
<dd><p>the encrypted message
</p>
</dd>
</dl>

</dd>
</dl>

</dd>
<dt><code>tls_handshake_complete</code></dt>
<dd><p>Called when a TLS handshake has been completely finished - i.e. both sides of the
communication have sent change_cipher_spec and handshake_finished.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
</dl>

</dd>
<dt><code>tls_application_data</code></dt>
<dd><p>Called when a TLS application data message is detected.
The event contains the following fields:
</p>
<dl compact="compact">
<dt><code>time</code></dt>
<dd><p>time of event in format <code>YYYYMMDDTHHMMSS.sssZ</code>
</p>
</dd>
<dt><code>context</code></dt>
<dd><p>a LUA userdata variable which can&rsquo;t be access directly, but can
be used with the functions described below to access further information
from <code>cybermon</code>.
</p>
</dd>
<dt><code>tls</code></dt>
<dd><dl compact="compact">
<dt><code>version</code></dt>
<dd><p>the version on the TLS header.
</p>
</dd>
<dt><code>data</code></dt>
<dd><p>the encrypted message.
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
</dl>

<span id="index-context-object"></span>
<span id="index-cybermon-context-object"></span>
<span id="Context-object"></span><h3 class="heading">Context object</h3>

<p>From the LUA code there, the <code>context</code> variable has a number of method
functions which can be called:
</p>
<dl compact="compact">
<dt><code>context:get_type()</code></dt>
<dd><p>Returns the protocol type of the context e.g. <code>http</code>, <code>tcp</code>, <code>udp</code>, <code>dns</code>, <code>ip4</code>
</p>
</dd>
<dt><code>context:get_parent()</code></dt>
<dd>
<p>Returns the parent context relating to a context. This can be used to travel
&quot;up&quot; the protocol stack. For example, call get_parent on a TCP context will
return the IP context.
</p>
</dd>
<dt><code>context:get_src_addr()</code></dt>
<dd><p>Returns the source address relating to a context. Returns two string
variables: the first is the address class e.g. <code>ipv4</code>, the second is the
address value e.g. <code>1.2.3.4</code>.
</p>
</dd>
<dt><code>context:get_dest_addr()</code></dt>
<dd><p>Returns the destination address relating to a context. Returns two string
variables: the first is the address class e.g. <code>ipv4</code>, the second is the
address value e.g. <code>1.2.3.4</code>.
</p>
</dd>
<dt><code>context:get_reverse()</code></dt>
<dd><p>Returns the context relating to the &quot;other side&quot; of a communication, but
only if this has been identified. On an HTTP response, <code>get_reverse</code>
will return the HTTP request. In the <code>http_request</code> function you will
not be able to use <code>get_reverse</code> to find the HTTP response because the
response does not exist at the point the request is identified.
</p>
</dd>
<dt><code>context:get_id()</code></dt>
<dd><p>Returns a context&rsquo;s unique ID. Can be useful for tracking, or can be used as
index into your own LUA structures to associate information with contexts.
</p>
</dd>
<dt><code>context:describe_src()</code></dt>
<dd><p>Returns a human readable description of the protocol stack using source
addresses.
</p>
</dd>
<dt><code>context:describe_dest()</code></dt>
<dd><p>Returns a human readable description of the protocol stack using source
addresses.
</p>
</dd>
<dt><code>context:get_device()</code></dt>
<dd><p>Returns the trigger ID associated with a &quot;target&quot;.
</p>
</dd>
<dt><code>context:get_network_info()</code></dt>
<dd><span id="index-network-attribute_002c-cyberprobe_002ecfg-1"></span>
<p>Returns three variables: the network name (from ETSI NetworkElementID),
the source and destination network addresses (IP addresses) for this data.
These are in normal IP address string format.  Network name is
the empty string, if not provided in the input stream.
See <a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a> for specifying the
network.
</p>
</dd>
<dt><code>context:get_trigger_info()</code></dt>
<dd><p>Returns the IP address which triggered this collection, if known. If not,
<code>0.0.0.0</code>x is returned. This is in normal IP address string format.
</p>
</dd>
<dt><code>context:get_direction()</code></dt>
<dd><p>Returns the direction of the event with respect to the target device, if
known.  This will be a string containing &lsquo;<samp>FROM_DEVICE</samp>&rsquo;, &lsquo;<samp>TO_DEVICE</samp>&rsquo;,
or &lsquo;<samp>NOT_KNOWN</samp>&rsquo;.  The packet direction can only be determined if
the ETSI stream delivery format is in use.  <code>cyberprobe</code> works out
packet direction with respect to the addresses specified in the
<samp>cyberprobe.cfg</samp> file.
</p>
</dd>
<dt><code>context:forge_tcp_reset()</code></dt>
<dd><p>Creates a TCP reset packet and directs it at the source address associated
with this context. Must have TCP protocol present in the stack.
</p>
</dd>
<dt><code>context:forge_dns_response(header, queries, answers, add)</code></dt>
<dd><p>Creates a DNS message and directs it at the source
address associated with this context. The provided parameters are used as
protocol data in the DNS encoder.
</p>
</dd>
</dl>

<span id="gRPC-object"></span><h3 class="heading">gRPC object</h3>
<span id="index-gRPC-1"></span>
<span id="index-Protobuf-1"></span>

<p>If gRPC support is compiled into cybermon, a gRPC call containing the
event, conforming to eventstream protobuf format can be made by calling
<code>grpc:observe(e, service)</code>.  The first parameter is an event object,
the second is a service address in &lsquo;<samp>host:port</samp>&rsquo; format.  The gRPC
call is used to deliver an event asynchronously, and nothing is returned
from the service.  The <code>grpc:observe</code> call silently succeeds, and
events are held in a queue until delivered.  The call will block if the queue
achieves a pre-defined defined limit.
</p>
<div class="example">
<pre class="example">observer = {}

observer.event = function(e)
  grpc:observe(e, &quot;localhost:50051&quot;)
end

return observer
</pre></div>

<span id="index-eventstream_002dservice"></span>
<p>The <samp>cyberprobe.proto</samp> file in the source code contains the protobuf/gRPC
service definition.  The sample gRPC client <code>eventstream-service</code> can
be used to receive cyberprobe gRPC events.  See <a href="#eventstream_002dservice">eventstream-service</a>.
</p>


<hr>
<span id="cybermon-example-configurations"></span><div class="header">
<p>
Next: <a href="#Cybermon-JSON-message-format" accesskey="n" rel="next">Cybermon JSON message format</a>, Previous: <a href="#cybermon-configuration" accesskey="p" rel="prev"><code>cybermon</code> configuration</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon-example-configurations-1"></span><h3 class="section">9.10 <code>cybermon</code> example configurations</h3>

<span id="index-cybermon_002c-example-configurations"></span>
<span id="index-cybermon_002c-configuration-1"></span>
<span id="Example-configuration-files"></span><h3 class="heading">Example configuration files</h3>

<dl compact="compact">
<dt><samp>forge-dns.lua</samp></dt>
<dd>
<p>Example Lua script, spots DNS queries for &lsquo;<samp>example.org</samp>&rsquo;, and responds
with made-up IP addresses.
</p>
</dd>
<dt><samp>forge-reset.lua</samp></dt>
<dd>
<p>Example script, spots TCP port 22 sessions (which is the port number normally
used for SSH sessions).  If detected, a TCP reset is forged.
</p>
</dd>
<dt><samp>hexdump.lua</samp></dt>
<dd>
<p>Like <samp>monitor.lua</samp>, but adds a hex-dump of event payloads to the output.
</p>
</dd>
<dt><samp>monitor.lua</samp></dt>
<dd>
<p>For each Lua event, outputs a plain text summary of the output on standard
output.
</p>
</dd>
<dt><samp>zeromq.lua</samp></dt>
<dd>
<span id="index-ZeroMQ"></span>
<span id="index-Cybermon-JSON-message-format"></span>
<span id="index-publish_002fsubscribe"></span>
<span id="index-pub_002fsub"></span>
<span id="index-JSON-2"></span>

<p>For each Lua event, a JSON record is formatted and published to a ZeroMQ
queue on port 5555.  See <a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a>.
</p>
</dd>
<dt><samp>amqp-topic.lua</samp></dt>
<dd>
<span id="index-AMQP"></span>
<span id="index-RabbitMQ"></span>
<span id="index-Cybermon-JSON-message-format-1"></span>
<span id="index-publish_002fsubscribe-1"></span>
<span id="index-pub_002fsub-1"></span>
<span id="index-JSON-3"></span>

<p>For each Lua event, a JSON record is formatted and published to a RabbitMQ
broker.  See <a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a>.  Environment variables
&lsquo;<samp>AMQP_BROKER</samp>&rsquo;, &lsquo;<samp>AMQP_EXCHANGE</samp>&rsquo;, &lsquo;<samp>AMQP_ROUTING_KEY</samp>&rsquo; can be
used to tailor delivery.
</p>
</dd>
<dt><samp>redis.lua</samp></dt>
<dd>
<span id="index-Redis"></span>
<span id="index-Cybermon-JSON-message-format-2"></span>
<span id="index-queue-delivery-using-Redis"></span>
<span id="index-JSON-4"></span>

<p>For each Lua event, a JSON record is formatted and RPUSH&rsquo;d to a Redis server
defiend by the <code>REDIS_SERVER</code> environment variable which should be in
<code>HOST:PORT</code> form.
Each message is JSON format, see <a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a>.
</p>
</dd>
<dt><samp>json.lua</samp></dt>
<dd>
<span id="index-Cybermon-JSON-message-format-3"></span>
<span id="index-JSON-5"></span>

<p>For each Lua event, a JSON record is formatted and delivered to standard
outut.
Each message is JSON format, see <a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a>.
</p>
</dd>
<dt><samp>quiet.lua</samp></dt>
<dd>
<p>Does nothing.  This is an empty code shell, and a good template to write
your own event handler.
</p>
</dd>
<dt><samp>protobuf.lua</samp></dt>
<dd><span id="index-Protobuf-2"></span>

<p>Outputs protobuf-formatted messages in base64 format, one message per line.
Probably only useful for testing.
</p>
</dd>
<dt><samp>grpc.lua</samp></dt>
<dd>
<span id="index-gRPC-2"></span>
<span id="index-Protobuf-3"></span>
<p>For each Lua event, a gRPC call is made to a service
defiend by the <code>GRPC_SERVICE</code> environment variable which should be in
<code>HOST:PORT</code> form.
Each message is protobuf format as defined by the <samp>cyberprobe.proto</samp>
definition.
</p>
</dd>
</dl>

<span id="Utilities"></span><h3 class="heading">Utilities</h3>

<p>The <samp>/usr/local/etc/cyberprobe/util</samp> directory contains some Lua
utilities which can be used by other Lua configuration files.  They can be
loaded as modules e.g.
</p>
<div class="example">
<pre class="example">local addr = require(&quot;util.addresses&quot;)
</pre></div>

<p>The utilities are:
</p>
<dl compact="compact">
<dt><samp>addresses.lua</samp></dt>
<dd><p>Some <code>cybermon</code> address handling functions.
</p>
</dd>
<dt><samp>json.lua</samp></dt>
<dd><p>The real JSON formatting is done here.
</p>
</dd>
</dl>



<hr>
<span id="Cybermon-JSON-message-format"></span><div class="header">
<p>
Next: <a href="#cybermon_002dmonitor-invocation" accesskey="n" rel="next"><code>cybermon-monitor</code> invocation</a>, Previous: <a href="#cybermon-example-configurations" accesskey="p" rel="prev"><code>cybermon</code> example configurations</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Cybermon-JSON-message-format-1"></span><h3 class="section">9.11 Cybermon JSON message format</h3>

<span id="index-ZeroMQ-1"></span>
<span id="index-RabbitMQ-1"></span>
<span id="index-AMQP-1"></span>
<span id="index-Redis-1"></span>
<span id="index-Cybermon-JSON-message-format-4"></span>
<span id="index-publish_002fsubscribe-2"></span>
<span id="index-pub_002fsub-2"></span>
<span id="index-JSON-6"></span>

<p>Cybermon&rsquo;s &lsquo;<samp>amqp-topic.lua</samp>&rsquo;, &lsquo;<samp>zeromq.lua</samp>&rsquo; and &lsquo;<samp>redis.lua</samp>&rsquo;
configuration files
transmit messages in JSON format.  Each message is a JSON object
with the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>id</samp>&rsquo;</dt>
<dd><p>Unique ID for the event: UUID format
(e.g. 3c55d830-8d99-48a1-c8cd-ca77514a6d10).
</p>
</dd>
<dt>&lsquo;<samp>device</samp>&rsquo;</dt>
<dd><p>Device identifier / LIID.
</p>
</dd>
<dt>&lsquo;<samp>network</samp>&rsquo;</dt>
<dd><span id="index-network-attribute_002c-cyberprobe_002ecfg-2"></span>
<p>Network identifier, if ETSI stream delivery is used, and the
<code>network</code> identifier is used in <samp>cyberprobe.cfg</samp>.
See <a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a>
</p>
</dd>
<dt>&lsquo;<samp>origin</samp>&rsquo;</dt>
<dd><p>If known, set to &lsquo;<samp>network</samp>&rsquo; or &lsquo;<samp>device</samp>&rsquo; depending on whether or not the
event is observed to originate from the device or, the device is the recipient.
This assertion is made by comparing the targeted IP address with the
source/destination IP addresses of an event.  The &lsquo;<samp>origin</samp>&rsquo; field will
only be
useful if a device IP address is set in the <samp>cyberprobe.cfg</samp> file;
if a wildcard address e.g. &lsquo;<samp>0.0.0.0/0</samp>&rsquo; is set, it is not defined
which of the source or destination addresses will trigger in
<code>cyberprobe</code>, and so the &lsquo;<samp>origin</samp>&rsquo; field will be of no value.
Further, the field is only known if the ETSI stream format is used to deliver
from <code>cyberprobe</code> to <code>cybermon</code>.
</p>
</dd>
<dt>&lsquo;<samp>action</samp>&rsquo;</dt>
<dd><p>The event type.  One of:
</p><dl compact="compact">
<dt>&lsquo;<samp>connected_up</samp>&rsquo;</dt>
<dd><p>Records the creation of a stream-orientated connection (currently, only TCP).
This event is created for all connections whether the protocol is
recognised or not.
</p></dd>
<dt>&lsquo;<samp>connected_down</samp>&rsquo;</dt>
<dd><p>Records the closing of a stream-orientated connection (currently, only TCP).
This event is created for all connections whether the protocol is
recognised or not.
</p></dd>
<dt>&lsquo;<samp>unrecognised_stream</samp>&rsquo;</dt>
<dd><p>Records the sending of a PDU on a data stream transport (currently, only
TCP) whose protocol has not been recognised.
</p></dd>
<dt>&lsquo;<samp>unrecognised_datagram</samp>&rsquo;</dt>
<dd><p>Records the sending of a PDU on a connection-less transport (currently, only
UDP) whose protocol has not been recognised.
</p></dd>
<dt>&lsquo;<samp>http_request</samp>&rsquo;</dt>
<dd><p>Records the sending of an HTTP request.
</p></dd>
<dt>&lsquo;<samp>http_response</samp>&rsquo;</dt>
<dd><p>Records the sending of an HTTP response.
</p></dd>
<dt>&lsquo;<samp>dns_message</samp>&rsquo;</dt>
<dd><p>Records the sending of a DNS message (request and response).
</p></dd>
<dt>&lsquo;<samp>icmp</samp>&rsquo;</dt>
<dd><p>Records the sending of an ICMP message.
</p></dd>
<dt>&lsquo;<samp>smtp_command</samp>&rsquo;</dt>
<dd><p>Records the sending of an SMTP command.  This is a message from client
to server.  Data commands are not recorded with this event - there is an
&lsquo;<samp>smtp_data</samp>&rsquo; event which records this.
</p></dd>
<dt>&lsquo;<samp>smtp_response</samp>&rsquo;</dt>
<dd><p>Records the sending of a response to an SMTP command.  This is a status
message from server to client.
</p></dd>
<dt>&lsquo;<samp>smtp_data</samp>&rsquo;</dt>
<dd><p>Records an SMTP data transaction, including the full SMTP data payload
(essentially an email).
</p></dd>
<dt>&lsquo;<samp>ftp_command</samp>&rsquo;</dt>
<dd><p>Records an FTP command (client to server).
</p></dd>
<dt>&lsquo;<samp>ftp_response</samp>&rsquo;</dt>
<dd><p>Records an FTP response (server to client).
</p></dd>
<dt>&lsquo;<samp>ntp_message</samp>&rsquo;</dt>
<dd><p>Records the sending of a NTP message, including the NTP hdr (mode, version, leap second indicator)
</p></dd>
<dt>&lsquo;<samp>imap</samp>&rsquo;</dt>
<dd><p>Records the presence of IMAP data.
</p></dd>
<dt>&lsquo;<samp>imap_ssl</samp>&rsquo;</dt>
<dd><p>Records the presence of IMAP SSL data.
</p></dd>
<dt>&lsquo;<samp>pop3</samp>&rsquo;</dt>
<dd><p>Records the presence of POP.3 data.
</p></dd>
<dt>&lsquo;<samp>pop3_ssl</samp>&rsquo;</dt>
<dd><p>Records the presence of POP3 SSL data.
</p></dd>
<dt>&lsquo;<samp>sip_request</samp>&rsquo;</dt>
<dd><p>Records the sending of a SIP request.
</p></dd>
<dt>&lsquo;<samp>sip_response</samp>&rsquo;</dt>
<dd><p>Records the sending of a SIP response.
</p></dd>
<dt>&lsquo;<samp>sip_ssl</samp>&rsquo;</dt>
<dd><p>Records the presence of SIP SSL data.
</p></dd>
<dt>&lsquo;<samp>gre</samp>&rsquo;</dt>
<dd><p>Records the presence of a GRE data frame with an unhandled ethertype.
</p></dd>
<dt>&lsquo;<samp>grep_pptp</samp>&rsquo;</dt>
<dd><p>Records the presence of a GRE PPTP data frame with an unhandled ethertype.
</p></dd>
<dt>&lsquo;<samp>esp</samp>&rsquo;</dt>
<dd><p>Records the presence of ESP data.
</p></dd>
<dt>&lsquo;<samp>unrecognised_ip_protocol</samp>&rsquo;</dt>
<dd><p>Records the sending of a PDU over IP with an unrecognised next protocol.
</p></dd>
<dt>&lsquo;<samp>wlan</samp>&rsquo;</dt>
<dd><p>Records the presence of 802.11 data.
</p></dd>
<dt>&lsquo;<samp>tls_unknown</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls message.
</p></dd>
<dt>&lsquo;<samp>tls_client_hello</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls client hello message.
</p></dd>
<dt>&lsquo;<samp>tls_server_hello</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls server hello message.
</p></dd>
<dt>&lsquo;<samp>tls_certificates</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls certificates message.
</p></dd>
<dt>&lsquo;<samp>tls_server_key_exchange</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls server key exchange message.
</p></dd>
<dt>&lsquo;<samp>tls_server_hello_done</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls server hello done message.
</p></dd>
<dt>&lsquo;<samp>tls_handshake_unknown</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls handshake message.
</p></dd>
<dt>&lsquo;<samp>tls_certificate_request</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls certificate request message.
</p></dd>
<dt>&lsquo;<samp>tls_client_key_exchange</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls client_key exchange message.
</p></dd>
<dt>&lsquo;<samp>tls_certificate_verify</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls certificate verify message.
</p></dd>
<dt>&lsquo;<samp>tls_change_cipher_spec</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls change cipher spec message.
</p></dd>
<dt>&lsquo;<samp>tls_handshake_finished</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls handshake finished message.
</p></dd>
<dt>&lsquo;<samp>tls_handshake_complete</samp>&rsquo;</dt>
<dd><p>Records the that both sides of the TLS handshake are complete.
</p></dd>
<dt>&lsquo;<samp>tls_application_data</samp>&rsquo;</dt>
<dd><p>Records the presence of a tls application data message.
</p>
</dd>
</dl>

</dd>
<dt>&lsquo;<samp>url</samp>&rsquo;</dt>
<dd><p>The URL identified in any protocol which supports URL request/response e.g.
HTTP.
</p>
</dd>
<dt>&lsquo;<samp>src</samp>&rsquo;</dt>
<dd><p>A list of source protocol addresses travelling up the stack.
Strings are of the form
<code>protocol:address</code> or <code>protocol</code>.  Example protocol types are:
<code>tcp</code>, <code>udp</code> and <code>ipv4</code>.
</p>
</dd>
<dt>&lsquo;<samp>dest</samp>&rsquo;</dt>
<dd><p>A list of source protocol addresses travelling up the stack.
Strings are of the form
<code>protocol:address</code> or <code>protocol</code>.  Example protocol types are:
<code>tcp</code>, <code>udp</code> and <code>ipv4</code>.
</p>
</dd>
<dt>&lsquo;<samp>time</samp>&rsquo;</dt>
<dd><p>Time of the event in the form <code>2017-04-24T12:34:24.341Z</code>.
</p>

</dd>
<dt>&lsquo;<samp>dns_message</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>dns_message</code>.
<code>dns_message</code> is itself a
JSON object containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>query</samp>&rsquo;</dt>
<dd><p>Describes DNS query records in &lsquo;<samp>dns_message</samp>&rsquo; actions. Is a list
of objects with &lsquo;<samp>name</samp>&rsquo;, &lsquo;<samp>type</samp>&rsquo; and &lsquo;<samp>class</samp>&rsquo; fields containing
strings for name, type and class.
</p>
</dd>
<dt>&lsquo;<samp>answer</samp>&rsquo;</dt>
<dd><p>Describes DNS answer records in &lsquo;<samp>dns_message</samp>&rsquo; actions.  Is a list
of objects with &lsquo;<samp>name</samp>&rsquo;, &lsquo;<samp>type</samp>&rsquo; and &lsquo;<samp>class</samp>&rsquo; and &lsquo;<samp>address</samp>&rsquo;
fields containing strings for name, type and class and IP address.
</p>
</dd>
<dt>&lsquo;<samp>type</samp>&rsquo;</dt>
<dd><p>DNS message type, one of &lsquo;<samp>query</samp>&rsquo; or &lsquo;<samp>response</samp>&rsquo;.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>unrecognised_datagram</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>unrecognised_datagram</code>.
The value is a JSON object ontaining the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>datagram</samp>&rsquo;</dt>
<dd><p>The datagram body, Base64 encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>unrecognised_stream</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>unrecognised_stream</code>. 
The value is a JSON object ontaining the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>The datagram body, Base64 encoded.
</p>
</dd>
<dt>&lsquo;<samp>position</samp>&rsquo;</dt>
<dd><p>The stream position, 0 for a newly connected stream, increases with each
payload size.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>icmp</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>icmp</code>.
The value is a JSON object
ontaining the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>type</samp>&rsquo;</dt>
<dd><p>ICMP type field.
</p>
</dd>
<dt>&lsquo;<samp>code</samp>&rsquo;</dt>
<dd><p>ICMP code field.
</p>
</dd>
<dt>&lsquo;<samp>data</samp>&rsquo;</dt>
<dd><p>Raw ICMP payload, Base64 encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>http_request</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>http_request</code>.
The value is a JSON object
ontaining the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>method</samp>&rsquo;</dt>
<dd><p>HTTP method.
</p>
</dd>
<dt>&lsquo;<samp>header</samp>&rsquo;</dt>
<dd><p>An object containing key/value pairs for HTTP header.
</p>
</dd>
<dt>&lsquo;<samp>body</samp>&rsquo;</dt>
<dd><p>HTTP body, Base64 encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>http_response</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>http_response</code>.
The value is a JSON object
ontaining the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>code</samp>&rsquo;</dt>
<dd><p>HTTP code field e.g. 200.
</p>
</dd>
<dt>&lsquo;<samp>status</samp>&rsquo;</dt>
<dd><p>HTTP status field e.g. OK.
</p>
</dd>
<dt>&lsquo;<samp>header</samp>&rsquo;</dt>
<dd><p>An object containing key/value pairs for HTTP header.
</p>
</dd>
<dt>&lsquo;<samp>body</samp>&rsquo;</dt>
<dd><p>HTTP body, Base64 encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>sip_request</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>sip_request</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>method</samp>&rsquo;</dt>
<dd><p>SIP method e.g. INVITE.
</p>
</dd>
<dt>&lsquo;<samp>from</samp>&rsquo;</dt>
<dd><p>The SIP caller address.
</p>
</dd>
<dt>&lsquo;<samp>to</samp>&rsquo;</dt>
<dd><p>The SIP callee address.
</p>
</dd>
<dt>&lsquo;<samp>data</samp>&rsquo;</dt>
<dd><p>SIP message body, base64-encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>sip_response</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>sip_response</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>code</samp>&rsquo;</dt>
<dd><p>SIP response code.
</p>
</dd>
<dt>&lsquo;<samp>status</samp>&rsquo;</dt>
<dd><p>SIP response status.
</p>
</dd>
<dt>&lsquo;<samp>from</samp>&rsquo;</dt>
<dd><p>The SIP caller address.
</p>
</dd>
<dt>&lsquo;<samp>to</samp>&rsquo;</dt>
<dd><p>The SIP callee address.
</p>
</dd>
<dt>&lsquo;<samp>data</samp>&rsquo;</dt>
<dd><p>SIP message body, base64-encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>sip_ssl</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>sip_ssl</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>The message payload, base64-encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>imap</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>imap</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>The message payload, base64-encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>imap_ssl</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>imap_ssl</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>The message payload, base64-encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>pop3</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>pop3</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>The message payload, base64-encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>pop3_ssl</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>pop3_ssl</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>The message payload, base64-encoded.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>ntp_timestamp</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>ntp_timestamp</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>version</samp>&rsquo;</dt>
<dd><p>NTP header version field.
</p>
</dd>
<dt>&lsquo;<samp>mode</samp>&rsquo;</dt>
<dd><p>NTP header mode field.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>ntp_control</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>ntp_control</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>version</samp>&rsquo;</dt>
<dd><p>NTP header version field.
</p>
</dd>
<dt>&lsquo;<samp>mode</samp>&rsquo;</dt>
<dd><p>NTP header mode field.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>ntp_private</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>ntp_private</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>version</samp>&rsquo;</dt>
<dd><p>NTP header version field.
</p>
</dd>
<dt>&lsquo;<samp>mode</samp>&rsquo;</dt>
<dd><p>NTP header mode field.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>ftp_command</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>ftp_command</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>command</samp>&rsquo;</dt>
<dd><p>The FTP command e.g. PASV.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>ftp_response</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>ftp_response</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>status</samp>&rsquo;</dt>
<dd><p>The FTP response status e.g. 200.
</p>
</dd>
<dt>&lsquo;<samp>text</samp>&rsquo;</dt>
<dd><p>The FTP response human-readable text.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>smtp_command</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>smtp_response</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>command</samp>&rsquo;</dt>
<dd><p>The SMTP command.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>smtp_response</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>smtp_response</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>status</samp>&rsquo;</dt>
<dd><p>The SMTP response status.
</p>
</dd>
<dt>&lsquo;<samp>text</samp>&rsquo;</dt>
<dd><p>The SMTP response human-readable text.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>smtp_data</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>smtp_data</code>.The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>from</samp>&rsquo;</dt>
<dd><p>The value of the SMTP MAIL FROM field, a string.
</p>
</dd>
<dt>&lsquo;<samp>to</samp>&rsquo;</dt>
<dd><p>A list of strings containing all SMTP RCPT TO field values.
</p>
</dd>
<dt>&lsquo;<samp>body</samp>&rsquo;</dt>
<dd><p>The SMTP email body.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>gre</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>gre</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>next_proto</samp>&rsquo;</dt>
<dd><p>The value of the PROTOCOL TYPE field, a string.
</p>
</dd>
<dt>&lsquo;<samp>key</samp>&rsquo;</dt>
<dd><p>The value of the KEY field, a 32 bit number. Defaults to 0 if it is not present
in the data frame.
</p>
</dd>
<dt>&lsquo;<samp>sequenceNo</samp>&rsquo;</dt>
<dd><p>The value of the SEQUENCE NUMBER field, a 32 bit number. Defaults to 0 if it is
not present in the data frame.
</p>
</dd>
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>The GRE payload
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>gre_pptp</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>gre_pptp</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>next_proto</samp>&rsquo;</dt>
<dd><p>The value of the PROTOCOL TYPE field, a string.
</p>
</dd>
<dt>&lsquo;<samp>call_id</samp>&rsquo;</dt>
<dd><p>The value of the CALL ID field, a 16 bit number.
</p>
</dd>
<dt>&lsquo;<samp>sequenceNo</samp>&rsquo;</dt>
<dd><p>The value of the SEQUENCE NUMBER field, a 32 bit number. Defaults to 0 if it is
not present in the data frame.
</p>
</dd>
<dt>&lsquo;<samp>acknowledgement_number</samp>&rsquo;</dt>
<dd><p>The value of the ACKNOWLEDGEMENT NUMBER field, a 32 bit number. Defaults to 0 if
it is not present in the data frame.
</p>
</dd>
<dt>&lsquo;<samp>payload_length</samp>&rsquo;</dt>
<dd><p>The length of the GRE PPTP payload
</p>
</dd>
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>The GRE payload
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>esp</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>esp</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>spi</samp>&rsquo;</dt>
<dd><p>The value of the SPI field, a 32 bit number.
</p>
</dd>
<dt>&lsquo;<samp>sequenceNo</samp>&rsquo;</dt>
<dd><p>The value of the SEQUENCE NUMBER field, a 32 bit number.
</p>
</dd>
<dt>&lsquo;<samp>payload_length</samp>&rsquo;</dt>
<dd><p>The length of the ESP payload
</p>
</dd>
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>NOT CURRENTLY OUTPUT, but couple be enabled in the lua config
The ESP payload
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>unrecognised_ip_protocol</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>unrecognised_ip_protocol</code>. The value is a
JSON object containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>next_proto</samp>&rsquo;</dt>
<dd><p>The value of the PROTOCOL field in the IP header.
</p>
</dd>
<dt>&lsquo;<samp>sequenceNo</samp>&rsquo;</dt>
<dd><p>The value of the SEQUENCE NUMBER field, a 32 bit number.
</p>
</dd>
<dt>&lsquo;<samp>payload_length</samp>&rsquo;</dt>
<dd><p>The length of the IP payload
</p>
</dd>
<dt>&lsquo;<samp>payload</samp>&rsquo;</dt>
<dd><p>The IP payload
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>802.11</samp>&rsquo;</dt>
<dd><p>Emitted when <code>802.11</code> is <code>unrecognised_ip_protocol</code>. The value is a
JSON object containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>version</samp>&rsquo;</dt>
<dd><p>The value of the VERSION field in the header, an 8 bit number.
</p>
</dd>
<dt>&lsquo;<samp>type</samp>&rsquo;</dt>
<dd><p>The value of the TYPE field, an 8 bit number.
</p>
</dd>
<dt>&lsquo;<samp>subtype</samp>&rsquo;</dt>
<dd><p>The value of the SUBTYPE field, an 8 bit number.
</p>
</dd>
<dt>&lsquo;<samp>flags</samp>&rsquo;</dt>
<dd><p>The flags field, an 8 bit number
</p>
</dd>
<dt>&lsquo;<samp>protected</samp>&rsquo;</dt>
<dd><p>Indicates if the protected flag is set, a boolean
</p>
</dd>
<dt>&lsquo;<samp>filt_addr</samp>&rsquo;</dt>
<dd><p>The MAC address in the FILTER ADDRESS field, a string.
</p>
</dd>
<dt>&lsquo;<samp>frag_num</samp>&rsquo;</dt>
<dd><p>The value in the FRAGMENTATION NUMBER field, an 8 bit number.
</p>
</dd>
<dt>&lsquo;<samp>seq_num</samp>&rsquo;</dt>
<dd><p>The value in the SEQUENCE NUMBER field, a 16 bit number
</p>
</dd>
<dt>&lsquo;<samp>duration</samp>&rsquo;</dt>
<dd><p>The value in the DURATION field, a 16 bit number
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_unknown</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_unknown</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>version</samp>&rsquo;</dt>
<dd><p>The version of the TLS header.
</p>
</dd>
<dt>&lsquo;<samp>content_type</samp>&rsquo;</dt>
<dd><p>The content type of the TLS message.
</p>
</dd>
<dt>&lsquo;<samp>length</samp>&rsquo;</dt>
<dd><p>The length of the TLS message.
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_client_hello</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_client_hello</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>version</samp>&rsquo;</dt>
<dd><p>The version requested in the hello message.
</p>
</dd>
<dt>&lsquo;<samp>session_id</samp>&rsquo;</dt>
<dd><p>The session id of the message.
</p>
</dd>
<dt>&lsquo;<samp>random</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>timestamp</samp>&rsquo;</dt>
<dd><p>The timestamp field of the random field of the hello message.
</p>
</dd>
<dt>&lsquo;<samp>data</samp>&rsquo;</dt>
<dd><p>The data field of the random field of the hello message.
</p>
</dd>
</dl>

</dd>
<dt>&lsquo;<samp>cipher_suites</samp>&rsquo;</dt>
<dd><p>An ordered array of the cipher suites names
</p>
</dd>
<dt>&lsquo;<samp>compression_methods</samp>&rsquo;</dt>
<dd><p>An ordered array of the compression methods names
</p>
</dd>
<dt>&lsquo;<samp>extensions</samp>&rsquo;</dt>
<dd><p>An ordered array of the extensions, in the form of an object with the keys
<code>name</code>, <code>length</code> and <code>data</code>. (<code>data</code> will only be present if
<code>length &gt; 0</code>)
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_server_hello</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_server_hello</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>version</samp>&rsquo;</dt>
<dd><p>The version requested in the hello message.
</p>
</dd>
<dt>&lsquo;<samp>session_id</samp>&rsquo;</dt>
<dd><p>The session id of the message.
</p>
</dd>
<dt>&lsquo;<samp>random</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>timestamp</samp>&rsquo;</dt>
<dd><p>The timestamp field of the random field of the hello message.
</p>
</dd>
<dt>&lsquo;<samp>data</samp>&rsquo;</dt>
<dd><p>The data field of the random field of the hello message.
</p>
</dd>
</dl>

</dd>
<dt>&lsquo;<samp>cipher_suite</samp>&rsquo;</dt>
<dd><p>The name of the cipher suite
</p>
</dd>
<dt>&lsquo;<samp>compression_method</samp>&rsquo;</dt>
<dd><p>The name of the compression methods
</p>
</dd>
<dt>&lsquo;<samp>extensions</samp>&rsquo;</dt>
<dd><p>An ordered array of the extensions, in the form of an object with the keys
<code>name</code>, <code>length</code> and <code>data</code>. (<code>data</code> will only be present if
<code>length &gt; 0</code>)
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_certificates</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_certificates</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>certificates</samp>&rsquo;</dt>
<dd><p>An ordered array of base64 encoded certificates.
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_server_key_exchange</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_server_key_exchange</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>key_exchange_algorithm</samp>&rsquo;</dt>
<dd><p>The key exchange algorithm being used.
</p>
</dd>
<dt>&lsquo;<samp>curve_type</samp>&rsquo;</dt>
<dd><p>The curve type field.
</p>
</dd>
<dt>&lsquo;<samp>curve_metadata</samp>&rsquo;</dt>
<dd><p>Metadata about the curve being used. In the format of an object of Key:Value pairs.
(usually this will only contain &rsquo;name&rsquo; and the value will be the named curve
being used)
</p>
</dd>
<dt>&lsquo;<samp>public_key</samp>&rsquo;</dt>
<dd><p>Base64 encoded public key.
</p>
</dd>
<dt>&lsquo;<samp>signature_hash_algorithm</samp>&rsquo;</dt>
<dd><p>The type of hash algorithm used for the signature.
</p>
</dd>
<dt>&lsquo;<samp>signature_algorithm</samp>&rsquo;</dt>
<dd><p>The type of algorithm used for the signature.
</p>
</dd>
<dt>&lsquo;<samp>signature_hash</samp>&rsquo;</dt>
<dd><p>The signature hash as a hex string
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_server_hello_done</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_server_hello_done</code>. The value is an empty
JSON object with the key <code>tls</code>
</p>

</dd>
<dt>&lsquo;<samp>tls_handshake_unknown</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_handshake_unknown</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>type</samp>&rsquo;</dt>
<dd><p>The type of the handshake message.
</p>
</dd>
<dt>&lsquo;<samp>length</samp>&rsquo;</dt>
<dd><p>The length of the message.
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_certificate_request</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_certificate_request</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>cert_types</samp>&rsquo;</dt>
<dd><p>An ordered array of the certificate types.
</p>
</dd>
<dt>&lsquo;<samp>signature_algorithms</samp>&rsquo;</dt>
<dd><p>An ordered array of the signature algorithms, each one an object with the keys
<code>hash_algorithm</code> and <code>signature_algorithm</code>.
</p>
</dd>
<dt>&lsquo;<samp>distinguished_names</samp>&rsquo;</dt>
<dd><p>The distinguished names field.
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_client_key_exchange</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_client_key_exchange</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>key</samp>&rsquo;</dt>
<dd><p>Base64 encoded key.
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_certificate_verify</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_certificate_verify</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>signature_algorithm</samp>&rsquo;</dt>
<dd><p>The signature algorithm as an object with the keys <code>hash_algorithm</code> and
<code>signature_algorithm</code>.
</p>
</dd>
<dt>&lsquo;<samp>signature</samp>&rsquo;</dt>
<dd><p>The signature hash as a hex string.
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_change_cipher_spec</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_change_cipher_spec</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>value</samp>&rsquo;</dt>
<dd><p>The value from the change cipher spec message.
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_handshake_finished</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_handshake_finished</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>message</samp>&rsquo;</dt>
<dd><p>base64 encoded message.
</p>
</dd>
</dl>

</dd>
</dl>


</dd>
<dt>&lsquo;<samp>tls_handshake_complete</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_handshake_complete</code>. The value is an empty
JSON object with the key <code>tls</code>
</p>

</dd>
<dt>&lsquo;<samp>tls_application_data</samp>&rsquo;</dt>
<dd><p>Emitted when <code>action</code> is <code>tls_application_data</code>. The value is a JSON object
containing the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>tls</samp>&rsquo;</dt>
<dd><dl compact="compact">
<dt>&lsquo;<samp>version</samp>&rsquo;</dt>
<dd><p>The version of TLS being used.
</p>
</dd>
<dt>&lsquo;<samp>length</samp>&rsquo;</dt>
<dd><p>The length of the message being sent.
</p>
</dd>
</dl>

</dd>
</dl>



</dd>
<dt>&lsquo;<samp>location</samp>&rsquo;</dt>
<dd><span id="index-GeoIP"></span>
<span id="index-cybermon_002dgeoip-1"></span>
<p>Not emitted by <code>cybermon</code>, but can be added to the message by
<code>cybermon-geoip</code>.  See <a href="#cybermon_002dgeoip-invocation"><code>cybermon-geoip</code> invocation</a>.
</p>
<p>The <code>location</code> object contains potentially two child-objects:
<code>src</code> and <code>dest</code>.  Both <code>src</code> and <code>dest</code> may contain the
following fields, if the information is known:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>city</samp>&rsquo;</dt>
<dd><p>Name of the city from the GeoIP database.
</p>
</dd>
<dt>&lsquo;<samp>iso</samp>&rsquo;</dt>
<dd><p>Country ISO code, 2 characters.
</p>
</dd>
<dt>&lsquo;<samp>country</samp>&rsquo;</dt>
<dd><p>Country name.
</p>
</dd>
<dt>&lsquo;<samp>latitude</samp>&rsquo;</dt>
<dd><p>Latitude, degrees north of the equator.
</p>
</dd>
<dt>&lsquo;<samp>longitude</samp>&rsquo;</dt>
<dd><p>Longitude, degrees east of Greenwich.
</p>
</dd>
</dl>


</dd>
<dt>&lsquo;<samp>indicators</samp>&rsquo;</dt>
<dd><span id="index-IOC-1"></span>
<span id="index-Indicator-of-compromise"></span>
<span id="index-cybermon_002ddetector-1"></span>
<p>Not emitted by <code>cybermon</code>, but can be added to the message by
<code>cybermon-detector</code>.  See <a href="#cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a>.
</p>
<p>The <code>indicators</code> object is an array of IOC hits, if any have been
detected.  Each array element is an object with the following fields:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>id</samp>&rsquo;</dt>
<dd><p>IOC identifier.
</p>
</dd>
<dt>&lsquo;<samp>type</samp>&rsquo;</dt>
<dd><p>IOC type, one of: <code>ipv4</code>, <code>hostname</code>, <code>tcp</code>, <code>udp</code>,
<code>hostname</code>, <code>email</code>, <code>url</code>.
</p>
</dd>
<dt>&lsquo;<samp>value</samp>&rsquo;</dt>
<dd><p>IOC hit value.
</p>
</dd>
<dt>&lsquo;<samp>description</samp>&rsquo;</dt>
<dd><p>Human-readable text describing the IOC.
</p>
</dd>
<dt>&lsquo;<samp>category</samp>&rsquo;</dt>
<dd><p>Category tag for the indicator.
</p>
</dd>
<dt>&lsquo;<samp>source</samp>&rsquo;</dt>
<dd><p>Indicator source, a URL, could be the URL of a web page or report.
</p>
</dd>
<dt>&lsquo;<samp>author</samp>&rsquo;</dt>
<dd><p>Email address of the originator.
</p>
</dd>
</dl>

</dd>
</dl>



<hr>
<span id="cybermon_002dmonitor-invocation"></span><div class="header">
<p>
Next: <a href="#cybermon_002delasticsearch-invocation" accesskey="n" rel="next"><code>cybermon-elasticsearch</code> invocation</a>, Previous: <a href="#Cybermon-JSON-message-format" accesskey="p" rel="prev">Cybermon JSON message format</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon_002dmonitor-invocation-1"></span><h3 class="section">9.12 <code>cybermon-monitor</code> invocation</h3>

<span id="index-cybermon_002dmonitor_002c-invocation-1"></span>

<p><code>cybermon-monitor</code> subscribes to a RabbitMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for output in a human-readable
manner.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-monitor [BINDING]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-monitor
cybermon-monitor cyberprobe
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>cyberprobe</samp>&rsquo;.
</p>
</dd>
</dl>



<hr>
<span id="cybermon_002delasticsearch-invocation"></span><div class="header">
<p>
Next: <a href="#cybermon_002dbigquery-invocation" accesskey="n" rel="next"><code>cybermon-bigquery</code> invocation</a>, Previous: <a href="#cybermon_002dmonitor-invocation" accesskey="p" rel="prev"><code>cybermon-monitor</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon_002delasticsearch-invocation-1"></span><h3 class="section">9.13 <code>cybermon-elasticsearch</code> invocation</h3>

<span id="index-cybermon_002delasticsearch_002c-invocation-1"></span>

<p><code>cybermon-elasticsearch</code> subscribes to a RabbitMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for delivery to an
ElasticSearch store.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-elasticsearch [BINDING [ELASTICSEARCH-URL] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-elasticsearch
cybermon-elasticsearch ioc http://elastic-store:9200/
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>ioc</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>ELASTICSEARCH-URL</samp>&rsquo;</dt>
<dd><p>Specifies the base URL for ElasticSearch.  If not specified, defaults
to &lsquo;<samp>http://localhost:9200</samp>&rsquo;.
</p>
</dd>
</dl>



<hr>
<span id="cybermon_002dbigquery-invocation"></span><div class="header">
<p>
Next: <a href="#cybermon_002dgaffer-invocation" accesskey="n" rel="next"><code>cybermon-gaffer</code> invocation</a>, Previous: <a href="#cybermon_002delasticsearch-invocation" accesskey="p" rel="prev"><code>cybermon-elasticsearch</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon_002dbigquery-invocation-1"></span><h3 class="section">9.14 <code>cybermon-bigquery</code> invocation</h3>

<span id="index-cybermon_002dbigquery_002c-invocation-1"></span>

<p><code>cybermon-bigquery</code> subscribes to a RabbitMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for delivery to a Google
BigQuery table.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-bigquery [BINDING [KEY-FILE [PROJECT [DATASET [TABLE] ] ] ] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-bigquery
cybermon-bigquery ioc /priv.json
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>ioc</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>KEY-FILE</samp>&rsquo;</dt>
<dd><p>Specifies the path to a Google cloud key file in &rsquo;private JSON&rsquo; format.
If not specified, defaults
to <samp>/etc/cyberprobe/private.json</samp>.
</p>
</dd>
<dt>&lsquo;<samp>PROJECT</samp>&rsquo;</dt>
<dd><p>Specifies the Google Cloud project ID to use.  Defaults to the project ID
specified in the private JSON key file.
</p>
</dd>
<dt>&lsquo;<samp>DATASET</samp>&rsquo;</dt>
<dd><p>Specifies the BigQuery data set, defaults to &lsquo;<samp>cyberprobe</samp>&rsquo;.  You need to
create this dataset, it is not created for you.
</p>
</dd>
<dt>&lsquo;<samp>TABLE</samp>&rsquo;</dt>
<dd><p>Specifies the BigQuery table within the dataset.  This is created if it does
not already exist.  Don&rsquo;t try to create this yourself, if you use the wrong
schema, data won&rsquo;t load correctly.
</p>
</dd>
</dl>




<hr>
<span id="cybermon_002dgaffer-invocation"></span><div class="header">
<p>
Next: <a href="#cybermon_002dcassandra-invocation" accesskey="n" rel="next"><code>cybermon-cassandra</code> invocation</a>, Previous: <a href="#cybermon_002dbigquery-invocation" accesskey="p" rel="prev"><code>cybermon-bigquery</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon_002dgaffer-invocation-1"></span><h3 class="section">9.15 <code>cybermon-gaffer</code> invocation</h3>

<span id="index-cybermon_002dgaffer_002c-invocation-1"></span>
<span id="index-Gaffer-2"></span>
<span id="index-Graph-store-2"></span>

<p><code>cybermon-gaffer</code> subscribes to a RabbitMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for delivery to a
Gaffer store.  The format used is intended to allow Gaffer to be used
as an RDF store with SPARQL query.  To query and visualise the data stored in
Gaffer, see <a href="https://github.com/cybermaggedon/gaffer-tools">https://github.com/cybermaggedon/gaffer-tools</a>.
To get started with Gaffer quickly, a docker container for development
can be found at
<a href="https://docker.io/cybermaggedon/gaffer">https://docker.io/cybermaggedon/gaffer</a>.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-gaffer [BINDING [GAFFER-URL] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-gaffer
cybermon-gaffer ioc \
    http://gaffer-store:8080/rest/v1
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>ioc</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>GAFFER-URL</samp>&rsquo;</dt>
<dd><p>Specifies the base URL for Gaffer.  If not specified, defaults
to &lsquo;<samp>http://gaffer:8080/example-rest/v1</samp>&rsquo;.
</p>
</dd>
</dl>



<hr>
<span id="cybermon_002dcassandra-invocation"></span><div class="header">
<p>
Next: <a href="#cybermon_002dgeoip-invocation" accesskey="n" rel="next"><code>cybermon-geoip</code> invocation</a>, Previous: <a href="#cybermon_002dgaffer-invocation" accesskey="p" rel="prev"><code>cybermon-gaffer</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon_002dcassandra-invocation-1"></span><h3 class="section">9.16 <code>cybermon-cassandra</code> invocation</h3>

<span id="index-cybermon_002dcassandra_002c-invocation-1"></span>
<span id="index-Apache-Cassandra-1"></span>
<span id="index-Cassandra-1"></span>
<span id="index-Graph-store-3"></span>

<p><code>cybermon-cassandra</code> subscribes to a RabbitMQ pub/sub queue for
<code>cybermon</code>
events, and upon receipt of events, formats them for delivery to a
Cassandra store.  The format used is intended to allow Cassandra to be used
as an RDF store with SPARQL query.  To query and visualise the data stored in
Cassandra, see <a href="https://github.com/cybermaggedon/cassandra-redland">https://github.com/cybermaggedon/cassandra-redland</a>.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-cassandra [BINDING [CASSANDRA-HOSTS] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-cassandra
cybermon-cassandra ioc cassandra1,cassandra2
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>ioc</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>CASSANDRA-HOSTS</samp>&rsquo;</dt>
<dd><p>Specifies a comma-separated list of Cassandra store hosts to contact.
If not specified, defaults
to &lsquo;<samp>localhost</samp>&rsquo;.
</p>
</dd>
</dl>




<hr>
<span id="cybermon_002dgeoip-invocation"></span><div class="header">
<p>
Next: <a href="#cybermon_002ddetector-invocation" accesskey="n" rel="next"><code>cybermon-detector</code> invocation</a>, Previous: <a href="#cybermon_002dcassandra-invocation" accesskey="p" rel="prev"><code>cybermon-cassandra</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon_002dgeoip-invocation-1"></span><h3 class="section">9.17 <code>cybermon-geoip</code> invocation</h3>

<span id="index-cybermon_002dgeoip_002c-invocation"></span>
<span id="index-GeoIP-1"></span>

<p><code>cybermon-geoip</code> subscribes to a RabbitMQ pub/sub queue for
<code>cybermon</code> events, adds location information from GeoIP, and
re-publishes the elaborated events.  This effectively creates a processing
chain.  The event subscription and publishing events should be different in
order to avoid creating an infinite loop.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-geoip [BINDING [PUBLICATION] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-geoip
cybermon-geoip cyberprobe geo
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>cyberprobe</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>PUBLICATION</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to publish to.  If not specified, defaults
to &lsquo;<samp>geo</samp>&rsquo;.
</p>
</dd>
</dl>



<hr>
<span id="cybermon_002ddetector-invocation"></span><div class="header">
<p>
Next: <a href="#Cyberprobe-indicator-format" accesskey="n" rel="next">Cyberprobe indicator format</a>, Previous: <a href="#cybermon_002dgeoip-invocation" accesskey="p" rel="prev"><code>cybermon-geoip</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon_002ddetector-invocation-1"></span><h3 class="section">9.18 <code>cybermon-detector</code> invocation</h3>

<span id="index-cybermon_002ddetector_002c-invocation"></span>
<span id="index-IOC-2"></span>
<span id="index-Indicator-of-compromise-1"></span>
<span id="index-Indicator-1"></span>

<p><code>cybermon-detector</code> subscribes to a RabbitMQ pub/sub queue for
<code>cybermon</code> events, inspects them for IOCs, and adds detection
information if IOCs are observed before re-publishing
the elaborated events.  This effectively creates a processing
chain.  The event subscription and publishing events should be different in
order to avoid creating an infinite loop.
</p>
<p>The indicator file is specified by the &lsquo;<samp>INDICATORS</samp>&rsquo; environment variable,
the default is <samp>indicators.json</samp>.  The file format is the
<a href="#Cyberprobe-indicator-format">Cyberprobe indicator format</a>.  When the file changes, the indicators are
reloaded without the needed to restart <code>cybermon-detector</code>.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-detector [BINDING [PUBLICATION] ]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-detector
cybermon-detector geo ioc
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>geo</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>PUBLICATION</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to publish to.  If not specified, defaults
to &lsquo;<samp>ioc</samp>&rsquo;.
</p>
</dd>
</dl>




<hr>
<span id="Cyberprobe-indicator-format"></span><div class="header">
<p>
Next: <a href="#cybermon_002ddump-invocation" accesskey="n" rel="next"><code>cybermon-dump</code> invocation</a>, Previous: <a href="#cybermon_002ddetector-invocation" accesskey="p" rel="prev"><code>cybermon-detector</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Cyberprobe-indicator-format-1"></span><h3 class="section">9.19 Cyberprobe indicator format</h3>

<span id="index-IOC-3"></span>
<span id="index-Indicator-of-compromise-2"></span>
<span id="index-Indicator-2"></span>

<span id="Overview-5"></span><h3 class="heading">Overview</h3>

<p>The <code>cybermon-detector</code> subscriber implements detection against a
set of indicators (see <a href="#cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a>.  The
indicators are presented in a file containing JSON describing the
indicators.
</p>
<p>Indicators consist of two parts:
</p>
<ul>
<li> A boolean expression which describes what to look for.

</li><li> A descriptor which describes changes made to the output event when an
indicator selects data.

</li></ul>

<span id="Overall-structure"></span><h3 class="heading">Overall structure</h3>

<p>The indicators file consists of a simple header containing the
&lsquo;<samp>description</samp>&rsquo; and &lsquo;<samp>version</samp>&rsquo; fields.  The &lsquo;<samp>version</samp>&rsquo; field is
intended to record a revision history identified for the indicators, and
should be changed to a unique value when an update occurs.
</p>
<p>These fields are not used by <code>cybermon-detect</code>.  
</p>
<div class="example">
<pre class="example">{
    &quot;description&quot;: &quot;Some test data&quot;,
    &quot;version&quot;: &quot;1&quot;,
    &quot;indicators&quot;: [
      ...
    ]
}
</pre></div>

<p>The &lsquo;<samp>indicators</samp>&rsquo; field consists of a list of indicators.
</p>
<span id="Indicator"></span><h3 class="heading">Indicator</h3>

<p>An indicator consists of: an ID, a descriptor which is tagged onto events
when they hit indicators, and a definition of what to hit on.  The
example below shows ID and descriptor.  
</p>
<div class="example">
<pre class="example">{
    &quot;id&quot;: &quot;6b7aa83f-8c43-4aaa-817f-5039adef19ef&quot;,
    &quot;descriptor&quot;: {
        &quot;description&quot;: &quot;URL of a page serving malware&quot;,
        &quot;category&quot;: &quot;malware&quot;,
        &quot;author&quot;: &quot;someone@example.com&quot;,
        &quot;source&quot;: &quot;id:3245edd9-e0f3-4982-9406-fbf93b874555&quot;,
        &quot;type&quot;: &quot;url&quot;,
        &quot;value&quot;: &quot;http://malware.org/malware.dat&quot;
    },
    ...
}
</pre></div>

<p>A descriptor contains a type/value pair which is a seed of information that an
investigator would want to search for for further information.
</p>
<p>The descriptor fields are:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>description</samp>&rsquo;</dt>
<dd><p>A human-readable description of the purpose of this indicator.
</p>
</dd>
<dt>&lsquo;<samp>category</samp>&rsquo;</dt>
<dd><p>A threat category for the indicator, which is used to group threats into
type of threat
</p>
</dd>
<dt>&lsquo;<samp>author</samp>&rsquo;</dt>
<dd><p>Email address of indicator author
</p>
</dd>
<dt>&lsquo;<samp>source</samp>&rsquo;</dt>
<dd><p>Source of the indicator, should be a URL e.g. a web-page address of a report
</p>
</dd>
<dt>&lsquo;<samp>type</samp>&rsquo;</dt>
<dd><p>The type of the &lsquo;<samp>value</samp>&rsquo; field, can be one of &lsquo;<samp>hostname</samp>&rsquo;,
&lsquo;<samp>url</samp>&rsquo;, &lsquo;<samp>ipv4</samp>&rsquo;, &lsquo;<samp>ipv6</samp>&rsquo;, &lsquo;<samp>tcp</samp>&rsquo;, &lsquo;<samp>udp</samp>&rsquo;, &lsquo;<samp>email</samp>&rsquo;.
</p>
</dd>
</dl>

<span id="Indicator-value"></span><h3 class="heading">Indicator value</h3>

<p>The indicator value consists of four constructs:
</p>
<ul>
<li> &lsquo;<samp>and</samp>&rsquo;

</li><li> &lsquo;<samp>or</samp>&rsquo;

</li><li> &lsquo;<samp>not</samp>&rsquo;

</li><li> Match term

</li></ul>

<p>The value construct is included in the Indicator object alongside the
&lsquo;<samp>id</samp>&rsquo; field e.g.
</p>
<div class="example">
<pre class="example">{
    &quot;id&quot;: &quot;845bcc85-49f5-427c-806c-5fe5984c2c5c&quot;,
    &quot;descriptor&quot;: {
      ...
    },
    &quot;type&quot;: &quot;tcp&quot;,
    &quot;value&quot;: &quot;11111&quot;
}
</pre></div>

<p>or
</p>
<div class="example">
<pre class="example">{
    &quot;id&quot;: &quot;845bcc85-49f5-427c-806c-5fe5984c2c5c&quot;,
    &quot;descriptor&quot;: {
      ...
    },
    &quot;or&quot;: [
        {
            &quot;type&quot;: &quot;tcp&quot;,
            &quot;value&quot;: &quot;11111&quot;
        },
        {
            &quot;type&quot;: &quot;tcp&quot;,
            &quot;value&quot;: &quot;11112&quot;
        }
    ]
}
</pre></div>

<p>The four value constructs can be combined with multiple layers to any
depth.
</p>
<span id="Match-term"></span><h4 class="subheading">Match term</h4>

<p>The simple matching form consists of a type and value.  The type field
can be one of: &lsquo;<samp>hostname</samp>&rsquo;, &lsquo;<samp>url</samp>&rsquo;, &lsquo;<samp>ipv4</samp>&rsquo;, &lsquo;<samp>ipv4.src</samp>&rsquo;,
&lsquo;<samp>ipv4.dest</samp>&rsquo;, &lsquo;<samp>ipv6</samp>&rsquo;, &lsquo;<samp>ipv6.src</samp>&rsquo;, &lsquo;<samp>ipv6.dest</samp>&rsquo;,
&lsquo;<samp>tcp</samp>&rsquo;, &lsquo;<samp>tcp.src</samp>&rsquo;, &lsquo;<samp>tcp.dest</samp>&rsquo;, &lsquo;<samp>udp</samp>&rsquo;,
&lsquo;<samp>udp.src</samp>&rsquo;, &lsquo;<samp>udp.dest</samp>&rsquo;, &lsquo;<samp>email</samp>&rsquo;. e.g.
</p>
<div class="example">
<pre class="example">{
    &quot;type&quot;: &quot;ipv4.src&quot;,
    &quot;value&quot;: &quot;192.168.0.1&quot;
}
</pre></div>

<span id="and-construct"></span><h4 class="subheading">&lsquo;<samp>and</samp>&rsquo; construct</h4>

<p>The &lsquo;<samp>and</samp>&rsquo; construct is true if all of its children are true.
</p>
<div class="example">
<pre class="example">&quot;and&quot;: [
    {
        &quot;type&quot;: &quot;hostname&quot;,
        &quot;value&quot;: &quot;example.com&quot;
    },
    {
        &quot;type&quot;: &quot;tcp&quot;,
        &quot;value&quot;: &quot;11112&quot;
    }
]
</pre></div>

<span id="or-construct"></span><h4 class="subheading">&lsquo;<samp>or</samp>&rsquo; construct</h4>

<p>The &lsquo;<samp>or</samp>&rsquo; construct is true if any of its children are true.
</p>
<div class="example">
<pre class="example">&quot;or&quot;: [
    {
        &quot;type&quot;: &quot;hostname&quot;,
        &quot;value&quot;: &quot;example.com&quot;
    },
    {
        &quot;type&quot;: &quot;hostname&quot;,
        &quot;value&quot;: &quot;example.com&quot;
    }
]
</pre></div>

<span id="not-construct"></span><h4 class="subheading">&lsquo;<samp>not</samp>&rsquo; construct</h4>

<p>The &lsquo;<samp>not</samp>&rsquo; construct is true if its child is false.
</p>
<div class="example">
<pre class="example">&quot;not&quot;: {
    &quot;type&quot;: &quot;hostname&quot;,
    &quot;value&quot;: &quot;example.com&quot;
}
</pre></div>

<span id="Threat-exchanges"></span><h3 class="heading">Threat exchanges</h3>

<p>See <a href="https://github.com/cybermaggedon/threat-exchanges">https://github.com/cybermaggedon/threat-exchanges</a> for code which
creates indicator sets from threat exchanges.
</p>


<hr>
<span id="cybermon_002ddump-invocation"></span><div class="header">
<p>
Next: <a href="#cybermon_002dalert-invocation" accesskey="n" rel="next"><code>cybermon-alert</code> invocation</a>, Previous: <a href="#Cyberprobe-indicator-format" accesskey="p" rel="prev">Cyberprobe indicator format</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon_002ddump-invocation-1"></span><h3 class="section">9.20 <code>cybermon-dump</code> invocation</h3>

<span id="index-cybermon_002ddump_002c-invocation"></span>
<span id="index-JSON-7"></span>
<span id="index-Cybermon-JSON-message-format-5"></span>

<p><code>cybermon-dump</code> subscribes to a RabbitMQ pub/sub queue for
<code>cybermon</code> events, and dumps the raw JSON to standard output.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-dump [BINDING]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-dump
cybermon-dump cyberprobe
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>cyberprobe</samp>&rsquo;.
</p>
</dd>
</dl>



<hr>
<span id="cybermon_002dalert-invocation"></span><div class="header">
<p>
Next: <a href="#taxii_002dclient-invocation" accesskey="n" rel="next"><code>taxii-client</code> invocation</a>, Previous: <a href="#cybermon_002ddump-invocation" accesskey="p" rel="prev"><code>cybermon-dump</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="cybermon_002dalert-invocation-1"></span><h3 class="section">9.21 <code>cybermon-alert</code> invocation</h3>

<span id="index-cybermon_002dalert_002c-invocation"></span>
<span id="index-Alert"></span>

<p><code>cybermon-alert</code> subscribes to a RabbitMQ pub/sub queue for
<code>cybermon</code> events, and outputs a human-readable message
when an IOC hits.
</p>
<p>Synopsis:
</p>
<div class="example">
<pre class="example">cybermon-alert [BINDING]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">cybermon-alert
cybermon-alert ioc
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>BINDING</samp>&rsquo;</dt>
<dd><p>Specifies the RabbitMQ pub/sub queue to connect to.  If not specified, defaults
to &lsquo;<samp>ioc</samp>&rsquo;.
</p>
</dd>
</dl>



<hr>
<span id="taxii_002dclient-invocation"></span><div class="header">
<p>
Next: <a href="#taxii_002dsync_002djson-invocation" accesskey="n" rel="next"><code>taxii-sync-json</code> invocation</a>, Previous: <a href="#cybermon_002dalert-invocation" accesskey="p" rel="prev"><code>cybermon-alert</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="taxii_002dclient-invocation-1"></span><h3 class="section">9.22 <code>taxii-client</code> invocation</h3>

<span id="index-taxii_002dclient_002c-invocation"></span>

<p><code>taxii-client</code> provides a means to connect with a TAXII compliant
server to acquire cyber threat information.  TAXII/STIX implementation
is experimental and incomplete.
</p>
<p>See
<a href="https://taxii.mitre.org/">https://taxii.mitre.org/</a> for more information on TAXII and STIX.
Synopsis:
</p>
<div class="example">
<pre class="example">taxii-client [-h] [--host HOST] [--port PORT] [--path PATH]
        [--collection COLLECTION] [--begin_timestamp BEGIN_TS]
        [--end_timestamp END_TS] [--discovery] [--poll]
        [--collection_information] [--subscribe] [--action ACT]
        [--query QUERY] [--subs-id SUBSCRIPTION_ID]
        [--inbox INBOX]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">taxii-client -h taxii.com --poll
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>-h</samp>&rsquo;</dt>
<dt>&lsquo;<samp>--help</samp>&rsquo;</dt>
<dd><p>Shows command line usage.
</p>
</dd>
<dt>&lsquo;<samp>--host <var>HOST</var></samp>&rsquo;</dt>
<dd><p>Specifies host to connect to.
</p>
</dd>
<dt>&lsquo;<samp>--port <var>PORT</var></samp>&rsquo;</dt>
<dd><p>Specifies port number of the TAXII service.
</p>
</dd>
<dt>&lsquo;<samp>--path <var>PATH</var></samp>&rsquo;</dt>
<dd><p>Specifies the URI of the service.  Default is &lsquo;<samp>/</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--collection <var>COLLECTION</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--begin_timestamp <var>BEGIN</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--end_timestamp <var>END</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--discovery</samp>&rsquo;</dt>
<dd><p>Invokes a TAXII discovery action.
</p>
</dd>
<dt>&lsquo;<samp>--poll</samp>&rsquo;</dt>
<dd><p>Invokes a TAXII poll action.
</p>
</dd>
<dt>&lsquo;<samp>--collection_information</samp>&rsquo;</dt>
<dd><p>Invokes a collection information action.
</p>
</dd>
<dt>&lsquo;<samp>--subscribe</samp>&rsquo;</dt>
<dd><p>Invokes a TAXII subscribe action.
</p>
</dd>
<dt>&lsquo;<samp>--action <var>ACT</var></samp>&rsquo;</dt>
<dd><p>Specieis the subscription action to perform.
</p>
</dd>
<dt>&lsquo;<samp>--query <var>QUERY</var></samp>&rsquo;</dt>
<dd><p>Specifies the query to use for an inbox or poll action.  Query takes the
form: &lsquo;<samp>type:value</samp>&rsquo;.  Type can be one of:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>address</samp>&rsquo;</dt>
<dd><p>CybOX address object value e.g. &lsquo;<samp>address:1.2.3.4</samp>&rsquo;
</p>
</dd>
<dt>&lsquo;<samp>addresstype</samp>&rsquo;</dt>
<dd><p>CybOX address object type e.g. &lsquo;<samp>addresstype:e-mail</samp>&rsquo;
</p>
</dd>
<dt>&lsquo;<samp>domainname</samp>&rsquo;</dt>
<dd><p>CybOX DNS name
</p>
</dd>
<dt>&lsquo;<samp>port</samp>&rsquo;</dt>
<dd><p>TCP/UDP port number e.g. &lsquo;<samp>port:11111</samp>&rsquo;
</p>
</dd>
<dt>&lsquo;<samp>hash</samp>&rsquo;</dt>
<dd><p>File object hash value.
</p>
</dd>
<dt>&lsquo;<samp>id</samp>&rsquo;</dt>
<dd><p>Object ID.
</p>
</dd>
<dt>&lsquo;<samp>source</samp>&rsquo;</dt>
<dd><p>Object source identifier.
</p>
</dd>
</dl>

<p>Multiple query values may be specified in which case they are combined with
a logical AND.
</p>
</dd>
<dt>&lsquo;<samp>--subs-id <var>SUBS-ID</var></samp>&rsquo;</dt>
<dd><p>Specifies the subscription ID for a subscription operation.
</p>
</dd>
<dt>&lsquo;<samp>--inbox <var>INBOX</var></samp>&rsquo;</dt>
<dd><p>Specifies the inbox destination for subscriptions.  The default value is
<code>http://localhost:8888/</code>.
</p>
</dd>
</dl>

<p>Begin/end timestamps take the following form:
</p><div class="example">
<pre class="example">YYYY-MM-DDTHH:MM:SS.ssssss+/-hh:mm
</pre></div>



<hr>
<span id="taxii_002dsync_002djson-invocation"></span><div class="header">
<p>
Next: <a href="#taxii_002dserver-invocation" accesskey="n" rel="next"><code>taxii-server</code> invocation</a>, Previous: <a href="#taxii_002dclient-invocation" accesskey="p" rel="prev"><code>taxii-client</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="taxii_002dsync_002djson-invocation-1"></span><h3 class="section">9.23 <code>taxii-sync-json</code> invocation</h3>

<span id="index-taxii_002dsync_002djson_002c-invocation"></span>

<p><code>taxii-sync-json</code> provides a means to connect with a TAXII compliant
server to acquire cyber threat information.  <code>taxii-sync-json</code>
uses a TAXII poll request, and reformats all STIX information into a single
JSON file which is written to the current directory.  This JSON form is
intended to be used with <code>cybermon-detector</code>.
See <a href="#cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a>.
</p>
<p>TAXII/STIX implementation is experimental and incomplete.
</p>
<p>See
<a href="https://taxii.mitre.org/">https://taxii.mitre.org/</a> for more information on TAXII and STIX.
Synopsis:
</p>
<div class="example">
<pre class="example">taxii-sync-json [-h] [--host HOST] [--port PORT] [--path PATH]
        [--collection COLLECTION] [--begin_timestamp BEGIN_TS]
        [--end_timestamp END_TS]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">taxii-sync-json -h taxii.com
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>-h</samp>&rsquo;</dt>
<dt>&lsquo;<samp>--help</samp>&rsquo;</dt>
<dd><p>Shows command line usage.
</p>
</dd>
<dt>&lsquo;<samp>--host <var>HOST</var></samp>&rsquo;</dt>
<dd><p>Specifies host to connect to.
</p>
</dd>
<dt>&lsquo;<samp>--port <var>PORT</var></samp>&rsquo;</dt>
<dd><p>Specifies port number of the TAXII service.
</p>
</dd>
<dt>&lsquo;<samp>--path <var>PATH</var></samp>&rsquo;</dt>
<dd><p>Specifies the URI of the service.  Default is &lsquo;<samp>/</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--collection <var>COLLECTION</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--begin_timestamp <var>BEGIN</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
<dt>&lsquo;<samp>--end_timestamp <var>END</var></samp>&rsquo;</dt>
<dd><p>Specifies the TAXII collection to use.  Default is &lsquo;<samp>default</samp>&rsquo;.
</p>
</dd>
</dl>

<p>The JSON information is written to the current directory to a file called
<samp>stix-<var>COLLECTION</var>-combined.json</samp> where <var>COLLECTION</var> is the
collection name chosen.
</p>
<p>Begin/end timestamps take the following form:
</p><div class="example">
<pre class="example">YYYY-MM-DDTHH:MM:SS.ssssss+/-hh:mm
</pre></div>



<hr>
<span id="taxii_002dserver-invocation"></span><div class="header">
<p>
Next: <a href="#nhis11_002drcvr-invocation" accesskey="n" rel="next"><code>nhis11-rcvr</code> invocation</a>, Previous: <a href="#taxii_002dsync_002djson-invocation" accesskey="p" rel="prev"><code>taxii-sync-json</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="taxii_002dserver-invocation-1"></span><h3 class="section">9.24 <code>taxii-server</code> invocation</h3>

<span id="index-taxii_002dserver_002c-invocation"></span>

<p><code>taxii-server</code> provides a TAXII compliant
server to distribute cyber threat information.  TAXII/STIX implementation
is experimental and incomplete.
</p>
<p>See
<a href="https://taxii.mitre.org/">https://taxii.mitre.org/</a> for more information on TAXII and STIX.
Synopsis:
</p>
<div class="example">
<pre class="example">taxii-server [-h] [--host HOST] [--port PORT] [--data-dir DATA_DIR]
        [--db DB] [--sync-period SYNC_PERIOD]
</pre></div>

<p>Example:
</p><div class="example">
<pre class="example">taxii-server --port 8100 --data-dir data/ --db stix.db
</pre></div>

<dl compact="compact">
<dt>&lsquo;<samp>-h</samp>&rsquo;</dt>
<dt>&lsquo;<samp>--help</samp>&rsquo;</dt>
<dd><p>Shows command line usage.
</p>
</dd>
<dt>&lsquo;<samp>--host <var>HOST</var></samp>&rsquo;</dt>
<dd><p>Host to bind the HTTP service to.
</p>
</dd>
<dt>&lsquo;<samp>--port <var>PORT</var></samp>&rsquo;</dt>
<dd><p>Specifies port number of the TAXII service.
</p>
</dd>
<dt>&lsquo;<samp>--data-dir <var>PATH</var></samp>&rsquo;</dt>
<dd><p>Specifies the directory where STIX files are to be placed.  Directory
structure should be <var>PATH</var>/<var>COLLECTION</var>/<var>STIX-FILE</var>.
</p>
</dd>
<dt>&lsquo;<samp>--db <var>DB</var></samp>&rsquo;</dt>
<dd><p>Specifies a file to hold the STIX data.  Default is <samp>stix_store.db</samp>.
This is created if it does not exist.
</p>
</dd>
<dt>&lsquo;<samp>--sync-period <var>PERIOD</var></samp>&rsquo;</dt>
<dd><p>Specifies the period for synchronising the data directory with the database.
Default is &lsquo;<samp>1</samp>&rsquo;.
</p>
</dd>
</dl>

<p>The TAXII server periodically checks the data directory with the contents
of the database, and updates the database accordingly.  Deleting files results
in deletion from the database, adding files results in creation.  Thus, the
data directory is the master copy for the sync process.
</p>


<hr>
<span id="nhis11_002drcvr-invocation"></span><div class="header">
<p>
Next: <a href="#etsi_002drcvr-invocation" accesskey="n" rel="next"><code>etsi-rcvr</code> invocation</a>, Previous: <a href="#taxii_002dserver-invocation" accesskey="p" rel="prev"><code>taxii-server</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="nhis11_002drcvr-invocation-1"></span><h3 class="section">9.25 <code>nhis11-rcvr</code> invocation</h3>

<span id="index-nhis11_002drcvr_002c-invocation"></span>

<p><code>nhis11-rcvr</code> provides a TCP server which accepts connections from
NHIS LI clients,  decodes NHIS LI streams and outputs contained IP  packets  on
the standard output in PCAP format.  TCP port number to use is provided
on the command line.  Synopsis:
</p>
<div class="example">
<pre class="example">nhis11-rcvr <var>port-number</var>

</pre></div>

<ul>
<li> <var>port-number</var> is the TCP port number to list to for connections.
See <a href="#NHIS-LI">NHIS LI</a>.

</li></ul>

<span id="index-cyberprobe_002c-configuration-2"></span>

<p><code>nhis11-rcvr</code> executes indefinitely - to end the program, a signal
should be sent. e.g.
</p>
<div class="example">
<pre class="example">killall nhis11-rcvr
</pre></div>



<hr>
<span id="etsi_002drcvr-invocation"></span><div class="header">
<p>
Next: <a href="#ElasticSearch-model" accesskey="n" rel="next">ElasticSearch model</a>, Previous: <a href="#nhis11_002drcvr-invocation" accesskey="p" rel="prev"><code>nhis11-rcvr</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="etsi_002drcvr-invocation-1"></span><h3 class="section">9.26 <code>etsi-rcvr</code> invocation</h3>

<span id="index-etsi_002drcvr_002c-invocation"></span>

<p><code>etsi-rcvr</code> provides a TCP server which accepts connections from
ETSI LI clients,  decodes ETSI LI streams and outputs contained IP  packets  on
the standard output in PCAP format.  TCP port number to use is provided
on the command line.  Synopsis:
</p>
<div class="example">
<pre class="example">etsi-rcvr <var>port-number</var>
</pre></div>

<ul>
<li> <var>port-number</var> is the TCP port number to list to for connections.
See <a href="#ETSI-LI">ETSI LI</a>.

</li></ul>

<span id="index-cyberprobe_002c-configuration-3"></span>

<p><code>etsi-rcvr</code> executes indefinitely - to end the program, a signal
should be sent. e.g.
</p>
<div class="example">
<pre class="example">killall etsi-rcvr
</pre></div>



<hr>
<span id="ElasticSearch-model"></span><div class="header">
<p>
Previous: <a href="#etsi_002drcvr-invocation" accesskey="p" rel="prev"><code>etsi-rcvr</code> invocation</a>, Up: <a href="#Reference" accesskey="u" rel="up">Reference</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="ElasticSearch-model-1"></span><h3 class="section">9.27 ElasticSearch model</h3>
<span id="index-ElasticSearch-3"></span>
<span id="index-ElasticSearch_002c-model"></span>

<span id="Overview-6"></span><h3 class="heading">Overview</h3>

<p>When <code>cybermon-elasticsearch</code> is used
observations are created in an ElasticSearch database.
These configuration files call the <samp>elastic.lua</samp> utility module.
This section describes the data model used in the ElasticSearch database.
</p>
<p>ElasticSearch accepts data in JSON form.  <code>cybermon-elasticsearch</code>
uses an
index called <code>cyberprobe</code> and an object type <code>observation</code>.
</p>
<p>Here is an example of a JSON payload which is emitted for a DNS request:
</p><div class="example">
<pre class="example">{
  &quot;observation&quot;: {
    &quot;type&quot;: &quot;query&quot;,
    &quot;answers&quot;: {},
    &quot;device&quot;: &quot;123456&quot;,
    &quot;dest&quot;: {
      &quot;udp&quot;: [&quot;53&quot;],
      &quot;dns&quot;: [&quot;&quot;],
      &quot;ipv4&quot;: [&quot;192.168.1.1&quot;]
    },
    &quot;queries&quot;: {
      &quot;name&quot;: [&quot;news.bbc.co.uk&quot;],
      &quot;type&quot;: [&quot;1&quot;],
      &quot;class&quot;: [&quot;1&quot;]
    },
    &quot;src&quot;: {
      &quot;udp&quot;: [&quot;57291&quot;],
      &quot;dns&quot;: [&quot;&quot;],
      &quot;ipv4&quot;: [&quot;192.168.1.100&quot;]
    },
    &quot;time&quot;: &quot;20141018T175059.366Z&quot;,
    &quot;action&quot;: &quot;dns_message&quot;,
    &quot;id&quot;: 1
  }
}
</pre></div>

<span id="Common-fields"></span><h3 class="heading">Common fields</h3>

<p>The following fields are emitted for all observations:
</p>
<dl compact="compact">
<dt><code>observation</code></dt>
<dd><p>This is a JSON object which describes a Cyberprobe observation.
</p>
</dd>
<dt><code>observation.oid</code></dt>
<dd><p>A unique object ID.
</p>
</dd>
<dt><code>observation.time</code></dt>
<dd><p>Describes the time of the event in GMT.  The components are:
</p><ul>
<li> 4-digit year
</li><li> 2-digit month
</li><li> 2-digit date
</li><li> Literal &lsquo;<samp>T</samp>&rsquo;.
</li><li> 2-digit hour (24-hour).
</li><li> 2-digit minute
</li><li> 2-digit second
</li><li> Literal &lsquo;<samp>.</samp>&rsquo;
</li><li> 3-digit milliseconds
</li><li> Literal &lsquo;<samp>Z</samp>&rsquo;
</li></ul>
<p>e.g. <code>20141018T175059.366Z</code>.
</p></dd>
<dt><code>observation.device</code></dt>
<dd><span id="index-LIID-1"></span>
<span id="index-Device-ID-1"></span>
<p>A string containing the targeted LIID / device ID.
</p>
</dd>
<dt><code>observation.action</code></dt>
<dd><p>Describes the type of a Cyberprobe observation.  See <a href="#Actions">Actions</a>
below.
</p>
</dd>
<dt><code>observation.src</code></dt>
<dd><p>An object describing the full stack of protocol destination addresses.
For each name/value pair, the name is the protocol name, and the value
is an array of strings which are protocol addresses.  For example:
</p><div class="example">
<pre class="example">&quot;src&quot;: {
  &quot;udp&quot;: [&quot;57291&quot;],
  &quot;dns&quot;: [&quot;&quot;],
  &quot;ipv4&quot;: [&quot;192.168.1.100&quot;]
}
</pre></div>

<p>This specifies a UDP source port number of 57291, and an IP source address
of <code>192.168.1.100</code>.  Each protocol layer is list, allowing for more than
one address - protocol tunnels may result in more than IP address, for instance.
</p>
</dd>
<dt><code>observation.dest</code></dt>
<dd><p>An object describing the full stack of protocol destination addresses, like
<code>observation.src</code> above, but for destination addresses.
</p>
</dd>
</dl>

<span id="Actions-2"></span><h3 class="heading">Actions</h3>
<span id="Actions"></span><span id="index-ElasticSearch-model_002c-actions"></span>
<span id="index-Actions"></span>

<p>The following <code>action</code> fields are defined:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>connected_up</samp>&rsquo;</dt>
<dd><p>Records the creation of a stream-orientated connection (currently, only TCP).
This event is created for all connections whether the protocol is
recognised or not.
</p></dd>
<dt>&lsquo;<samp>connected_down</samp>&rsquo;</dt>
<dd><p>Records the closing of a stream-orientated connection (currently, only TCP).
This event is created for all connections whether the protocol is
recognised or not.
</p></dd>
<dt>&lsquo;<samp>unrecognised_stream</samp>&rsquo;</dt>
<dd><p>Records the sending of a PDU on a connection-less transport (currently, only
UDP) whose protocol has not been recognised.
</p></dd>
<dt>&lsquo;<samp>unrecognised_datagram</samp>&rsquo;</dt>
<dd><p>Records the sending of a PDU on a connection-less transport (currently, only
UDP) whose protocol has not been recognised.
</p></dd>
<dt>&lsquo;<samp>http_request</samp>&rsquo;</dt>
<dd><p>Records the sending of an HTTP request.
</p></dd>
<dt>&lsquo;<samp>http_response</samp>&rsquo;</dt>
<dd><p>Records the sending of an HTTP response.
</p></dd>
<dt>&lsquo;<samp>dns_message</samp>&rsquo;</dt>
<dd><p>Records the sending of a DNS message (request and response).
</p></dd>
<dt>&lsquo;<samp>icmp</samp>&rsquo;</dt>
<dd><p>Records the sending of an ICMP message.
</p></dd>
<dt>&lsquo;<samp>smtp_command</samp>&rsquo;</dt>
<dd><p>Records the sending of an SMTP command.  This is a message from client
to server.  Data commands are not recorded with this event - there is an
&lsquo;<samp>smtp_data</samp>&rsquo; event which records this.
</p></dd>
<dt>&lsquo;<samp>smtp_response</samp>&rsquo;</dt>
<dd><p>Records the sending of a response to an SMTP command.  This is a status
message from server to client.
</p></dd>
<dt>&lsquo;<samp>smtp_data</samp>&rsquo;</dt>
<dd><p>Records an SMTP data transaction, including the full SMTP data payload
(essentially an email).
</p></dd>
<dt>&lsquo;<samp>ftp_command</samp>&rsquo;</dt>
<dd><p>Records an FTP command (client to server).
</p></dd>
<dt>&lsquo;<samp>ftp_response</samp>&rsquo;</dt>
<dd><p>Records an FTP response (server to client).
</p></dd>
</dl>

<span id="Connection-up"></span><h3 class="heading">Connection up</h3>
<span id="index-Connection-up"></span>

<p>Connection up events are created when connection-orientated transports
(e.g. TCP) are created, and have an <code>action</code> field of &lsquo;<samp>connection_up</samp>&rsquo;.
</p>
<span id="Connection-down"></span><h3 class="heading">Connection down</h3>
<span id="index-Connection-down"></span>

<p>Connection down events are created when connection-orientated transports
(e.g. TCP) are closed and have an <code>action</code> field of &lsquo;<samp>connection_down</samp>&rsquo;.
</p>
<span id="Unrecognised-datagram"></span><h3 class="heading">Unrecognised datagram</h3>
<span id="index-Unrecognised-datagram"></span>

<p>Unrecognised datagram events are created when a datagram is observed
on an unrecognised protocol, and have an <code>action</code> field of
&lsquo;<samp>unrecognised_datagram</samp>&rsquo;.  Such events include the following fields:
</p><dl compact="compact">
<dt><code>observation.data</code></dt>
<dd><p>The datagram payload, base64 encoded.
</p></dd>
</dl>

<span id="Unrecognised-stream"></span><h3 class="heading">Unrecognised stream</h3>
<span id="index-Unrecognised-stream"></span>

<p>Unrecognised stream events are created when data is observed to be
sent on an unrecognised connection-orientated protocol (e.g. TCP),
and have an <code>action</code> field of
&lsquo;<samp>unrecognised_stream</samp>&rsquo;.  Such events include the following fields:
</p><dl compact="compact">
<dt><code>observation.data</code></dt>
<dd><p>The datagram payload, base64 encoded.
</p></dd>
</dl>

<span id="ICMP"></span><h3 class="heading">ICMP</h3>
<span id="index-ICMP"></span>

<p>ICMP events are created when an ICMP message is observed
and have an <code>action</code> field of &lsquo;<samp>icmp</samp>&rsquo;.  Such events include the
following fields:
</p><dl compact="compact">
<dt><code>observation.data</code></dt>
<dd><p>The datagram payload, base64 encoded.
</p></dd>
</dl>

<span id="DNS-messages"></span><h3 class="heading">DNS messages</h3>

<p>DNS events are created for DNS query and response messages, and have an
<code>action</code> field of &lsquo;<samp>dns_message</samp>&rsquo;.  Such events include
the following fields:
</p>
<dl compact="compact">
<dt><code>observation.type</code></dt>
<dd><p>Used to describe the type of a DNS message, by interpreting the message flags.
Will be &lsquo;<samp>query</samp>&rsquo; or &lsquo;<samp>response</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.queries</code></dt>
<dd><p>Contains a list of DNS queries.  Example:
</p><div class="example">
<pre class="example">&quot;queries&quot;: [
 {
    &quot;class: &quot;1&quot;,
    &quot;name&quot;: &quot;news.bbc.co.uk&quot;,
    &quot;type&quot;: &quot;1&quot;
 }
]
</pre></div>

</dd>
<dt><code>observation.answers</code></dt>
<dd><p>Contains a list of DNS responses.  Example:
</p><div class="example">
<pre class="example">&quot;answers&quot;: [
  {
    &quot;class: &quot;1&quot;,
    &quot;name&quot;: &quot;newswww.bbc.net.uk&quot;,
    &quot;type&quot;: &quot;1&quot;

  },
  {
    &quot;class: &quot;1&quot;,
    &quot;address&quot;: &quot;212.58.246.85&quot;,
    &quot;name&quot;: &quot;newswww.bbc.net.uk&quot;,
    &quot;type&quot;: &quot;1&quot;
  },
  {
    &quot;class: &quot;1&quot;,
    &quot;address&quot;: &quot;212.58.246.84&quot;,
    &quot;name&quot;: &quot;newswww.bbc.net.uk&quot;,
    &quot;type&quot;: &quot;1&quot;
  }
]
</pre></div>

</dd>
</dl>

<span id="HTTP-request"></span><h3 class="heading">HTTP request</h3>
<span id="index-HTTP-request"></span>

<p>HTTP request events are created for HTTP requests, and have an
<code>action</code> field of &lsquo;<samp>http_request</samp>&rsquo;.  Such events include fields:
</p>
<dl compact="compact">
<dt><code>observation.method</code></dt>
<dd><p>The HTTP method e.g. &lsquo;<samp>GET</samp>&rsquo;, &lsquo;<samp>POST</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.url</code></dt>
<dd><p>The HTTP URL e.g. &lsquo;<samp>http://www.bbc.co.uk/index.html</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.header</code></dt>
<dd><p>An object containing the request headers e.g.
</p><div class="example">
<pre class="example">{
  &quot;Accept&quot;: &quot;*\/*&quot;,
  &quot;Referer&quot;: &quot;http:\/\/www.bbc.co.uk\/news\/&quot;,
  &quot;Accept-Language&quot;: &quot;en-gb,en;q=0.5&quot;,
  &quot;Host&quot;: &quot;www.bbc.co.uk&quot;,
  &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,
  &quot;Connection&quot;: &quot;keep-alive&quot;,
  &quot;User-Agent&quot;: &quot;Test/5.0&quot;
}
</pre></div>

</dd>
<dt><code>observation.body</code></dt>
<dd><p>Describes the HTTP body.  This is a base64 encoding of the body.
</p>
</dd>
</dl>

<span id="HTTP-response"></span><h3 class="heading">HTTP response</h3>
<span id="index-HTTP-response"></span>

<p>HTTP response events are created for responses to HTTP requests, and have an
<code>action</code> field of &lsquo;<samp>http_response</samp>&rsquo;.  Such events include
the following fields:
</p>
<dl compact="compact">
<dt><code>observation.code</code></dt>
<dd><p>The HTTP status code e.g. &lsquo;<samp>200</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.status</code></dt>
<dd><p>The HTTP status response e.g. &lsquo;<samp>OK</samp>&rsquo;.
</p>
</dd>
<dt><code>observation.url</code></dt>
<dd><p>The HTTP URL e.g. &lsquo;<samp>http://www.bbc.co.uk/index.html</samp>&rsquo;.  This is obtained
by studying the HTTP request, so will only be present where the HTTP
request is observed.
</p>
</dd>
<dt><code>observation.header</code></dt>
<dd><p>An object containing the response headers e.g.
</p><div class="example">
<pre class="example">{
  &quot;Server&quot;: &quot;Apache&quot;,
  &quot;Content-Type&quot;: &quot;text/javascript&quot;
}
</pre></div>

</dd>
<dt><code>observation.body</code></dt>
<dd><p>Describes the HTTP response body, base64 encoded.
</p>
</dd>
</dl>

<span id="SMTP-command"></span><h3 class="heading">SMTP command</h3>
<span id="index-SMTP-command"></span>

<p>SMTP commands events are created when an SMTP command is sent from client
to server, and have an <code>action</code> field of &lsquo;<samp>smtp_command</samp>&rsquo;.
Such events include the
following fields:
</p><dl compact="compact">
<dt><code>observation.command</code></dt>
<dd><p>The SMTP command e.g. &lsquo;<samp>EHLO</samp>&rsquo;.
</p></dd>
</dl>

<span id="SMTP-response"></span><h3 class="heading">SMTP response</h3>
<span id="index-SMTP-response"></span>

<p>SMTP response events are created when an SMTP response is sent from server
to client, and have an <code>action</code> field of &lsquo;<samp>smtp_response</samp>&rsquo;.
Such events include the following fields:
</p>
<dl compact="compact">
<dt><code>observation.status</code></dt>
<dd><p>The SMTP status e.g. &lsquo;<samp>400</samp>&rsquo;.
</p></dd>
<dt><code>observation.text</code></dt>
<dd><p>The SMTP text e.g. &lsquo;<samp>[&quot;Hello malware.com.  Pleased to meet you.&quot;]</samp>&rsquo;.
</p></dd>
</dl>

<span id="SMTP-data"></span><h3 class="heading">SMTP data</h3>
<span id="index-SMTP-data"></span>

<p>SMTP data events are created when an SMTP email is sent from client
to server, and have an <code>action</code> field of &lsquo;<samp>smtp_data</samp>&rsquo;.
Such events include the following fields:
</p>
<dl compact="compact">
<dt><code>observation.from</code></dt>
<dd><p>The SMTP &ldquo;from&rdquo; address.  A string.
</p></dd>
<dt><code>observation.to</code></dt>
<dd><p>The SMTP &ldquo;to&rdquo; addresses.  An array of strings.
</p></dd>
<dt><code>observation.data</code></dt>
<dd><p>The SMTP payload (RFC822), base64 encoded.
</p></dd>
</dl>

<span id="FTP-command"></span><h3 class="heading">FTP command</h3>
<span id="index-FTP-command"></span>

<p>FTP commands events are created when an FTP command is sent from client
to server, and have an <code>action</code> field of &lsquo;<samp>ftp_command</samp>&rsquo;.
Such events include the
following fields:
</p><dl compact="compact">
<dt><code>observation.command</code></dt>
<dd><p>The FTP command.
</p></dd>
</dl>

<span id="FTP-response"></span><h3 class="heading">FTP response</h3>
<span id="index-FTP-response"></span>

<p>FTP response events are created when an FTP response is sent from server
to client, and have an <code>action</code> field of &lsquo;<samp>ftp_response</samp>&rsquo;.
Such events include the following fields:
</p>
<dl compact="compact">
<dt><code>observation.status</code></dt>
<dd><p>The FTP status.
</p></dd>
<dt><code>observation.text</code></dt>
<dd><p>The FTP text.
</p></dd>
</dl>



<hr>
<span id="Architecture"></span><div class="header">
<p>
Next: <a href="#Index" accesskey="n" rel="next">Index</a>, Previous: <a href="#Reference" accesskey="p" rel="prev">Reference</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Architecture-1"></span><h2 class="chapter">10 Architecture</h2>
<span id="index-Cyberprobe_002c-architecture"></span>
<span id="index-Architecture"></span>

<img src="architecture.png" alt="png">

<p>Cyberprobe consists of a set of loosely-coupled components which can be
used together. We prefer to use simple interfaces, and prefer to use
interfaces which are standards. Here&rsquo;s how we envisage these components
being used:
</p>
<dl compact="compact">
<dt><code>cyberprobe</code></dt>
<dd><p>is a network sniffer which collects packets which match an IP address
list. The packets collected are streamed using network streaming
protocols. The IP address match list can be statically configured (in a
configuration file), can be dynamically changed using a management
interface, or can be dynamically changed as a result of Snort alerts.
</p>
</dd>
<dt><code>cybermon</code></dt>
<dd><p>receives packets from cyberprobe, analyses them and generates
session/transport level events which result in user-configurable
actions. For each event, a call is made to a Lua script which the caller
provides.
</p>
</dd>
<dt><code>cybermon-detector</code></dt>
<dd><span id="index-cybermon_002ddetector-invocation"></span>
<p>runs events past an IOC list, searching for
cyber threat indicators. When these indicators are observed, the indicator
meta-data is also added to the JSON events.
</p>
</dd>
<dt><code>zeromq.lua</code></dt>
<dd><span id="index-amqp_002dtopic_002elua-configuration-file"></span>
<span id="index-cybermon_002c-amqp_002dtopic_002elua-configuration-file"></span>
<p>is a cybermon configuration file we provide which publishes data to a
RabbitMQ pub/sub queue.  It allows connection of consumers to the
<code>cybermon</code> event stream.
</p>
</dd>
<dt><code>cybermon-bigquery</code></dt>
<dd><span id="index-cybermon_002dbigquery-1"></span>
<span id="index-Google-BigQuery-1"></span>
<span id="index-BigQuery"></span>
<p>is a RabbitMQ subscriber which output <code>cybermon</code> events to a
Google BigQuery table.
</p>
</dd>
<dt><code>cybermon-cassandra</code></dt>
<dd><span id="index-cybermon_002dcassandra-1"></span>
<span id="index-Cassandra-2"></span>
<span id="index-Apache-Cassandra-2"></span>
<p>is a RabbitMQ subscriber which output <code>cybermon</code> events to a
Cassandra store.
</p>
</dd>
<dt><code>cybermon-elasticsearch</code></dt>
<dd><span id="index-cybermon_002delasticsearch-1"></span>
<span id="index-ElasticSearch-4"></span>
<p>is a RabbitMQ subscriber which output <code>cybermon</code> events to a
ElasticSearch store.
</p>
</dd>
<dt><code>cybermon-gaffer</code></dt>
<dd><span id="index-cybermon_002dgaffer-1"></span>
<span id="index-Gaffer-3"></span>
<p>is a RabbitMQ subscriber which output <code>cybermon</code> events to a
Gaffer store.
</p>
</dd>
<dt><code>taxii-server</code></dt>
<dd><p>is a TAXII compliant server, which is used to distribute STIX rules over
HTTP.
</p>
</dd>
<dt><code>taxii-client-json</code></dt>
<dd><p>is a TAXII compliant client, which fetches STIX data over TAXII and write it
to a JSON file in a way that <code>stix+db.lua</code> can read.
</p>
</dd>
<dt><code>snort</code></dt>
<dd><p>is not part of cyberprobe, but it&rsquo;s a great NIDS, so we use that.
</p>
</dd>
</dl>


<hr>
<span id="Index"></span><div class="header">
<p>
Previous: <a href="#Architecture" accesskey="p" rel="prev">Architecture</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#Index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Index-1"></span><h2 class="unnumbered">Index</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-V"><b>V</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-Y"><b>Y</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-Z"><b>Z</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-cp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-A">A</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-action"><code>action</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Actions">Actions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Alert">Alert</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dalert-invocation"><code>cybermon-alert</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Amazon-Linux">Amazon Linux</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-AMQP">AMQP</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-AMQP-1">AMQP</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-amqp_002dtopic_002elua-configuration-file"><samp>amqp-topic.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Apache-Cassandra">Apache Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Cassandra-subscriber">The Cassandra subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Apache-Cassandra-1">Apache Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Apache-Cassandra-2">Apache Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-apt_002dget"><code>apt-get</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Architecture">Architecture</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Authentication">Authentication</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-interface">Management interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-AWS-Traffic-Mirroring">AWS Traffic Mirroring</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrating-with-AWS-Traffic-Mirroring">Integrating with AWS Traffic Mirroring</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-AWS-Traffic-Mirroring-1">AWS Traffic Mirroring</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-AWS-Traffic-Mirroring-2">AWS Traffic Mirroring</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-invocation"><code>cybermon</code> invocation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-B">B</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-BigQuery">BigQuery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Boost">Boost</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Build-dependencies">Build dependencies</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Build-targets">Build targets</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Building">Building</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-C">C</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cassandra">Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Cassandra-subscriber">The Cassandra subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cassandra-1">Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cassandra-2">Cassandra</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-certificate_002c-cyberprobe-configuration-option"><code>certificate</code>, cyberprobe configuration option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Checkout-from-git-repository">Checkout from <code>git</code> repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Compilation">Compilation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-connected_005fup"><code>connected_up</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Connection-down">Connection down</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Connection-reset">Connection reset</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Connection-restart">Connection restart</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Connection-up">Connection up</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Containers">Containers</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Containers-1">Containers</a>:</td><td>&nbsp;</td><td valign="top"><a href="#A-containerised-processing-system">A containerised processing system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-context"><code>context</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-context-1"><code>context</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-context-2"><code>context</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-context-object"><code>context</code> object</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-control"><code>control</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon"><code>cybermon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Top">Top</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon-1"><code>cybermon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon-2"><code>cybermon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon-3"><code>cybermon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon-context-object"><code>cybermon</code> <code>context</code> object</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon-events"><code>cybermon</code> events</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cybermon-JSON-message-format">Cybermon JSON message format</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cybermon-JSON-message-format-1">Cybermon JSON message format</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cybermon-JSON-message-format-2">Cybermon JSON message format</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cybermon-JSON-message-format-3">Cybermon JSON message format</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cybermon-JSON-message-format-4">Cybermon JSON message format</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cybermon-JSON-message-format-5">Cybermon JSON message format</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002ddump-invocation"><code>cybermon-dump</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-amqp_002dtopic_002elua-configuration-file"><code>cybermon</code>, <samp>amqp-topic.lua</samp> configuration file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-configuration"><code>cybermon</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-configuration-1"><code>cybermon</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-docker-repository"><code>cybermon</code>, docker repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-example-configurations"><code>cybermon</code>, example configurations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-features"><code>cybermon</code>, features</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-invocation"><code>cybermon</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-invocation"><code>cybermon</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-pub_002fsub"><code>cybermon</code>, pub/sub</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-cyberprobe_002fcybermon-at-boot-time">Running cyberprobe/cybermon at boot time</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002c-pub_002fsub-1"><code>cybermon</code>, pub/sub</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pub_002fsub-overview">Pub/sub overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dalert"><code>cybermon-alert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dalert_002c-invocation"><code>cybermon-alert</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dalert-invocation"><code>cybermon-alert</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dbigquery"><code>cybermon-bigquery</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dbigquery-1"><code>cybermon-bigquery</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dbigquery_002c-invocation"><code>cybermon-bigquery</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Google-BigQuery-subscriber">The Google BigQuery subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dbigquery_002c-invocation-1"><code>cybermon-bigquery</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dbigquery-invocation"><code>cybermon-bigquery</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dcassandra"><code>cybermon-cassandra</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dcassandra-1"><code>cybermon-cassandra</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dcassandra_002c-invocation"><code>cybermon-cassandra</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Cassandra-subscriber">The Cassandra subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dcassandra_002c-invocation-1"><code>cybermon-cassandra</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002ddetector"><code>cybermon-detector</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002ddetector-1"><code>cybermon-detector</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002ddetector_002c-invocation"><code>cybermon-detector</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002ddump"><code>cybermon-dump</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002ddump_002c-invocation"><code>cybermon-dump</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002ddump-invocation"><code>cybermon-dump</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002delasticsearch"><code>cybermon-elasticsearch</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002delasticsearch-1"><code>cybermon-elasticsearch</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002delasticsearch_002c-invocation"><code>cybermon-elasticsearch</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-ElasticSearch-subscriber">The ElasticSearch subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002delasticsearch_002c-invocation-1"><code>cybermon-elasticsearch</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002delasticsearch-invocation"><code>cybermon-elasticsearch</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgaffer"><code>cybermon-gaffer</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgaffer-1"><code>cybermon-gaffer</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgaffer_002c-invocation"><code>cybermon-gaffer</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Gaffer-subscriber">The Gaffer subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgaffer_002c-invocation-1"><code>cybermon-gaffer</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgeoip"><code>cybermon-geoip</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgeoip-1"><code>cybermon-geoip</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dgeoip_002c-invocation"><code>cybermon-geoip</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dgeoip-invocation"><code>cybermon-geoip</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dmonitor_002c-invocation"><code>cybermon-monitor</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-debug-monitor-subscriber">The debug monitor subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cybermon_002dmonitor_002c-invocation-1"><code>cybermon-monitor</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dmonitor-invocation"><code>cybermon-monitor</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe"><code>cyberprobe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Top">Top</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe-1"><code>cyberprobe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe-2"><code>cyberprobe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe-3"><code>cyberprobe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe-configuration"><code>cyberprobe</code> configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe-secure-delivery">cyberprobe secure delivery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cyberprobe_002c-architecture">Cyberprobe, architecture</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-configuration"><code>cyberprobe</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-invocation"><code>cyberprobe</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-configuration-1"><code>cyberprobe</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-configuration-2"><code>cyberprobe</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#nhis11_002drcvr-invocation"><code>nhis11-rcvr</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-configuration-3"><code>cyberprobe</code>, configuration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#etsi_002drcvr-invocation"><code>etsi-rcvr</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-control"><code>cyberprobe</code>, <code>control</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-delay"><code>cyberprobe</code>, delay</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-delay-1"><code>cyberprobe</code>, delay</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cyberprobe_002c-docker-repository">Cyberprobe, docker repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-docker-repository"><code>cyberprobe</code>, docker repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-endpoint"><code>cyberprobe</code>, endpoint</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-endpoints"><code>cyberprobe</code>, <code>endpoints</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-features"><code>cyberprobe</code>, features</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-interfaces"><code>cyberprobe</code>, <code>interfaces</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-invocation"><code>cyberprobe</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-invocation"><code>cyberprobe</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-management"><code>cyberprobe</code>, management</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-interface">Management interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-snort_005falert"><code>cyberprobe</code>, <code>snort_alert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-target"><code>cyberprobe</code>, target</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002c-targets"><code>cyberprobe</code>, <code>targets</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002dcli"><code>cyberprobe-cli</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002dcli-1"><code>cyberprobe-cli</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-interface">Management interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002dcli_002c-commands"><code>cyberprobe-cli</code>, commands</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe_002dcli-commands"><code>cyberprobe-cli</code> commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-cyberprobe_002dcli_002c-invocation"><code>cyberprobe-cli</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe_002dcli-invocation"><code>cyberprobe-cli</code> invocation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-D">D</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-DAG">DAG</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Endace-DAG">Endace DAG</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dashboard">Dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Debian">Debian</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Delay">Delay</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Delay-1">Delay</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dependencies">dependencies</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Device-ID">Device ID</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Device-ID-1">Device ID</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Discussion-forums">Discussion forums</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dnf"><code>dnf</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-DNS">DNS</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dns_005fmessage"><code>dns_message</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Docker">Docker</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Docker-1">Docker</a>:</td><td>&nbsp;</td><td valign="top"><a href="#A-containerised-processing-system">A containerised processing system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Docker-compose">Docker compose</a>:</td><td>&nbsp;</td><td valign="top"><a href="#A-containerised-processing-system">A containerised processing system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-docker_002dcompose_002dcp_002dsnort_002eyml"><samp>docker-compose-cp-snort.yml</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#A-containerised-processing-system">A containerised processing system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-docker_002dcompose_002eyml"><samp>docker-compose.yml</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#A-containerised-processing-system">A containerised processing system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Downloading">Downloading</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-DPI">DPI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Top">Top</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dpkg"><code>dpkg</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-E">E</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch">ElasticSearch</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch-1">ElasticSearch</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-ElasticSearch-subscriber">The ElasticSearch subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch-2">ElasticSearch</a>:</td><td>&nbsp;</td><td valign="top"><a href="#A-containerised-processing-system">A containerised processing system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch-3">ElasticSearch</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch-4">ElasticSearch</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch-model_002c-actions">ElasticSearch model, actions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ElasticSearch_002c-model">ElasticSearch, model</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Endace">Endace</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Endace-DAG">Endace DAG</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Endpoint">Endpoint</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-endpoints"><code>endpoints</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI">ETSI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI-LI">ETSI LI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI-TS-101-671">ETSI TS 101 671</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI-TS-102-232_002d1">ETSI TS 102 232-1</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ETSI-TS-102-232_002d3">ETSI TS 102 232-3</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-etsi_002drcvr"><code>etsi-rcvr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-etsi_002drcvr-1"><code>etsi-rcvr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-etsi_002drcvr_002c-invocation"><code>etsi-rcvr</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#etsi_002drcvr-invocation"><code>etsi-rcvr</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-event"><code>event</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-event-1"><code>event</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-event-2"><code>event</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-event-3"><code>event</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-eventstream_002dservice"><code>eventstream-service</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-eventstream_002dservice_002c-invocation"><code>eventstream-service</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#eventstream_002dservice-invocation"><code>eventstream-service</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Executables">Executables</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-F">F</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Features_002c-of-cybermon">Features, of <code>cybermon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Features_002c-of-cyberprobe">Features, of <code>cyberprobe</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Fedora">Fedora</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Forging_002c-DNS-response">Forging, DNS response</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FTP-command">FTP command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-FTP-response">FTP response</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-G">G</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gaffer">Gaffer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Gaffer-subscriber">The Gaffer subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gaffer-1">Gaffer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#A-containerised-processing-system">A containerised processing system</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gaffer-2">Gaffer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gaffer-3">Gaffer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GeoIP">GeoIP</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GeoIP-1">GeoIP</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dgeoip-invocation"><code>cybermon-geoip</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Getting-started">Getting started</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Quick-start-tutorial">Quick start tutorial</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-git-repository"><code>git</code> repository</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GLIC">GLIC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Google-BigQuery">Google BigQuery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Google-BigQuery-subscriber">The Google BigQuery subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Google-BigQuery-1">Google BigQuery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Architecture">Architecture</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Google-Cloud-Platform">Google Cloud Platform</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Google-BigQuery-subscriber">The Google BigQuery subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graph-store">Graph store</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Cassandra-subscriber">The Cassandra subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graph-store-1">Graph store</a>:</td><td>&nbsp;</td><td valign="top"><a href="#The-Gaffer-subscriber">The Gaffer subscriber</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graph-store-2">Graph store</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dgaffer-invocation"><code>cybermon-gaffer</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Graph-store-3">Graph store</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002dcassandra-invocation"><code>cybermon-cassandra</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gRPC">gRPC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#eventstream_002dservice-invocation"><code>eventstream-service</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gRPC-1">gRPC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-gRPC-2">gRPC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-H">H</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-HTTP-request">HTTP request</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HTTP-response">HTTP response</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-http_005frequest"><code>http_request</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-http_005fresponse"><code>http_response</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-I">I</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ICMP">ICMP</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ifconfig"><code>ifconfig</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Indicator">Indicator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators">Threat indicators</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Indicator-1">Indicator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Indicator-2">Indicator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cyberprobe-indicator-format">Cyberprobe indicator format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Indicator-of-Compromise">Indicator of Compromise</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators">Threat indicators</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Indicator-of-compromise">Indicator of compromise</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Indicator-of-compromise-1">Indicator of compromise</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Indicator-of-compromise-2">Indicator of compromise</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cyberprobe-indicator-format">Cyberprobe indicator format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Installation">Installation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Integration-with-snort">Integration with <code>snort</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-interfaces"><code>interfaces</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-IOC">IOC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators">Threat indicators</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-IOC-1">IOC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-IOC-2">IOC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002ddetector-invocation"><code>cybermon-detector</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-IOC-3">IOC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cyberprobe-indicator-format">Cyberprobe indicator format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-IP-address-mask">IP address mask</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-IP-address-matching">IP address matching</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-J">J</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-JSON">JSON</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-JSON-1">JSON</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators">Threat indicators</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-JSON-2">JSON</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-JSON-3">JSON</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-JSON-4">JSON</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-JSON-5">JSON</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-JSON-6">JSON</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-JSON-7">JSON</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon_002ddump-invocation"><code>cybermon-dump</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-json_002elua"><samp>json.lua</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-K">K</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-key_002c-cyberprobe-configuration-option"><code>key</code>, cyberprobe configuration option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Kibana_002c-dashboard">Kibana, dashboard</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-L">L</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-libpcap"><code>libpcap</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-libtaxii"><code>libtaxii</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LIID">LIID</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LIID-1">LIID</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Lua">Lua</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LUA-events">LUA events</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-M">M</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Management">Management</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-interface">Management interface</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Management-client">Management client</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe_002dcli-invocation"><code>cyberprobe-cli</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Management-client-1">Management client</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe_002dcli-commands"><code>cyberprobe-cli</code> commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Management-protocol">Management protocol</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Management-protocol">Management protocol</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-monitor_002elua"><samp>monitor.lua</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cybermon">Using <code>cybermon</code></a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-N">N</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ncurses"><code>ncurses</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-network-attribute_002c-cyberprobe_002ecfg"><code>network</code> attribute, <samp>cyberprobe.cfg</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-network-attribute_002c-cyberprobe_002ecfg-1"><code>network</code> attribute, <samp>cyberprobe.cfg</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-network-attribute_002c-cyberprobe_002ecfg-2"><code>network</code> attribute, <samp>cyberprobe.cfg</samp></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Network-parameters">Network parameters</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NHIS-1_002e1">NHIS 1.1</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NHIS-1_002e1-LI">NHIS 1.1 LI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-nhis11_002drcvr_002c-invocation"><code>nhis11-rcvr</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#nhis11_002drcvr-invocation"><code>nhis11-rcvr</code> invocation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-O">O</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Overview-of-Cyberprobe">Overview of Cyberprobe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-P">P</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packages">Packages</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Preparation">Preparation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packet-forgery">Packet forgery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packet-injection">Packet injection</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Packet-inspection">Packet inspection</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Top">Top</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Privileged-user">Privileged user</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Protobuf">Protobuf</a>:</td><td>&nbsp;</td><td valign="top"><a href="#eventstream_002dservice-invocation"><code>eventstream-service</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Protobuf-1">Protobuf</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-configuration"><code>cybermon</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Protobuf-2">Protobuf</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Protobuf-3">Protobuf</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pub_002fsub">pub/sub</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pub_002fsub-1">pub/sub</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pub_002fsub-2">pub/sub</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Pub_002fsub-delivery">Pub/sub delivery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-cyberprobe_002fcybermon-at-boot-time">Running cyberprobe/cybermon at boot time</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Pub_002fsub-delivery-1">Pub/sub delivery</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pub_002fsub-overview">Pub/sub overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-publish_002fsubscribe">publish/subscribe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-publish_002fsubscribe-1">publish/subscribe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-publish_002fsubscribe-2">publish/subscribe</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-Q">Q</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-queue-delivery-using-Redis">queue delivery using Redis</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-R">R</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-RabbitMQ">RabbitMQ</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-RabbitMQ-1">RabbitMQ</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-readline"><code>readline</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Reconnection">Reconnection</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Redis">Redis</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Redis-1">Redis</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Release-history">Release history</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-S">S</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-SMTP-command">SMTP command</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SMTP-data">SMTP data</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SMTP-response">SMTP response</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Snort">Snort</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Top">Top</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Snort-1">Snort</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort-alerts"><code>snort</code> alerts</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort_002c-integration"><code>snort</code>, integration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort_002c-rules"><code>snort</code>, rules</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort_002c-signatures"><code>snort</code>, signatures</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integration-with-snort">Integration with <code>snort</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-snort_005falert"><code>snort_alert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SSL">SSL</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-stix"><code>stix</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Storing-observations">Storing observations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-T">T</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Target">Target</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-cyberprobe">Using <code>cyberprobe</code></a></td></tr>
<tr><td></td><td valign="top"><a href="#index-targets"><code>targets</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-targets_002c-address-mask"><code>targets</code>, address mask</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-taxii_002dclient_002c-invocation"><code>taxii-client</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dclient-invocation"><code>taxii-client</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-taxii_002dserver_002c-invocation"><code>taxii-server</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dserver-invocation"><code>taxii-server</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-taxii_002dsync_002djson_002c-invocation"><code>taxii-sync-json</code>, invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#taxii_002dsync_002djson-invocation"><code>taxii-sync-json</code> invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TCP-reset">TCP reset</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-your-own-configuration-file">Writing your own configuration file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tcpdump"><code>tcpdump</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-telnet"><code>telnet</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Threat-indicator">Threat indicator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Threat-indicators">Threat indicators</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TLS">TLS</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-trusted_002dca_002c-cyberprobe-configuration-option"><code>trusted-ca</code>, cyberprobe configuration option</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TS-101-671">TS 101 671</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TS-102-232_002d1">TS 102 232-1</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TS-102-232_002d3">TS 102 232-3</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-streaming-protocols">Output streaming protocols</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-U">U</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Ubuntu">Ubuntu</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Unrecognised-datagram">Unrecognised datagram</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Unrecognised-stream">Unrecognised stream</a>:</td><td>&nbsp;</td><td valign="top"><a href="#ElasticSearch-model">ElasticSearch model</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-V">V</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Version-history">Version history</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Visualisation">Visualisation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Visualisation">Visualisation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-VXLAN">VXLAN</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrating-with-AWS-Traffic-Mirroring">Integrating with AWS Traffic Mirroring</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-VXLAN-1">VXLAN</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cyberprobe-configuration"><code>cyberprobe</code> configuration</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-VXLAN-2">VXLAN</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-invocation"><code>cybermon</code> invocation</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-Y">Y</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-yum"><code>yum</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Obtaining-the-software">Obtaining the software</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Index_cp_letter-Z">Z</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ZeroMQ">ZeroMQ</a>:</td><td>&nbsp;</td><td valign="top"><a href="#cybermon-example-configurations"><code>cybermon</code> example configurations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ZeroMQ-1">ZeroMQ</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cybermon-JSON-message-format">Cybermon JSON message format</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-V"><b>V</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-Y"><b>Y</b></a>
 &nbsp; 
<a class="summary-letter" href="#Index_cp_letter-Z"><b>Z</b></a>
 &nbsp; 
</td></tr></table>

<hr>



</body>
</html>
